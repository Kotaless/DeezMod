"use strict";(self.webpackJsonpDeezer=self.webpackJsonpDeezer||[]).push([[7681],{PbG0:(e,r,s)=>{s.d(r,{d6:()=>_,qR:()=>o,Ay:()=>l}),s("/eM8"),s("hB5o"),s("LvTk");var t=s("PKMp"),n=s("bDF2");let o=function(e){return e.Apple="apple",e.Facebook="facebook",e.Form="form",e.Google="google",e.Msisdn="msisdn",e}({}),_=function(e){return e.Link="link",e.Login="login",e.Signup="signup",e.Unlink="unlink",e}({});const i={pushHashedGAUid:async e=>{if(e)try{const r=await((e,r,s="SHA-512")=>{const a=r?r+e:e;return Promise.resolve(window.crypto.subtle.digest(s,(new TextEncoder).encode(a)).then((e=>Array.from(new Uint8Array(e)).map((e=>e.toString(16).padStart(2,"0"))).join(""))))})(e.toString(),"f1r3ba53++//D33z35");(0,n.Fj)({ga_user_id:r||void 0})}catch(e){t.A.error(new Error("Could not hash the userId"))}},pushSuccessfulLoginEvent:(e,r)=>{(0,n.R2)({eventcategory:"login",eventaction:"login-success",eventlabel:e,...r})},pushFailedLoginEvent:(e,r)=>{(0,n.R2)({eventcategory:"login",eventaction:"login-failed",eventlabel:e,...r})},pushFailed3rdPartyConnectEvent:(e,r)=>{switch(r){case _.Login:i.pushFailedLoginEvent(e);break;case _.Signup:i.pushFailedSignupEvent(e);break;case null:case void 0:case _.Link:case _.Unlink:break;default:(0,n.R2)({eventcategory:"third-party-connect",eventaction:"attempt-failed",eventlabel:e})}},pushSuccessfulSignupEvent:(e,r)=>{localStorage.setItem("temporary-register-event","true"),(0,n.R2)({eventcategory:"signup",eventaction:"signup-success",eventlabel:e,...r})},pushFailedSignupEvent:(e,r)=>{(0,n.R2)({eventcategory:"signup",eventaction:"signup-failed",eventlabel:e,...r})}},l=i},p1TQ:(e,r,s)=>{s.d(r,{e7:()=>h,oj:()=>I,Ae:()=>p,V7:()=>O,kL:()=>D,s5:()=>U});var a=s("TqF5"),t=s("PbG0"),n=s("WKgy"),o=s("2+nF"),_=s("DLZI"),i=s("r2u9"),l=s("mwSn"),c=s("CiA5");class E extends l.A{constructor(e){super({errorName:c.$Z.GENERIC_ERROR,logger:!0,...e})}}class A extends E{constructor(e){super({errorMessage:"connect_status_unknown",analytics:{message:"unkown connect status sent by backend",...null==e?void 0:e.analytics},...e||{}})}}var d=s("rVxF"),u=s("WrS5"),R=s("H/eQ"),L=s("nrKQ"),g=s("Vd8Q");const p=e=>{let{link:r=""}=e||{};const{type:s="page"}=e||{};return"/"===r.charAt(0)||/^https?/.test(r)||(r="/"+r),{type:s,link:r}},I=(e,r)=>{const s=null==e?void 0:e.status;let{redirect:_}=r;try{n.A.dispatch((0,a.Oo)())}catch{}switch(s){case"success":t.Ay.pushSuccessfulLoginEvent(r.method),(0,o.Qc)(_);break;case"register":{const e=(()=>{if(/pay_register/g.test(location.href)){const e=location.href.indexOf("redirect_link");return location.href.substr(e,location.href.length).replace("redirect_link=","")}return null})();e&&(_=p({type:"page",link:decodeURIComponent(e)})),t.Ay.pushSuccessfulSignupEvent(r.method),(0,o.Qc)(_);break}default:throw new A}},O=(e,r=!1)=>{e&&r?n.A.dispatch((0,a.qf)({size:"small",name:u.b.PROFILE_MIGRATION_CONFIRMED,disableClosingAction:!0})):e&&(null===i.Ay||void 0===i.Ay||i.Ay.reloadApp(),location.reload())},U=e=>{e&&(null===i.Ay||void 0===i.Ay||i.Ay.reloadApp(),location.reload())},D=(e,r)=>{(e instanceof l.A||e instanceof d.A)&&e.handleError(r)},N=new _.A({call:L.A.callAsync.bind(L.A)},"production"),h=e=>(N.init(e,g.default.get("third_party_sdk_config")).then((()=>{switch(e){case"apple":R.A.resolve(R.A.apple.ready);break;case"facebook":R.A.resolve(R.A.facebook.ready);break;case"google":R.A.resolve(R.A.googleplus.ready);break;default:return}})),N)},rVxF:(e,r,s)=>{s.d(r,{A:()=>y,O:()=>m});var a=s("WrS5"),t=s("5U+Y"),n=s("Wp0Y"),o=s("CiA5");const _={[o.U5.DEFAULT]:()=>(0,n.AP)("errormessage_text_anerroroccurredpleasetryagain_web"),[o.U5.COUNTRY_NOT_VALID]:()=>(0,n.AP)("errormessage_text_signupunavailableinyourcountry_web"),[o.U5.COUNTRY_CLOSED_FREEMIUM]:()=>(0,n.AP)("errormessage_text_deezerunavailableinyourcountry_web"),[o.U5.MIN_LEGAL_AGE]:e=>(0,n.WI)("agerestrictionerrormessage_text_mustbeXyearsentervaliddate_web","agerestrictionerrormessage_text_mustbeXyearsentervaliddate_web",e||{sprintf:[t.fB],count:t.fB}),[o.U5.SOCIAL_ALREADY_CONNECTED]:e=>(0,n.AP)("errormessage_text_accountalreadylinkedwiththisXsocial_web",e),[o.U5.USER_ALREADY_LINKED]:e=>(0,n.AP)("errormessage_text_accountalreadylinkedwithaXsocial_web",e),[o.U5.EMAIL_ALREADY_USED_TITLE]:()=>(0,n.AP)("errormessage_title_accountalrdyassociatedwithemail_web"),[o.U5.EMAIL_ALREADY_USED_WITH_INSTANT_AUTH_BODY]:e=>(0,n.AP)("signinloginerrormessage_text_uselinksenttoXemailortryanother_web",e),[o.U5.EMAIL_ALREADY_USED_BODY]:e=>(0,n.AP)("errormessage_text_loginlnkXaccountfrmdzrsettings_web",e)},i=(e,r)=>_[e](r);var l=s("mwSn"),c=s("WKgy"),E=s("TqF5");class DataError extends l.A{constructor(e){super({modal:{data:{name:a.b.GENERIC_ERROR,props:{errorMessage:i(o.U5.DEFAULT)}}},analytics:{message:e.errorMessage},...e,errorName:o.$Z.DATA_ERROR})}}class A extends DataError{constructor(e){super({errorMessage:o.U1.SOCIAL_ALREADY_CONNECTED,...e})}_handleModal(e,r){c.A.dispatch((0,E.UJ)({name:a.b.GENERIC_ERROR,props:{errorMessage:i(o.U5.SOCIAL_ALREADY_CONNECTED,{sprintf:[r.method]})}}))}}class d extends DataError{constructor(e){super({errorMessage:o.U1.EMAIL_ALREADY_USED,...e})}_handleModal(e,r){c.A.dispatch((0,E.UJ)({name:a.b.GENERIC_ERROR,props:{title:i(o.U5.EMAIL_ALREADY_USED_TITLE),errorMessage:i(o.U5.EMAIL_ALREADY_USED_BODY,{sprintf:[r.method]})}}))}}class u extends DataError{constructor(e,r){super({errorMessage:o.U1.EMAIL_ALREADY_USED,modal:{data:{name:a.b.GENERIC_ERROR,props:{errorMessage:i(o.U5.EMAIL_ALREADY_USED_WITH_INSTANT_AUTH_BODY,{sprintf:[r]}),title:i(o.U5.EMAIL_ALREADY_USED_TITLE)}}},...e})}}class R extends DataError{constructor(e){super({errorMessage:o.U1.USER_NOT_LINKED,...e})}}class L extends DataError{constructor(e){super({errorMessage:o.U1.USER_ALREADY_LINKED,modal:{data:{name:a.b.GENERIC_ERROR}},...e})}_handleModal(e,r){c.A.dispatch((0,E.UJ)({name:a.b.GENERIC_ERROR,props:{errorMessage:i(o.U5.USER_ALREADY_LINKED,{sprintf:[r.method]})}}))}}class g extends DataError{constructor(e){super({errorMessage:o.U1.USER_USING_APPLE_EMAIL,...e})}}class p extends l.A{constructor(e){super({analytics:{message:e.errorMessage},modal:{data:{name:a.b.GENERIC_ERROR,props:{errorMessage:i(o.U5.DEFAULT)}}},errorName:o.$Z.REQUEST_ERROR,...e})}}class I extends p{constructor(e){super({errorMessage:o.nu.COUNTRY_NOT_VALID,modal:{data:{name:a.b.GENERIC_ERROR,props:{errorMessage:i(o.U5.COUNTRY_NOT_VALID)}}},...e})}}class O extends p{constructor(e){super({errorMessage:o.nu.INVALID_ACCOUNT_TYPE,...e})}}class U extends p{constructor(e){super({errorMessage:o.nu.MIN_LEGAL_AGE,modal:{data:{name:a.b.GENERIC_ERROR,props:{errorMessage:i(o.U5.MIN_LEGAL_AGE)}}},...e})}}class D extends p{constructor(e){super({errorMessage:o.nu.BIRTHDAY_NOT_VALID,...e})}}class N extends p{constructor(e){super({errorMessage:o.nu.MISSING_INFO,modal:{data:{name:a.b.MISSING_INFO_JOURNEY,props:{steps:e.steps}},isFull:!0},...e})}}class h extends l.A{constructor(e){super({analytics:{message:o.$Z.COUNTRY_CLOSED_FREEMIUM},modal:{data:{name:a.b.GENERIC_ERROR,props:{errorMessage:i(o.U5.COUNTRY_CLOSED_FREEMIUM)}}},...e,errorName:o.$Z.COUNTRY_CLOSED_FREEMIUM})}}const T=e=>{switch(e.errorName){case o.$Z.DATA_ERROR:return(e=>{var r;switch(e.errorMessage){case o.U1.EMAIL_ALREADY_USED:var s;return null!==(r=e.payload)&&void 0!==r&&r.INSTANT_AUTH?new u(e,null===(s=e.payload)||void 0===s?void 0:s.email):new d(e);case o.U1.USER_ALREADY_LINKED:return new L(e);case o.U1.USER_NOT_LINKED:return new R(e);case o.U1.USER_USING_APPLE_EMAIL:return new g(e);default:return-1!==e.errorMessage.indexOf(o.U1.SOCIAL_ALREADY_CONNECTED)?new A(e):new DataError(e)}})(e);case o.$Z.REQUEST_ERROR:return(e=>{switch(e.errorMessage){case o.nu.COUNTRY_NOT_VALID:return new I(e);case o.nu.INVALID_ACCOUNT_TYPE:return new O(e);case o.nu.MIN_LEGAL_AGE:return new U(e);case o.nu.BIRTHDAY_NOT_VALID:return new D(e);case o.nu.MISSING_EMAIL:case o.nu.EMAIL_EMPTY:case o.nu.EMAIL_NOT_VALID:case o.nu.EMAIL_DOMAIN_NOT_VALID:return new N({...e,steps:["email"]});case o.nu.MISSING_INFO:{var r;const s=null===(r=e.payload)||void 0===r?void 0:r.required_info;return new N({...e,steps:s})}default:return new p(e)}})(e);case o.$Z.COUNTRY_CLOSED_FREEMIUM:return(e=>new h(e))(e);default:return new l.A({logger:!0,modal:{data:{name:a.b.GENERIC_ERROR,props:{errorMessage:i(o.U5.DEFAULT)}}},...e})}},m=e=>e.name&&e.message&&typeof e.payload;class y extends Error{constructor(e){super("API Error"),this.payload=void 0,this.payload=e}handleError(e){try{Object.entries(this.payload.response.error).forEach((([r,s])=>{T({errorName:r,errorMessage:s,payload:this.payload.response.payload}).handleError(e)}))}catch{T({errorName:o.$Z.DEFAULT,errorMessage:""}).handleError(e)}}}},mwSn:(e,r,s)=>{s.d(r,{A:()=>_});var a=s("PKMp"),t=s("PbG0"),n=s("TqF5"),o=s("WKgy");class _ extends Error{constructor(e){super(),this.analytics=void 0,this.logger=void 0,this.modal=void 0,this.analytics=e.analytics,this.logger=e.logger,this.message=e.errorMessage,this.modal=e.modal,this.name=e.errorName}handleError(e){this.logger&&this._handleLogger(),this.analytics&&this._handleAnalytics(this.analytics,e),this.modal&&this._handleModal(this.modal,e)}_handleAnalytics(e,r){t.Ay.pushFailed3rdPartyConnectEvent(`${r.method} - ${e.message}`||"",r.intent)}_handleLogger(){a.A.error(this)}_handleModal(e,r){const s={size:"small",...e.data,props:{...e.data.props,...r}};o.A.dispatch((0,n.UJ)(s,e.isFull))}}},CiA5:(e,r,s)=>{s.d(r,{$Z:()=>a,U1:()=>t,U5:()=>o,nu:()=>n});let a=function(e){return e.APPLE_ERROR="APPLE_ERROR",e.COUNTRY_CLOSED_FREEMIUM="COUNTRY_CLOSED_FREEMIUM",e.DATA_ERROR="DATA_ERROR",e.DEFAULT="DEFAULT",e.FACEBOOK_ERROR="FACEBOOK_ERROR",e.GOOGLE_ERROR="GOOGLE_ERROR",e.GENERIC_ERROR="GENERIC_ERROR",e.REQUEST_ERROR="REQUEST_ERROR",e}({}),t=function(e){return e.EMAIL_ALREADY_USED="email_already_used",e.SOCIAL_ALREADY_CONNECTED="id_already_linked",e.USER_ALREADY_LINKED="user_already_linked",e.USER_NOT_LINKED="user_not_linked",e.USER_USING_APPLE_EMAIL="user_using_apple_email",e}({}),n=function(e){return e.BIRTHDAY_NOT_VALID="birthday_not_valid",e.COUNTRY_NOT_VALID="country_not_valid",e.EMAIL_DOMAIN_NOT_VALID="email_domain_not_valid",e.EMAIL_EMPTY="email_empty",e.EMAIL_NOT_VALID="email_not_valid",e.INVALID_ACCOUNT_TYPE="invalid_account_type",e.MIN_LEGAL_AGE="min_legal_age",e.MISSING_EMAIL="missing_email",e.MISSING_INFO="missing_info",e}({}),o=function(e){return e[e.COUNTRY_CLOSED_FREEMIUM=0]="COUNTRY_CLOSED_FREEMIUM",e[e.COUNTRY_NOT_VALID=1]="COUNTRY_NOT_VALID",e[e.DEFAULT=2]="DEFAULT",e[e.EMAIL_ALREADY_USED_BODY=3]="EMAIL_ALREADY_USED_BODY",e[e.EMAIL_ALREADY_USED_WITH_INSTANT_AUTH_BODY=4]="EMAIL_ALREADY_USED_WITH_INSTANT_AUTH_BODY",e[e.EMAIL_ALREADY_USED_TITLE=5]="EMAIL_ALREADY_USED_TITLE",e[e.MIN_LEGAL_AGE=6]="MIN_LEGAL_AGE",e[e.SOCIAL_ALREADY_CONNECTED=7]="SOCIAL_ALREADY_CONNECTED",e[e.USER_ALREADY_LINKED=8]="USER_ALREADY_LINKED",e}({})},exUT:(e,r,s)=>{s.d(r,{A:()=>R}),s("/eM8");var a=s("PbG0"),t=s("WLHJ");const n=e=>({method:t.K.FACEBOOK,...e});var o=s("TqF5"),_=s("WKgy"),i=s("p1TQ"),l=s("WrS5"),c=s("rVxF"),E=s("dgkV");const A=(0,i.e7)("facebook"),d=()=>{if(!A.facebook)throw new Error("LegacyAuth - Facebook not found, have you called init with facebook as a param?");return A.facebook},u=()=>{d().signout()},R={linkAccount:async e=>{try{const r=await d().linkAccount(e);(0,i.V7)(r,null==e?void 0:e.profile_migration)}catch(e){u();const r=n({intent:a.d6.Link});e instanceof Error&&(0,i.kL)(e,r)}},login:async(e,r)=>{try{const r=await d().signin(e);(0,i.oj)(r,{redirect:(0,i.Ae)(null==e?void 0:e.redirect),method:a.qR.Facebook})}catch(o){const _=n({intent:a.d6.Login,redirect:null==e?void 0:e.redirect});var s,t;if((0,c.O)(o))new E.A({error:null!==(s=o.message)&&void 0!==s?s:null===(t=o.payload)||void 0===t?void 0:t.status,journey_type:"facebook",error_message:o.message,gateway_method:"facebook.auth"}).send(),(0,i.kL)(new c.A(o),_);null==r||r(o)}},signout:u,signup:async(e,r)=>{try{const r=await d().signin(e);(0,i.oj)(r,{redirect:(0,i.Ae)(null==e?void 0:e.redirect),method:a.qR.Facebook})}catch(o){const _=n({intent:a.d6.Signup,redirect:null==e?void 0:e.redirect});var s,t;if((0,c.O)(o))new E.A({error:null!==(s=null===(t=o.payload)||void 0===t?void 0:t.status)&&void 0!==s?s:o.name,journey_type:"facebook",error_message:o.message,gateway_method:"facebook.auth"}).send(),(0,i.kL)(new c.A(o),_);null==r||r(o)}},unlinkAccount:()=>{_.A.dispatch((0,o.qf)({name:l.b.THIRD_PARTY_CONFIRM_UNLINK,size:"small",props:{method:"Facebook",confirmCallback:()=>(async()=>{try{const e=await d().unlinkAccount();(0,i.s5)(e)}catch(e){const r=n({intent:a.d6.Unlink});(0,c.O)(e)&&(0,i.kL)(new c.A(e),r)}})()}}))}}},WLHJ:(e,r,s)=>{s.d(r,{K:()=>a});let a=function(e){return e.APPLE="Apple",e.FACEBOOK="Facebook",e.GOOGLE="Google",e}({})},"5U+Y":(e,r,s)=>{s.d(r,{D3:()=>i,D6:()=>n,K9:()=>t,d0:()=>o,fB:()=>_,wz:()=>a});const a=8,t=50,n=2,o=50,_=16,i=150},dgkV:(e,r,s)=>{s.d(r,{A:()=>_});var a=s("LOQS"),t=s("ebSJ"),n=s("GXXn"),o=s("WKgy");const _=class{constructor(e){var r,s;this._log=void 0,this._log={device_uniq_id:(0,t.A)("dzr_uniq_id"),error_extra:"legacy",...(null===(r=o.A.getState())||void 0===r||null===(r=r.user)||void 0===r?void 0:r.COUNTRY)&&{country:null===(s=o.A.getState())||void 0===s||null===(s=s.user)||void 0===s?void 0:s.COUNTRY},...e}}send(){this._log={...this._log},a.A.log((0,n.L)("user.auth_vitals","1.0.0",this._log))}}},"2+nF":(e,r,s)=>{s.d(r,{Cb:()=>n,Qc:()=>t}),s("EV0h"),s("gS5K"),s("iooo"),s("/0Gg"),s("vXsw"),s("nrKQ"),s("Vd8Q");var a=s("r2u9");const t=e=>{null===a.Ay||void 0===a.Ay||a.Ay.reloadApp()},n=()=>{null===a.Ay||void 0===a.Ay||a.Ay.reloadApp()}}}]);