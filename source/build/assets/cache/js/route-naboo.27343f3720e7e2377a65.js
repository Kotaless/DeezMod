"use strict";(self.webpackJsonpDeezer=self.webpackJsonpDeezer||[]).push([[2416],{vHlZ:(e,t,n)=>{n.d(t,{A:()=>u});var s,i=n("+9dH"),a=n("q1tI"),r=n("HmE0"),o=n("YIja"),l=n("7bxg"),c=n("mUtM"),d=n("TRpf");const u=({id:e,onClose:t,message:n,action:u,...p})=>{const m=(0,d.wA)(),h=a.createElement(a.Fragment,null,u,a.createElement(r.K0,{"aria-label":"close","data-testid":"alert-close-btn",icon:s||(s=a.createElement(l.w,null)),key:"close",onClick:n=>{m((0,c.Hd)(e)),t&&t(n)},type:"button",variant:"outline"}));return a.createElement(o.N,(0,i.A)({"data-testid":`alert-${e}`,action:h},p),n)}},"J/yO":(e,t,n)=>{n.d(t,{Ay:()=>m,Ov:()=>p,Y9:()=>u}),n("/eM8");var s=n("q1tI"),i=n("nrKQ"),a=n("7+7Q"),r=n("lXQd"),o=n("TRpf"),l=n("6yJ+"),c=n("vGT4");const d=(0,s.createContext)({adsConfigState:{},loadAdConfig:()=>{},getProfileType:()=>"regular",getProfileReg:()=>"0",getProfileUs:()=>"0",getProfileOfferType:()=>"",getDzgroup:()=>[],hasDisplayAds:()=>!0,adsConfigReady:!1,isMidTierOffer:()=>!1}),u=()=>(0,s.useContext)(d),p=({children:e})=>{const[t,n]=(0,s.useState)({}),[u,p]=(0,s.useState)(!1),{state:m}=(0,c.b)(),h=(0,o.wA)();let g=!1;(0,s.useEffect)((()=>{const e=null==m||!m.settings||m.settings.noIabVendors.includes(1);y({profile:{hasConsent:e}})}),[m]);const y=e=>{const s=(0,a.A)(t,e);n((()=>s)),h({type:l.J,data:s})},f=()=>(0,r.A)(t,"profile.name");return s.createElement(d.Provider,{value:{adsConfigState:t,loadAdConfig:async()=>{g||await(async()=>(g=!0,i.A.call({method:"deezer.adConfig",success:e=>{g=!1,y(e),p(!0)},error:e=>{throw g=!1,e}})))()},getProfileType:f,hasDisplayAds:()=>"starter"!==f(),getProfileReg:()=>{var e;return null===(e=(0,r.A)(t,"profile.reg"))||void 0===e?void 0:e.toString()},getDzgroup:()=>(0,r.A)(t,"targeting.smart.dzgroup"),adsConfigReady:u,getProfileOfferType:()=>{var e;return null===(e=(0,r.A)(t,"profile.offer_type"))||void 0===e?void 0:e.toString()},isMidTierOffer:()=>{var e;return(null===(e=(0,r.A)(t,"profile.offer_type"))||void 0===e?void 0:e.toString())===l.u.DEEZER_NOW}}},e)},m=d},"4PKR":(e,t,n)=>{n.d(t,{Ay:()=>d,gA:()=>o,u4:()=>c,wZ:()=>l});var s=n("+9dH"),i=n("q1tI");const a=[[0,0],[1e3,90],[1e3,250],[970,90],[970,250],[728,90],[2160,1e3]],r=(0,i.createContext)({isScriptLoaded:!1,isSponsored:!1,setIsSponsored:()=>{},destroySlot1:()=>{},displayAdSlot:()=>{},isArchBanner:!1}),o=()=>(0,i.useContext)(r),l=({children:e})=>{const[t,n]=(0,i.useState)(!1),[s,o]=(0,i.useState)(!1),[l,c]=(0,i.useState)(""),[d,u]=(0,i.useState)(!1),p=e=>{e.size&&2160===e.size[0]?u(!0):u(!1)},m=e=>{const t=window.googletag;var n;return"function"==typeof t.pubads&&(t&&(null==t||null===(n=t.pubads())||void 0===n?void 0:n.getSlots())).some((t=>t.getSlotElementId()===e))};return(0,i.useEffect)((()=>{(e=>{const t=document.createElement("script");t.src="https://securepubads.g.doubleclick.net/tag/js/gpt.js",t.async=!0,document.body.appendChild(t),t.onload=()=>{window.googletag=window.googletag||{cmd:[]},n(!0)}})()}),[]),i.createElement(r.Provider,{value:{isScriptLoaded:t,setIsSponsored:o,isSponsored:s,displayAdSlot:e=>{const t=window.googletag;e&&c(e);const n=m("adslot1"),s=e||l;!n&&s&&t.cmd.push((()=>{var e;const n=null==t||null===(e=t.defineSlot(s,a,"adslot1"))||void 0===e?void 0:e.addService(t.pubads()).setTargeting("placement","web_adslot1");n&&t.pubads().addEventListener("impressionViewable",(e=>{const t=e.slot;setTimeout((()=>{googletag.pubads().refresh([t])}),3e4)})),n&&t.pubads().refresh([n])})),t.cmd.push((()=>{t.pubads().addEventListener("slotRenderEnded",p)}))},destroySlot1:()=>{const e=m("adslot1"),t=window.googletag;e&&t&&(null==t||t.destroySlots()),t.cmd.push((()=>{t.pubads().removeEventListener("slotRenderEnded",p)})),d&&u(!1)},isArchBanner:d}},e)},c=e=>t=>{const n=(0,i.useContext)(r);return i.createElement(e,(0,s.A)({},n,t))},d=r},"+Whx":(e,t,n)=>{n.d(t,{J0:()=>k,iy:()=>A,$r:()=>y,H6:()=>f,FP:()=>E,yK:()=>_,Ay:()=>T,ZQ:()=>b}),n("/eM8"),n("gS5K");var s=n("q1tI"),i=n("nrKQ"),a=n("WKgy"),r=n("H/eQ"),o=n("tZCQ"),l=n("J/yO");const c=e=>new Promise(((t,n)=>{const s=document.createElement("script");s.async=!0,s.src=e,s.onload=t,s.onerror=n,document.body.appendChild(s)}));let d=null,u=null;const p=()=>{d=null},m=async(e,t,n)=>{const s=document.createElement("div");s.id="mediaElement",s.style.position="fixed",s.style.top="0",s.style.left="0",s.style.width="100vw",s.style.height="100vh",s.style.background="rgba(0, 0, 0, 0.3)",s.style.backdropFilter="blur(10px)",s.style.display="flex",s.style.justifyContent="center",s.style.alignItems="center",s.style.zIndex="999",document.body.appendChild(s);const i=document.createElement("div");i.id="adContainer",i.style.zIndex="1000",i.style.cursor="pointer",i.style.position="fixed",i.style.left="0",i.style.top="0",i.style.background="rgba(0, 0, 0, 0.3)",document.body.appendChild(i);try{const s=window,i=await(()=>{const e=window;return e.google&&e.google.ima?Promise.resolve(e.google.ima):d||(d=c("https://imasdk.googleapis.com/js/sdkloader/ima3.js").then((()=>e.google.ima)),d.then(p).catch(p),d)})(),a=await(()=>{const e=window;return e.vastImaPlayer?Promise.resolve(e.vastImaPlayer):u||(u=c("https://unpkg.com/@glomex/vast-ima-player@1/dist/vast-ima-player.umd.js").then((()=>e.vastImaPlayer)),u.then(p).catch(p),u)})(),r=new s.google.ima.AdsRenderingSettings;r.uiElements=[i.UiElements.AD_ATTRIBUTION,i.UiElements.COUNTDOWN];const o=document.getElementById("mediaElement"),l=document.getElementById("adContainer"),m=new a.Player(i,o,l,r);o.volume=1,o.muted=!1;const h=new s.google.ima.AdsRequest;h.adsResponse=e,m.playAds(h);const g=document.querySelector("video");g.style.background="transparent";const y=()=>{document.hidden?(g.pause(),n(!1)):(g.play(),n(!0))},f=()=>{g.play(),n(!0)},A=()=>{g.pause(),n(!1)},_=()=>{document.addEventListener("visibilitychange",y),window.addEventListener("focus",f),window.addEventListener("blur",A)};m.addEventListener("AdComplete",(()=>{t(),document.removeEventListener("visibilitychange",y),window.removeEventListener("focus",f),window.removeEventListener("blur",A)})),_()}catch{return t()}};var h=n("u7vQ"),g=n("AfN5");const y=new URLSearchParams(window.location.search).get("fastAds"),f=6e3,A=54e4,_=36e4,E=18e4,v=(0,s.createContext)({loadAudioBreak:e=>{},audioBreakState:{},triggerVideoAds:()=>{}}),b=()=>(0,s.useContext)(v),S={type:"",content:null,cta:{},tracking:{},smartad_mediation_parameters:{}},k=({children:e})=>{const[t,n]=(0,s.useState)(S),[c,d]=(0,s.useState)(!0),u=new URLSearchParams(window.location.search).get("autoplay"),p="1"===u||"true"===u,[y,f]=(0,s.useState)(p?0:1),{getProfileReg:A}=(0,l.Y9)(),_=()=>{r.A.trigger(r.A.triton.audioEnd);const e=document.getElementById("mediaElement");null==e||e.remove();const t=document.getElementById("adContainer");null==t||t.remove()};return h.Ay.getPlayerType()!==g.Cc.ADS&&h.Ay.getPlayerType()!==g.Cc.TRITON_AD||location.pathname.includes("/game/")&&(r.A.trigger(r.A.triton.audioEnd),r.A.trigger(r.A.ads.adEnd)),s.createElement(v.Provider,{value:{audioBreakState:t,loadAudioBreak:async e=>{await(async e=>{let t;if(!(y&&Number(A())<=30)){const s=a.A.getState().player,r=i.A.call({method:"deezer.getAudiobreak",data:{consent_string:e||"",listening_context:"",track_list:s.music.list,player_track_id:s.music.track.SNG_ID,player_content_type:s.music.context.TYPE,player_content_id:s.music.context.ID,focus:c?1:0,preroll:y},success:e=>{const t={...S,...e};"string"==typeof t.cta.tracking_url&&(t.cta.tracking_url=""!==t.cta.tracking_url.trim()?[t.cta.tracking_url]:[]),o.A.isAllowed("ad_force_video")&&(t.type="VIDEO_AD"),n(t)},error:e=>{throw e}});t=await r}return f(0),t})(e)},smartAdsMediationParameters:e=>0===Object.keys(e).length?0:e.smartad_mediation_parameters,triggerVideoAds:()=>{const{type:e,content:n}=t;"VIDEO_AD"===e&&m(n.vast,_,d)}}},e)},T=v},GOtF:(e,t,n)=>{n.d(t,{A:()=>l});var s=n("+9dH"),i=n("q1tI"),a=n("+Whx"),r=n("J/yO"),o=n("4PKR");const l=e=>t=>i.createElement(o.Ay.Consumer,null,(n=>i.createElement(a.Ay.Consumer,null,(a=>i.createElement(r.Ay.Consumer,null,(r=>i.createElement(e,(0,s.A)({},t,{adsContext:n,audioBreakContext:a,adsConfigContext:r}))))))))},pIhH:(e,t,n)=>{n.d(t,{Ay:()=>p,y5:()=>d});var s=n("q1tI"),i=n("TRpf"),a=n("H/eQ"),r=n("WBQ7"),o=n("xobL");const l="wakeUpNotification-time",c="wakeUpNotification-cap";let d=function(e){return e.LTR="ltr",e.RTL="rtl",e}({});class u extends s.Component{constructor(...e){super(...e),this.createGenericNotification=e=>new Notification("Deezer",{body:"Why not listen again to some music?",dir:e,silent:!0}),this.createTrackNotification=(e,t,n)=>new Notification("Deezer",{body:`You last listened to ${e} by ${t.map((e=>e.ART_NAME)).join(", ")}. What will you listen to next?`,dir:n,silent:!0}),this.shouldLaunchTimer=()=>{if(!this.props.isPaused)return!1;const e=Number(r.default.get(l,"0")),t=(new Date).setDate((new Date).getDate()-1),n=Number(r.default.get(c,"0"));return e<t&&n<5},this._onBlur=()=>{this.shouldLaunchTimer()&&(this._timer=window.setTimeout(this._notify,this.props.delay))},this._onFocus=()=>{clearTimeout(this._timer)},this._onNotificationShown=()=>{r.default.set(l,Date.now())},this._notify=()=>{const{trackTitle:e,trackArtists:t,langDirection:n}=this.props;if(e&&t)return this._notification=this.createTrackNotification(e,t,n),void this._setNewCap();this._notification=this.createGenericNotification(n),this._setNewCap()},this._setNewCap=()=>{r.default.set(l,Date.now()),r.default.set(c,Number(r.default.get(c,0)+1))},this._notification=void 0,this._timer=void 0}componentDidMount(){window.addEventListener(a.A.ads.blur,this._onBlur),window.addEventListener(a.A.ads.focus,this._onFocus)}componentWillUnmount(){window.removeEventListener(a.A.ads.blur,this._onBlur),window.removeEventListener(a.A.ads.focus,this._onFocus)}render(){return null}}u.defaultProps={delay:72e5,trackTitle:void 0,trackArtists:[]};const p=(0,i.Ng)((e=>({langDirection:(0,o.iJ)(e.user),isPaused:!e.player.control.playing,trackTitle:e.player.music.trackTitle,trackArtists:e.player.music.trackArtists})))(u)},r2ys:(e,t,n)=>{n.d(t,{A:()=>r});var s=n("q1tI"),i=n("uHHB"),a=n("vGT4");const r=()=>{const{state:e}=(0,a.b)(),t=(e=>null==e?void 0:e.settings)(e);return(0,s.useEffect)((()=>{const{consentString:e,statistics:n=0,targetedAdvertising:s=0}=t||{};window.sas&&window.sas.cmd.push((()=>{window.sas.setGdprConsentData(e)})),(0,i.A)("consentStatistics",n.toString(),100),(0,i.A)("consentMarketing",s.toString(),100)}),[t]),null}},PMuG:(e,t,n)=>{n.r(t),n.d(t,{App:()=>_g,default:()=>vg});var s=n("+9dH"),i=(n("/eM8"),n("q1tI")),a=n("TRpf"),r=n("juqV"),o=n("X6oL"),l=n("Qyje"),c=n.n(l),d=n("WmA5"),u=n("D+Zh"),p=n("ntT5"),m=n("WBQ7");const h="local",g="session",y=window.sessionStorage,f={getStorageKey:e=>`ALERT_DISMISSED_${e}`,markAsDismissed(e,t=h){const n=this.getStorageKey(e);t!==g?m.default.set(n,!0):y.setItem(n,!0)},isDismissed(e,t=h){const n=this.getStorageKey(e);return t===g?Boolean(y.getItem(n)):m.default.isset(n)}};var A=n("H/eQ"),_=n("tZCQ"),E=n("yyc2"),v=n("PKMp"),b=n("e2eG"),S=n("iooo"),k=n("xobL"),T=n("aHAS"),C=n("MeIc"),w=n("nxAS"),I=n("mUtM"),x=n("TqF5"),P=n("Qi9J"),N=n("Zah6"),R=n("jKJc"),L=n("DdAs"),D=n("LSdk"),O=n("WKgy"),M=n("LjZa"),U=n("WfRu"),F=n("/uRm");const z={[F.F.ONBOARDING_LEGACY]:i.lazy((()=>n.e(4822).then(n.bind(n,"Mg2f")))),[F.F.ONBOARDING]:i.lazy((()=>n.e(5986).then(n.bind(n,"5s/P")))),[F.F.SELECT_PROFILE]:i.lazy((()=>n.e(6224).then(n.bind(n,"IXQs")))),[F.F.BRIDGED_WEBVIEW]:i.lazy((()=>n.e(5528).then(n.bind(n,"nMxs")))),[F.F.PLAYLIST_ASSISTANT]:i.lazy((()=>n.e(5528).then(n.bind(n,"9kfl"))))};var B,G;class Q extends i.Component{constructor(...e){super(...e),this._containerRef=i.createRef(),this.renderModal=(e,t,n)=>i.createElement(R.aF,{isOpen:t,motionPreset:"none",size:"full",portalProps:{containerRef:this._containerRef},onClose:()=>{},trapFocus:!1},B||(B=i.createElement(L.mH,null)),i.createElement(L.$m,{mx:"0",py:"0",bg:"bg.main"},n?i.createElement(L.cw,{bg:"bg.main",maxH:"100vh"},e):i.createElement(i.Fragment,null,e))),this.renderDrawer=(e,t,n)=>i.createElement(L._s,{isOpen:t,placement:"bottom",size:"full",portalProps:{containerRef:this._containerRef},onClose:()=>{},trapFocus:!1},G||(G=i.createElement(L.QP,null)),i.createElement(L.zj,null,n?i.createElement(L.ys,{bg:"background.neutral.primary.default",overflow:"hidden",overflowY:"auto"},e):i.createElement(i.Fragment,null,e))),this._close=()=>{this.props.closeScreen()}}componentDidUpdate(e){!e.isOpen&&this.props.isOpen&&this.props.hidePopper()}render(){const{isOpen:e,data:t,name:n,withTransition:a}=this.props,r=!("hideLogo"in t)||!1===t.hideLogo,o="fixedLogo"in t&&!0===t.fixedLogo,l=!("disableDisplayPadding"in t)||!1===t.disableDisplayPadding,c=function(e){return z[e]||!1}(n),d=e&&Boolean(c),u=i.createElement(i.Fragment,null,r?i.createElement("div",{className:"full-screen-logo-holder"},i.createElement(D.T,{h:"24px",mt:"20px",position:o?"fixed":void 0})):null,d&&c&&i.createElement(i.Suspense,{fallback:null},i.createElement(c,(0,s.A)({},t,{closeScreen:this._close}))));return i.createElement("div",{ref:this._containerRef},a?this.renderDrawer(u,d,l):this.renderModal(u,d,l))}}Q.defaultProps={closeScreen:M.A,withTransition:!1},O.A.addReducers({fullscreen:w.Ay});const H=(0,a.Ng)((({fullscreen:{name:e,data:t}})=>({name:e,data:t,isOpen:Boolean(e)})),{closeScreen:w.Fn,hidePopper:U.Lm})(Q);var Y=n("k9rF"),V=n("NmXx"),j=n("vHlZ"),W=n("Wp0Y");const K=e=>{const t={status:"info",message:(0,W.AP)("Votre ordinateur semble être hors ligne. Nous essayons de vous reconnecter."),...e};return i.createElement(j.A,t)};var $=n("vbKs"),J=n("NSet");class X extends i.PureComponent{constructor(...e){super(...e),this.alertComponents={[$.ts]:K,[$.B6]:i.lazy((()=>n.e(1970).then(n.bind(n,"x38L")))),[$.Iv]:i.lazy((()=>n.e(98).then(n.bind(n,"0vC3")))),[$.AT]:i.lazy((()=>n.e(1169).then(n.bind(n,"/AoH")))),[$.I6]:i.lazy((()=>n.e(846).then(n.bind(n,"eRco")))),[$.mu]:i.lazy((()=>n.e(591).then(n.bind(n,"mYFn")))),[$.v4]:i.lazy((()=>n.e(877).then(n.bind(n,"pSuW")))),[$.KE]:i.lazy((()=>n.e(2344).then(n.bind(n,"jFpR")))),[$.cn]:i.lazy((()=>n.e(6745).then(n.bind(n,"598w")))),[$.aC]:i.lazy((()=>n.e(3918).then(n.bind(n,"2UWz")))),[$.h5]:i.lazy((()=>n.e(1017).then(n.bind(n,"AhgF")))),[$.jE]:i.lazy((()=>n.e(3287).then(n.bind(n,"cueV"))))}}render(){const{alerts:e}=this.props;return i.createElement(J.az,{className:"page-alerts"},i.createElement(Y.N,null,e.map((e=>{const t=this.alertComponents[e.id]||j.A;return i.createElement(V.P.div,{key:e.id,initial:{opacity:0,transform:"translate3d(0, -8px, 0)"},animate:{opacity:1,transform:"translate3d(0, 0, 0)"},exit:{opacity:0,transform:"translate3d(0, -8px, 0)"}},i.createElement("div",{className:"alert-wrapper"},i.createElement(i.Suspense,{fallback:null},i.createElement(t,(0,s.A)({id:e.id},e.options)))))}))))}}const Z=(0,a.Ng)((({alerts:e})=>({alerts:e})))(X);n("EV0h"),n("gS5K");var ee=n("VkUI"),te=n("WrS5");const ne=[{name:"gift_result_premium",modal:te.b.LIGHTBOX_GIFT_RESULT,getProps:e=>{const t=new URL(e);return{email:t.searchParams.get("email"),code:t.searchParams.get("code")}},size:"small"}],se=()=>{const e=window.__DZR_MODAL_PATH__||{},t=(0,a.wA)();return(0,i.useEffect)((()=>{var n;if("string"==typeof(null==(n=e)?void 0:n.type)&&"string"==typeof(null==n?void 0:n.page)&&"modal"===e.type){const n=ne.find((t=>e.page.includes(t.name)));var s;if(n)return void t((0,x.qf)({name:n.modal,props:n.getProps(e.page),size:null!==(s=n.size)&&void 0!==s?s:"small"}));ee.default.open(decodeURIComponent(e.page))}}),[e]),null};var ie=n("ea/m"),ae=n("5pmF"),re=n("axbb"),oe=n("Ty5D"),le=n("kSUS"),ce=n("go2a"),de=n("Swh8"),ue=n("HmE0"),pe=n("XkdG"),me=n("RGaU"),he=n("wtnB"),ge=n("7bxg"),ye=n("D2sd"),fe=n("lXQd"),Ae=n("nrKQ");const _e="search/SEARCH_SUGGESTED_QUERIES_LOADING",Ee="search/SEARCH_SUGGESTED_QUERIES_SUCCESS",ve="search/SEARCH_SUGGESTED_QUERIES_RESET",be={suggestedQueries:{query:void 0,isLoading:!1,isEmpty:!0,result:void 0},cache:[]};function Se(e){return!(e&&(e.HISTORY&&0!==e.HISTORY.length||e.SUGGESTION&&0!==e.SUGGESTION.length))}function ke(e,t){return{query:t,isLoading:!1,isEmpty:Se(e),result:{...e,HISTORY:e.HISTORY.map((e=>({QUERY:e.QUERY})))}}}const Te=[];function Ce(){Te.forEach(Ae.A.cancel)}const we=e=>(0,fe.A)(e,"suggestedQueries.query",""),Ie=e=>e.suggestedQueries.isEmpty,xe=e=>e.suggestedQueries.isLoading,Pe=()=>e=>{e({type:ve})};var Ne,Re=n("xOQS"),Le=n("3o0m"),De=n("LOQS"),Oe=n("GsJb"),Me=n("4liH"),Ue=n("GkjM"),Fe=n("pgcI");class ze extends i.Component{constructor(e){super(e),this._onClick=this._onClick.bind(this)}render(){const{isSelected:e,"data-testid":t}=this.props,n=(0,r.A)("search-item",{"is-selected":e});return i.createElement(Ue.A,{className:n,to:this._getQueryUrl(),onClick:this._onClick,"data-testid":t},this._renderTitle(),this._renderSponsoredTag(),this._renderIcon())}_renderTitle(){const{query:e,highlight:t}=this.props;if(!e)return null;if(t&&t.length>0)return i.createElement("span",{className:"search-item-label",dangerouslySetInnerHTML:{__html:t}});const n=0===e.indexOf("+")&&e.length>1?e.substr(1,e.length):e;return i.createElement("span",{className:"search-item-label"},n)}_renderSponsoredTag(){const{isSponsored:e}=this.props;return e?i.createElement(J.EY,{as:"span",fontSize:"12px"},(0,W.AP)("generic_title_sponsored_web")):null}_renderIcon(){const{query:e,context:t}=this.props;return e&&t&&(t===p.f||t===p.IH)?Ne||(Ne=i.createElement(Fe.q,{className:"search-item-icon"})):null}_onClick(){const{query:e,context:t,index:n,isAuth:s,onSelect:i}=this.props;(0,p.Uw)("",e,t,Me.SA,n),i(e),s&&b.A.addSearchHistory(e)}_getQueryUrl(){const{query:e}=this.props;return e?0===e.indexOf("#")&&e.length>1?`/tags/${encodeURIComponent(e.slice(1))}`:`/search/${encodeURIComponent(e)}`:null}}ze.defaultProps={highlight:void 0,index:0,isSelected:!1,onSelect:()=>{}};const qe=(0,a.Ng)((({user:e})=>({isAuth:e.isAuth})))(ze),Be={upArrow:38,downArrow:40};class Ge extends i.Component{constructor(e){super(e),this._clearSearchHistory=this._clearSearchHistory.bind(this),this._onKeydown=this._onKeydown.bind(this),this._changeQuerySelected=this._changeQuerySelected.bind(this),this.state={indexQuerySelected:-1}}componentDidMount(){const{history:e,trending:t,inputRef:n}=this.props,s=e.concat(t);n&&n.current&&s&&s.length>0&&n.current.addEventListener("keydown",this._onKeydown),t&&t.length&&De.A.log({type:"cdp",eventName:"screen_view",customAttributes:{screen_view_name:"search_trendings"}})}componentWillUnmount(){const{inputRef:e}=this.props;e&&e.current&&e.current.removeEventListener("keydown",this._onKeydown)}render(){return i.createElement(i.Fragment,null,this._renderTags(),this._renderHistory(),this._renderTrendingQueries())}_renderTags(){const{tags:e,trending:t}=this.props;return!e.length||t.length?null:i.createElement("div",{className:"search-category"},i.createElement(J.DZ,{variant:"heading.s",mb:"spacing.s"},(0,W.AP)("Tags")),i.createElement(Oe.A,{tags:e,overflowHidden:!1}))}_renderTrendingQueries(){const{trending:e,history:t,onQuerySelectedChange:n}=this.props,{indexQuerySelected:s}=this.state;if(!e||!e.length)return null;const a=_.A.isAllowed("search_sponsored_trending_queries");return i.createElement("div",{className:"search-category"},i.createElement(J.DZ,{variant:"heading.s",mb:"spacing.s"},(0,W.AP)("Les plus recherchés")),e.map(((e,r)=>i.createElement(qe,{key:`query_${e.QUERY}`,query:e.QUERY,index:r,isSelected:r===s-t.length,isSponsored:a&&e.SPONSORED,onSelect:n,context:p.vm,"data-testid":e.SPONSORED?"search_suggestion_sponsored":"search_suggestion"}))))}_renderHistory(){const{history:e,onQuerySelectedChange:t}=this.props,{indexQuerySelected:n}=this.state;return e&&e.length?i.createElement("div",{className:"search-category"},i.createElement(J.so,{justifyContent:"space-between"},i.createElement(J.DZ,{variant:"heading.s",mb:"spacing.s"},(0,W.AP)("Dernières recherches")),i.createElement(ue.$n,{size:"small",variant:"link",color:"text.neutral.secondary.default",onClick:this._clearSearchHistory,_hover:{textDecoration:"underline"}},(0,W.AP)("Effacer"))),e.map(((e,s)=>i.createElement(qe,{key:`query_${e.query}`,query:e.query,index:s,isSelected:s===n,onSelect:t,context:p.IH})))):null}_onKeydown(e){const{history:t,trending:n}=this.props,s=t.concat(n);if(!Object.values(Be).includes(e.keyCode))return;e.stopPropagation(),e.preventDefault();const{indexQuerySelected:i}=this.state;let a=-1;a=e.keyCode===Be.upArrow?-1===i?s.length-1:i-1:i===s.length-1?-1:i+1,this._changeQuerySelected(a)}_changeQuerySelected(e){const{history:t,trending:n,onQuerySelectedChange:s}=this.props,{indexQuerySelected:i}=this.state,a=t.concat(n);"function"!=typeof s||i===e||e<-1||e>=a.length||(s(a&&a[e]&&(a[e].QUERY||a[e].query)||null),this.setState({indexQuerySelected:e}))}_clearSearchHistory(){const{isAuth:e}=this.props;e&&b.A.clearSearchHistory(),this.props.onHistoryClear()}}Ge.defaultProps={inputRef:null,onHistoryClear:void 0,onQuerySelectedChange:void 0};const Qe=(0,a.Ng)((({user:e})=>({isAuth:e.isAuth})))(Ge),Ye={upArrow:38,downArrow:40};class Ve extends i.Component{constructor(e){super(e),this._onKeydown=this._onKeydown.bind(this),this._changeQuerySelected=this._changeQuerySelected.bind(this),this.state={indexQuerySelected:-1}}componentDidMount(){const{inputRef:e}=this.props;e&&e.current&&e.current.addEventListener("keydown",this._onKeydown)}componentWillUnmount(){const{inputRef:e}=this.props;e&&e.current&&e.current.removeEventListener("keydown",this._onKeydown)}render(){const{queries:e}=this.props,{indexQuerySelected:t}=this.state;let n,s,a=[],r=[];return e&&e.HISTORY&&e.HISTORY.length&&(a=e.HISTORY.slice(0,Math.min(e.HISTORY.length,4)),n=t<a.length?t:-1),e&&e.SUGGESTION&&e.SUGGESTION.length&&(r=e.SUGGESTION.slice(0,Math.min(e.SUGGESTION.length,10-e.HISTORY.length)),s=t>=a.length?t-a.length:-1),this._queries=a.concat(r),i.createElement("div",{className:"search-category"},this._renderSuggestedHistory(a,n),this._renderSuggestedQueries(r,s))}_renderSuggestedHistory(e,t){return e&&e.length?e.map(((e,n)=>i.createElement(qe,{key:`query_${e.QUERY}`,query:e.QUERY,index:n,isSelected:n===t,context:p.f}))):null}_renderSuggestedQueries(e,t){return e&&e.length?e.map(((e,n)=>i.createElement(qe,{key:`query_${e.QUERY}`,query:e.QUERY,highlight:e.HIGHLIGHT||null,index:n,isSelected:n===t,onSelect:this.props.onQuerySelectedChange,context:p.fk}))):null}_onKeydown(e){if(!this._queries||!this._queries.length||!Object.values(Ye).includes(e.keyCode))return;e.stopPropagation(),e.preventDefault();const{indexQuerySelected:t}=this.state;let n=-1;n=e.keyCode===Ye.upArrow?-1===t?this._queries.length-1:t-1:t===this._queries.length-1?-1:t+1,this._changeQuerySelected(n)}_changeQuerySelected(e){const{onQuerySelectedChange:t}=this.props,{indexQuerySelected:n}=this.state;"function"!=typeof t||n===e||e<-1||e>=10||(this.props.onQuerySelectedChange(this._queries&&this._queries[e]&&this._queries[e].QUERY||null),this.setState({indexQuerySelected:e}))}}Ve.defaultProps={inputRef:null};const je=Ve;class We extends i.Component{constructor(e){super(e),this._onHistoryChange=this._onHistoryChange.bind(this),this.state={searchHistory:b.A.data.SEARCH_HISTORY?b.A.data.SEARCH_HISTORY.data:[],userTags:b.A.data.USER_TAGS?b.A.data.USER_TAGS.data:[],trendingQueries:b.A.data.TRENDING_QUERIES?b.A.data.TRENDING_QUERIES.data:[]}}componentDidMount(){A.A.subscribe(A.A.user.updateSearchHistory,this._onHistoryChange)}shouldComponentUpdate(e){return!(!this.props.isSuggestLoading||e.isSuggestLoading)||""!==this.props.query&&""===e.query}componentWillUnmount(){A.A.unsubscribe(A.A.user.updateSearchHistory,this._onHistoryChange)}render(){const{query:e,suggestedQuery:t,isSuggestEmpty:n}=this.props,s=e.trim();return s&&_.A.isAllowed("search_instant_search")||s&&s!==t||e&&n?null:i.createElement(Le.A,{className:"popper-search",size:this.props.size},this._renderContent())}_renderContent(){const{query:e,onClose:t,onQuerySelectedChange:n,inputRef:s,suggestedResult:a}=this.props,{searchHistory:r,trendingQueries:o,userTags:l}=this.state,c=e?i.createElement(je,{queries:a,inputRef:s,onQuerySelectedChange:n}):i.createElement(Qe,{history:r,trending:o,tags:l,inputRef:s,onHistoryClear:t,onQuerySelectedChange:n});return i.createElement(J.so,{flexDirection:"column",maxHeight:"440px",overflowY:"auto"},c)}_onHistoryChange(){this.setState({searchHistory:b.A.data.SEARCH_HISTORY.data})}}We.defaultProps={onQuerySelectedChange:void 0,inputRef:null,size:null};const Ke=(0,Re.A)((0,a.Ng)((({user:e,searchSuggest:t})=>{return{isAuth:e.isAuth,suggestedQuery:we(t),suggestedResult:(n=t,(0,fe.A)(n,"suggestedQueries.result",null)),isSuggestLoading:xe(t),isSuggestEmpty:Ie(t)};var n}))(We));var $e,Je;const Xe="topbar-search";class Ze extends i.Component{constructor(e){super(e),this._unlisten=null,this._inputRef=i.createRef(),this._fetchSuggestedQuery=(0,le.A)(this._fetchSuggestedQuery.bind(this),400),this._instantSearch=(0,le.A)(this._instantSearch.bind(this),300),this._onSearchChange=this._onSearchChange.bind(this),this._onSearchSubmit=this._onSearchSubmit.bind(this),this._onSearchReset=this._onSearchReset.bind(this),this._onSearchFocus=this._onSearchFocus.bind(this),this._onSearchKeyDown=this._onSearchKeyDown.bind(this),this._changeQueryToDisplay=this._changeQueryToDisplay.bind(this),this._trackSearchTyped=this._trackSearchTyped.bind(this),this.state={query:this._getSearchQuery(e.location)}}componentDidMount(){const{history:e}=this.props;window.addEventListener("visibilitychange",this._trackSearchTyped),this._unlisten=e.listen((e=>{e.pathname.includes("search")||this._trackSearchTyped(),this.setState({query:this._getSearchQuery(e)})}))}componentDidUpdate(){const{isSuggestLoading:e,dispatchCancelSearch:t}=this.props,{query:n}=this.state;""===n&&e&&t()}componentWillUnmount(){this._unlisten(),window.removeEventListener("visibilitychange",this._trackSearchTyped)}render(){const{isContentVisible:e,isSuggestLoading:t}=this.props,{query:n}=this.state,a=""!==n,o=(0,W.AP)("Rechercher"),l=(0,r.A)("topbar-search-form",{"topbar-search-active":a}),c=(0,r.A)("topbar-search-clear",{"is-active":(e||t)&&a}),d={"aria-label":o,placeholder:(0,W.AP)("searchfielddescription_text_artiststrackspodcasts_web"),value:n,onChange:this._onSearchChange,onFocus:this._onSearchFocus,onKeyDown:e?this._onSearchKeyDown:void 0,ref:this._inputRef},u={popperId:Xe,hasArrow:!1,closeOnClick:!1,isFullWidth:!0,data:{query:n,inputRef:this._inputRef,onQuerySelectedChange:this._changeQueryToDisplay}};return i.createElement("div",{className:"topbar-search"},i.createElement(Ke,u,i.createElement("form",{className:l,autoComplete:"off",onSubmit:this._onSearchSubmit,"data-testid":"search_container"},i.createElement(ce.M,null,$e||($e=i.createElement(de.W,{pointerEvents:"auto"},i.createElement(ue.K0,{variant:"link",type:"submit","aria-labelledby":"topbar-search",icon:i.createElement(he.o,{color:"icon.neutral.primary.default"}),pointerEvents:"none"}))),i.createElement(pe.p,(0,s.A)({id:"topbar-search",type:"search"},d,{"data-testid":"search_field"})),i.createElement(de.t,null,this._renderLoading()),i.createElement(de.t,{className:c},i.createElement(ue.K0,{variant:"link",onClick:this._onSearchReset,"aria-hidden":!a,"aria-label":(0,W.AP)("Effacer"),icon:i.createElement(ge.w,{color:"icon.neutral.secondary.default",_hover:{color:"icon.neutral.secondary.hovered"}})}))))))}_renderLoading(){const{isSuggestLoading:e}=this.props;return e?Je||(Je=i.createElement(J.az,{pe:"spacing.3xl"},i.createElement(me.k,{thickness:1,size:24}))):null}_onSearchFocus(){const{suggestedQuery:e}=this.props,{query:t}=this.state;""===t||e===t||_.A.isAllowed("search_instant_search")||this._fetchSuggestedQuery(t)}_onSearchKeyDown(e){const{isContentVisible:t,dispatchHidePopper:n}=this.props;e&&e.keyCode&&9===e.keyCode&&t&&n(Xe)}_onSearchChange(e){const t=e.target.value;if(_.A.isAllowed("search_instant_search"))return ye.A.addQuery(t),this.setState({query:t},(()=>{this._instantSearch(t,e)}));const{isContentVisible:n,dispatchShowPopper:s}=this.props;this.setState({query:t},(()=>{this._fetchSuggestedQuery(t)})),n||s(Xe)}_onSearchReset(e){e.stopPropagation(),this.setState({query:""},(()=>{this._inputRef&&this._inputRef.current&&this._inputRef.current.focus()}))}_onSearchSubmit(e){e.preventDefault();const{isAuth:t,isContentVisible:n,dispatchHidePopper:s,history:i,dispatchCancelSearch:a,suggestedQuery:r,dispatchResetSearch:o}=this.props,l=this.state.query.trim();if(_.A.isAllowed("search_instant_search"))return this._instantSearch(l,e);l?(this._inputRef&&this._inputRef.current&&this._inputRef.current.blur(),a(),n&&s(Xe),t&&b.A.addSearchHistory(l),l!==r&&o(),(0,p.Uw)(l,"",p.vg,Me.SA,0,p.P$),i.push(this._getSearchUrl(l))):this._onSearchReset(e)}_fetchSuggestedQuery(e){const{dispatchFetchSearch:t}=this.props;t(e)}_changeQueryToDisplay(e){const{dispatchHidePopper:t,isContentVisible:n}=this.props;e&&(this.setState({query:e}),n&&t(Xe))}_getSearchUrl(e){return e.length>1&&0===e.lastIndexOf("#",0)?`/tags/${encodeURIComponent(e.replace(/#/g,""))}`:`/search/${encodeURIComponent(e)}`}_getSearchQuery(e){const t=/^\/(?<type>search|tags)\/(?<query>.*?)(\/|$)/.exec(e.pathname);if(null===t)return"";const n=decodeURIComponent(t.groups.query);return"tags"===t.groups.type?`#${n}`:"+"===n.charAt(0)&&n.length>1?n.substring(1):n}_instantSearch(e,t){const{history:n,dispatchHidePopper:s,isContentVisible:i}=this.props;e.trim()?(i&&s(Xe),(0,p.Uw)(e,"",p.vg,Me.dZ,0,p.P$),n.push(this._getSearchUrl(e))):this._onSearchReset(t)}_trackSearchTyped(){ye.A.sendLog()}}O.A.addReducers({searchSuggest:function(e=be,t={}){switch(t.type){case _e:return{...e,suggestedQueries:{...be.suggestedQueries,isLoading:!0}};case Ee:return t.data?{...e,suggestedQueries:t.data}:e;case ve:return{...e,suggestedQueries:be.suggestedQueries};case"search/SEARCH_SUGGESTED_UPDATE_CACHE":return t.query&&t.data?{...e,cache:{...e.cache,[t.query]:t.data}}:e;default:return e}}});const et={dispatchShowPopper:U.On,dispatchHidePopper:U.Lm,dispatchFetchSearch:e=>t=>t((e=>(t,n)=>{const s=e.trim();if(s&&s.length>0){Ce(),xe(n().searchSuggest)||t({type:_e});const e=Ae.A.call({method:"search_getSuggestedQueries",data:{QUERY:s},success:e=>{t({type:Ee,data:ke(e,s)})},error(){t({type:ve})}});Te.push(e)}})(e)),dispatchResetSearch:()=>e=>e(Pe()),dispatchCancelSearch:()=>(e,t)=>{Ce(),xe(t().searchSuggest)&&e(Pe())}},tt=(0,oe.y)((0,a.Ng)((({user:e,popper:t,searchSuggest:n})=>({isAuth:e.isAuth,isContentVisible:(0,U.Pu)(t,Xe),suggestedQuery:we(n),isSuggestLoading:xe(n)})),et)(Ze));var nt=n("AtZM"),st=n("M3gt"),it=n("tZJO"),at=n("rXlm"),rt=n("7E8A"),ot=n("hz5U"),lt=n("0CJU");class ct extends i.Component{constructor(e){super(e),this._markAsRead=this._markAsRead.bind(this),this.state={data:e.data}}shouldComponentUpdate(e,t){return t.data.NOTIFICATION_ID!==this.state.data.NOTIFICATION_ID||t.data.READ!==this.state.data.READ}render(){const{data:e}=this.state,t=!e.READ,n=(0,r.A)("notifications-item",{"is-unread":t}),s=t?this._markAsRead:void 0;return i.createElement("li",{className:n,onMouseOver:s},i.createElement("div",{className:"notifications-item-container"},i.createElement("div",{className:"notifications-item-content"},i.createElement("div",{className:"notifications-item-media"},i.createElement("div",{className:"notifications-item-media-picture"},this._renderPicture()),i.createElement("div",{className:"notifications-item-media-title"},i.createElement("div",{className:"heading-4"},i.createElement(Ue.A,{to:e.URL},e.TITLE)),i.createElement("div",{className:"heading-4-sub"},e.SUBTITLE))),i.createElement("div",null,i.createElement("div",{className:"notifications-item-info"},e.QUOTATION_TITLE),i.createElement("div",{className:"notifications-item-comment"},e.QUOTATION_MESSAGE)),i.createElement("div",{className:"notifications-item-date"},e.FOOTER))))}_renderPicture(){const{data:e}=this.state,t=ot.A.getImageSrc(e.COVER_TYPE,e.PICTURE,56,56,null,100);return i.createElement(lt.A,{type:e.MEDIA_TYPE,height:56,width:56,imgSrc:t,context:`menu_panel_notification_${e.MEDIA_TYPE}`,pageContext:rt[`CONTEXT_TOPBAR_POPPER_${e.MEDIA_TYPE.toUpperCase()}`],id:e.MEDIA_ID,redirectUrl:e.URL})}_markAsRead(){let e={...this.state.data};e.READ||(e.READ=1,this.setState({data:e},(()=>{b.A.markNotificationAsRead(e.NOTIFICATION_ID)})))}}const dt=(0,a.Ng)((({user:e})=>({serverTimestamp:e.SERVER_TIMESTAMP,clientTimestampDelta:e.clientTimestampDelta})))(ct);var ut,pt,mt=n("fSLK"),ht=n("I36q");class gt extends i.Component{constructor(e){super(e),this._fetchNext=()=>{this.state.isNextPageLoading||this.state.rows&&this.state.rows.length===this.props.totalNotifs||this.setState({isNextPageLoading:!0},(()=>{setTimeout((()=>{this._fetchNotificationsPage=Ae.A.call({method:"notification.list",data:{USER_ID:this.props.userId,LAST_NOTIFICATION_ID:this.state.lastNotifId,NB:20},success:e=>{if(e.data&&e.data.length>0){const t=e.data.map((e=>it.A.getNormalizedData(e)));this.setState({rows:[...this.state.rows].concat(t),lastNotifId:t[t.length-1].NOTIFICATION_ID,isNextPageLoading:!1})}}})}),2500)}))},this.state={rows:e.data,lastNotifId:e.data&&e.data.length>0?e.data[e.data.length-1].NOTIFICATION_ID:0,isNextPageLoading:!1}}componentWillUnmount(){Ae.A.cancel(this._fetchNotificationsPage)}render(){const{data:e,isLoading:t}=this.props;return t?this._renderLoading():e.length>0?this._renderList():this._renderPlaceholder()}_renderList(){const e=this.state.rows,t=({index:t,style:n})=>e[t]?i.createElement("div",{style:n},i.createElement(dt,{key:`notification_${e[t].NOTIFICATION_ID}`,data:e[t],index:t})):null,n=t=>{const n=e[t];return n?125+(n.QUOTATION_MESSAGE?30*Math.ceil(n.QUOTATION_MESSAGE.length/80):0)+(n.QUOTATION_TITLE?20*Math.ceil(n.QUOTATION_TITLE.length/100):0):0};return i.createElement(st.A,{isItemLoaded:()=>!1,itemCount:this.props.totalNotifs,loadMoreItems:this._fetchNext},(({onItemsRendered:s,ref:a})=>i.createElement(mt._m,{itemCount:e?e.length:0,onItemsRendered:s,ref:a,height:450,itemSize:n,width:"100%"},t)))}_renderLoading(){return i.createElement("div",{className:"popper-body"},i.createElement("div",{className:"notifications-placeholder"},ut||(ut=i.createElement("div",{className:"notifications-placeholder-image notifications-placeholder-loader animate-spin"})),i.createElement("div",{className:"notifications-placeholder-title"},(0,W.AP)("Chargement en cours"))))}_renderPlaceholder(){return i.createElement(at.A,{className:"popper-body"},i.createElement("div",{className:"notifications-placeholder"},pt||(pt=i.createElement("div",{className:"notifications-placeholder-image notifications-placeholder-friends"})),i.createElement("div",{className:"notifications-placeholder-title"},(0,W.AP)("Ne restez pas dans votre coin.")),i.createElement(ue.$n,{onClick:this.props.openOnboardingScreen},(0,W.AP)("onboardingartistpicker_title_addartists_web"))))}}gt.defaultProps={isLoading:!1};const yt=(0,a.Ng)((({user:e})=>({userId:e.USER.USER_ID})),(e=>({openOnboardingScreen:()=>e((0,w.J2)({name:_.A.isAllowed("public_api_onboarding")?F.F.ONBOARDING:F.F.ONBOARDING_LEGACY,data:{showCloseButton:!0,context:ht.d.Improve,callbackLink:"/profile/me"}}))})))(gt);var ft=n("hIIJ");class At extends i.Component{constructor(e){super(e),this._currentList=[],this._nbDisplay=20,this._updateNotifications=this._updateNotifications.bind(this),this.state={data:[...b.A.data.NOTIFICATIONS],notificationCount:b.A.getNotificationCount(),nbDisplay:this._nbDisplay}}componentDidMount(){A.A.subscribe(A.A.live.notificationNew,this._updateNotifications,"popper_notifications"),A.A.subscribe(A.A.live.notificationRead,this._updateNotifications,"popper_notifications")}shouldComponentUpdate(e,t){return e.selected!==this.props.selected||t.notificationCount!==this.state.notificationCount||t.data.length!==this.state.data.length||t.nbDisplay!==this.state.nbDisplay}componentWillUnmount(){A.A.unsubscribeAll("popper_notifications")}render(){const{nbDisplay:e}=this.state,t=this.state.data.slice(0,e),n=b.A.data.TOTAL_NOTIFICATIONS;return i.createElement(Le.A,{className:"popper-notifications",size:"lg"},i.createElement("div",{className:"popper-headings"},_.A.isAllowed("revamp2023")?i.createElement(ft.A,{title:(0,W.AP)("Notifications")}):i.createElement("h2",{className:"heading-2"})),i.createElement(yt,{data:t,totalNotifs:n,key:"notifications-list"}))}_updateNotifications(){this.setState({notificationCount:b.A.getNotificationCount(),data:[...b.A.data.NOTIFICATIONS]})}}At.defaultProps={selected:null};const _t=(0,Re.A)(At);var Et,vt=n("brAN"),bt=n("zDvJ");class St extends i.Component{constructor(e){super(e),this._updateUnseenNotifications=this._updateUnseenNotifications.bind(this),this.state={unseenNotificationCount:0}}componentDidMount(){A.A.subscribe(A.A.live.notificationNew,this._updateUnseenNotifications),A.A.subscribe(A.A.live.notificationRead,this._updateUnseenNotifications),A.A.ready(A.A.user.userReady,this._updateUnseenNotifications)}componentWillUnmount(){A.A.unsubscribe(A.A.live.notificationNew,this._updateUnseenNotifications),A.A.unsubscribe(A.A.live.notificationRead,this._updateUnseenNotifications)}render(){const e={popperId:"topbar-notification",trigger:[bt.uW],delay:500,isDisabled:!1};return i.createElement(_t,(0,s.A)({className:"topbar-action"},e),i.createElement(ue.K0,{"aria-label":(0,W.AP)("Notifications"),variant:"ghost",size:"small",icon:i.createElement(i.Fragment,null,Et||(Et=i.createElement(vt.$,null)),i.createElement(nt.x,{count:this.state.unseenNotificationCount,fontSize:"10px",top:"5px",right:"5px","aria-label":"topbar-notification-counter"}))}))}_updateUnseenNotifications(){this.setState({unseenNotificationCount:b.A.getNotificationCount()})}}n("aRRr");var kt=n("5G9X"),Tt=n("3TL7"),Ct=n("r2u9"),wt=n("04sm");const xt=()=>{document.body.classList.add("no-transitions"),document.documentElement.removeAttribute("data-theme"),window.requestAnimationFrame((()=>{document.body.classList.remove("no-transitions")}))};var Pt,Nt,Rt,Lt,Dt,Ot,Mt=n("3JOg"),Ut=n("rYh+"),Ft=n("yRJD"),zt=n("eh3h"),qt=n("w/ZN"),Bt=n("70bL"),Gt=n("P1K6");const Qt=["GB","FR","DE","BE","BR","US"];let Ht=(0,o.Ay)()(Pt=class extends i.Component{constructor(...e){super(...e),this._onClose=(e,t=null)=>{void 0!==e.key&&"Enter"!==e.key||"function"==typeof t&&t()}}render(){return i.createElement(Le.A,{className:"popper-account",size:"lg"},this._renderHeader(),this._renderContent())}_renderHeader(){const{userId:e,userPicture:t,displayName:n}=this.props;return i.createElement(i.Fragment,null,i.createElement(Mt.A,null,i.createElement(Ue.A,{className:"account-header animate-wobble",to:`/profile/${e}`},i.createElement(Ft.eu,{size:"size.l",variant:"neutral",name:n,src:t?(0,Gt.AE)(kt.Ay.User,t,100,100):""}),i.createElement("div",{className:"account-heading ellipsis"},i.createElement("span",{className:"account-name"},this.props.displayName)),Nt||(Nt=i.createElement(Ut.A,null)))),this._renderEntryPoint())}_renderContent(){return i.createElement("ul",{className:"account-menu",role:"navigation"},this._getLinks().map((e=>this._renderElement(e))))}_renderElement(e){if(e.isDisabled)return null;const t=(0,r.A)("account-item",{"is-divider":e.isDivider});return i.createElement("li",{className:t,key:e.id,"data-testid":e.id},e.isCheckbox?this._renderCheckbox(e):this._renderLink(e))}_renderLink(e){const t={className:(0,r.A)("account-link",{"is-main":e.isMain}),to:e.to||"",onClick:t=>this._onClose(t,e.onClick),target:e.isExternal?"_blank":void 0};return e.to||Object.assign(t,{role:"button",tabIndex:0,onKeyPress:t=>this._onClose(t,e.onClick)}),e.isAnimated?i.createElement(Mt.A,null,i.createElement(Ue.A,t,i.createElement("span",{className:"account-link-label"},e.label),"multiAccount"===e.id?this._renderWarning():null,Rt||(Rt=i.createElement(Ut.A,null)))):i.createElement(Ue.A,t,e.label)}_renderEntryPoint(){const{entryPoints:e}=this.props;return void 0!==e.SUBSCRIBE_FROM_SETTINGS&&""!==e.SUBSCRIBE_FROM_SETTINGS.action&&""!==e.SUBSCRIBE_FROM_SETTINGS.label&&""!==e.SUBSCRIBE_FROM_SETTINGS.description?i.createElement(Mt.A,null,i.createElement(Ue.A,{className:"account-header",to:e.SUBSCRIBE_FROM_SETTINGS.action,target:"_blank"},i.createElement("div",{className:"account-entrypoint"},i.createElement("span",{className:"account-link-label account-entrypoint-label"},e.SUBSCRIBE_FROM_SETTINGS.label),Lt||(Lt=i.createElement("br",null)),i.createElement("span",{className:"account-link-label account-entrypoint-description"},e.SUBSCRIBE_FROM_SETTINGS.description)),Dt||(Dt=i.createElement(Ut.A,null)))):null}_renderWarning(){return this.props.remainingAccountsCount<0?Ot||(Ot=i.createElement(qt.i,{className:"multi-account-warning"})):null}_renderCheckbox(e){const t=(0,r.A)("account-input-label",{"is-main":e.isMain});return i.createElement("div",{className:"account-input"},i.createElement("div",{className:t},e.label),i.createElement(zt.d,{isChecked:e.isChecked,onChange:e.onClick}))}_setDarkModeOption(e){wt.A.set({global:{dark_mode:_.A.isAllowed("dark_mode")&&e}}),this.props.tracking&&this.props.tracking.trackEvent({eventaction:"click-darkmode-toggle",event:"click",eventlabel:`darkmode-${e}`}),Ae.A.call({method:"log_central.log",data:{BATCH:[{channel:"feature_activation",params:{ts:Math.floor(Date.now()/1e3),state:e,feature:"darkmode-toggle",os_based:!1}}]}})}_manageMyAccount(){this.props.tracking&&this.props.tracking.trackEvent({eventaction:"manage-subscription-button",event:"click",eventcategory:"account"}),open("/account/subscription")}_trackGiftCard(){this.props.tracking&&this.props.tracking.trackEvent({eventaction:"get-voucher",event:"click",eventcategory:"account"})}_getLinks(){var e,t,s,i;const{darkModeOption:a,userLang:r}=this.props;return[{id:"multiAccount",label:(0,W.AP)("settingspage_title_members_web"),isDisabled:this.props.isSubAccount||!this.props.isOnline||!(this.props.hasMultiAccountEnabled||this.props.hasChildAccounts),isMain:!0,isAnimated:!0,onClick:()=>this.props.openScreen({name:F.F.SELECT_PROFILE,data:{}})},{id:"account",label:(0,W.AP)("accountsettingspage_title_accountsettings_web"),to:"/account",isMain:!0,isAnimated:!0},{id:"subscription",label:(0,W.AP)("Gérer mon abonnement"),onClick:()=>this._manageMyAccount(),isMain:!0,isAnimated:!0},{id:"partners",label:null===(e=this.props.entryPoints.SUBSCRIPTION_DAZN_FROM_SETTINGS)||void 0===e?void 0:e.label,to:null===(t=this.props.entryPoints.SUBSCRIPTION_DAZN_FROM_SETTINGS)||void 0===t?void 0:t.action,isMain:!0,isAnimated:!0,isDisabled:void 0===this.props.entryPoints.SUBSCRIPTION_DAZN_FROM_SETTINGS||""===(null===(s=this.props.entryPoints.SUBSCRIPTION_DAZN_FROM_SETTINGS)||void 0===s?void 0:s.action)||""===(null===(i=this.props.entryPoints.SUBSCRIPTION_DAZN_FROM_SETTINGS)||void 0===i?void 0:i.label)},{id:"exclusions",label:(0,W.AP)("banfeatures_action_managemyexclusions_web"),to:`/${r}/exclusions`,isMain:!0,isAnimated:!0},{id:"getGiftCard",label:(0,W.AP)("planspage_action_getagiftcard_web"),to:"/payment/go.php?id=1&gift=1&origin=gift-account-menu-desktop",onClick:()=>this._trackGiftCard(),isMain:!0,isAnimated:!0,isExternal:!0,isDisabled:!Qt.includes(this.props.country)},{id:"gift",label:(0,W.AP)("Activer un code"),to:"/gift",isMain:!0,isAnimated:!0,isExternal:!0,isDisabled:this.props.hasParent||this.props.userHasOffer},{id:"logout",label:(0,W.AP)("Déconnexion"),isMain:!0,onClick:async()=>{if(Ct.Ay){const{default:e}=await Promise.resolve().then(n.bind(n,"7sx+"));await e.logout();const{default:t}=await Promise.resolve().then(n.bind(n,"WBQ7"));t.set("selectedChildAccount",!1,!0),Ct.Ay.deleteLoginInfo()}else Tt.default.logout()}},{id:"kid",label:(0,W.AP)("Activer Deezer Kids"),onClick:()=>Tt.default.setKidStatus(),isMain:!0,isDivider:!0,isCheckbox:!0,isChecked:this.props.isKid,isDisabled:!this.props.hasParent||this.props.isSubAccount||this.props.isKid},{id:"darkmode",label:(0,W.AP)("accountmenu_title_darkmode_web"),isMain:!0,isDivider:!0,isCheckbox:!0,isChecked:"off"!==a,isDisabled:!(window&&window.CSS&&window.CSS.supports("color","var(--primary)")&&_.A.isAllowed("dark_mode")),onClick:()=>this._setDarkModeOption("off"===a?"on":"off")},{id:"support",label:(0,W.AP)("generic_title_support_web"),to:"https://support.deezer.com/",isAnimated:!0,isDivider:!0,isExternal:!0},{id:"community",label:(0,W.AP)("generic_title_communityandfeedback_web"),to:"/support",isAnimated:!0,isDivider:!1,isExternal:!0},{id:"features",label:(0,W.AP)("Fonctionnalités"),to:(0,S.Tn)(r),isAnimated:!0,isExternal:!0},{id:"offers",label:(0,W.AP)("Offres"),to:"/offers",isAnimated:!0,isExternal:!0,isDisabled:this.props.userHasOffer},{id:"report_content",label:(0,W.AP)("settingspage_title_DSAreportcontent_web"),to:"https://support.deezer.com/hc/requests/new?ticket_form_id=18694766502813",isAnimated:!0,isExternal:!0},{id:"company",label:(0,W.AP)("À propos"),to:"/company",isAnimated:!0,isExternal:!0},{id:"jobs",label:(0,W.AP)("Jobs"),to:"https://www.deezerjobs.com/",isAnimated:!0,isExternal:!0},{id:"legal",label:(0,W.AP)("Légal"),to:"/legal/cgu",isAnimated:!0,isExternal:!0}]}})||Pt;const Yt=(0,Re.A)((0,a.Ng)((e=>({userId:(0,k.F6)(e.user),userPicture:(0,k.jg)(e.user),userHasOffer:(0,k.jQ)(e.user),userLang:(0,k.Z0)(e.user),displayName:(0,k.Mn)(e.user),langDirection:(0,k.iJ)(e.user),darkModeOption:(0,k.HZ)(e.user),hasChildAccounts:(0,k.bU)(e.user),hasMultiAccountEnabled:(0,k.mE)(e.user),hasParent:(0,k.p7)(e.user),isSubAccount:(0,k.m0)(e.user),isKid:(0,k.zI)(e.user),isOnline:(0,Bt.sc)(e),childs:(0,k.TW)(e.user),remainingAccountsCount:(0,k.KU)(e.user),country:(0,k.JJ)(e.user),entryPoints:(0,k.WL)(e.user)})),{openScreen:w.J2,openModal:x.qf})(Ht));class Vt extends i.Component{render(){const{userPicture:e,userName:t}=this.props,n={popperId:"topbar-profile",trigger:[bt.uW],delay:500,isDisabled:!1};return i.createElement(Yt,(0,s.A)({className:"topbar-action"},n),i.createElement(Ft.eu,{as:"button","data-testid":"topbar-profile",size:"size.m",variant:"neutral",name:t,src:e?(0,Gt.AE)(kt.Ay.User,e,100,100):"",isHoverEnabled:!0}))}}const jt=(0,a.Ng)((({user:e})=>({userPicture:e.USER.USER_PICTURE,userName:(0,k.Mn)(e)})))(Vt);var Wt=n("Dqph");class Kt extends i.Component{render(){const{CONVERSION_BANNER_FREE_MYMENU:e,CONVERSION_BANNER_TRIAL_MYMENU:t}=this.props.conversionEntrypoints,n=e||t;return n?i.createElement(Le.A,{className:"popper-entrypoints",size:bt.Dn},i.createElement("p",null,n.description)):null}}const $t=(0,Re.A)((0,a.Ng)((({user:e})=>({conversionEntrypoints:e.USER.ENTRYPOINTS})))(Kt));var Jt,Xt=n("nzlo");function Zt(e){return i.createElement(Xt.A,(0,s.A)({name:"add"},e),Jt||(Jt=i.createElement("path",{fillRule:"evenodd",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M6 1.5v9M1.5 6h9"})))}var en,tn=n("6Va4");class nn extends i.Component{constructor(e){super(e),this._onLinkClick=this._onLinkClick.bind(this)}render(){const{conversionEntrypoints:e}=this.props;if(0===Object.keys(e).length)return null;const{CONVERSION_BANNER_FREE:t,CONVERSION_BANNER_TRIAL:n,CONVERSION_BANNER_FREE_MYMENU:s,CONVERSION_BANNER_TRIAL_MYMENU:a,MYMENU:r}=e;if(t||n)return null;const o=s||a||r;if(!o)return null;const l={className:"topbar-entrypoints",popperId:"topbar-entrypoints",trigger:[bt.mH],delay:0,isDisabled:!o.description},c={as:"a",colorScheme:"primary",leftIcon:r?en||(en=i.createElement(Zt,null)):void 0,href:(0,tn.hY)(o.action),onClick:this._onLinkClick,target:"_blank","data-type":"offers_subscribe"};return i.createElement($t,l,i.createElement(ue.$n,c,o.label))}_onLinkClick(e){this.tracking("menu_click",e.currentTarget)}}const sn=(0,a.Ng)((({user:e})=>({conversionEntrypoints:e.USER.ENTRYPOINTS})))((0,Wt.A)(nn));var an,rn,on=n("yiM3");class ln extends i.Component{render(){return i.createElement(i.Fragment,null,i.createElement("a",{href:(0,S.jd)("/"),"aria-label":"Deezer"},an||(an=i.createElement(D.T,{h:"35px",me:"spacing.l"}))),rn||(rn=i.createElement(tt,null)),i.createElement(J.zt,{ms:"8",spacing:"4"},i.createElement(J.N_,{fontWeight:"bold",fontSize:"md",href:(0,S.jd)("/offers"),onClick:this._onTrackingClick.bind(this,"plans-button")},(0,W.AP)("Offres")),i.createElement(ue.$n,{as:"a",size:"small",id:"topbar-login-button",href:(0,on.t)({route:"login",comeback:!0}),variant:"outline",onClick:this._onTrackingClick.bind(this,"login-button")},(0,W.AP)("Connexion")),i.createElement(ue.$n,{as:"a",size:"small",id:"topbar-register-button",href:(0,on.t)({route:"register",comeback:!0}),onClick:this._onTrackingClick.bind(this,"signup-button")},(0,W.AP)("Inscription"))))}_onTrackingClick(e){window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"click",eventcategory:"header",eventaction:e})}}const cn=(0,oe.y)(ln);var dn=n("X5lq"),un=n("eC9Z"),pn=n("QSbk"),mn=n("bbm1");const fn=()=>{const[e,t]=(0,i.useState)(!1),s=(0,mn.useDeezToolsContext)(),a=(0,mn.useDeezToolsDispatch)();(0,i.useEffect)((()=>{t((0,un.sg)(s))}),[s]);const r=()=>{De.A.flush(),(0,pn.ri)(),n("r2u9").Ay.reloadApp()};return i.createElement("div",{className:"bv4i9"},i.createElement(ue.$n,{onClick:()=>{(0,un.N1)({dispatch:a}),r()}},"Reset all"),e?i.createElement("span",{className:"k2wQ5"},"You have unsaved changes"):null,i.createElement(ue.$n,{className:"iAuIU",onClick:()=>{(0,un.ct)({contextState:s,dispatch:a}),r()}},"Apply"))},bn="Mty7y",kn=({items:e,activeTab:t})=>{const n=e.map((e=>{var n;const s=(0,r.A)("xzwen",{vk6fm:t===e.id}),a=t===e.id||null===(n=e.action)||void 0===n?void 0:n.bind(null,e);return i.createElement("li",{key:e.id,className:"X80It"},i.createElement("a",{className:s,onClick:a,role:"tab",tabIndex:0,"aria-selected":t===e.id,onKeyDown:a},e.label))}));return i.createElement("ul",{className:"EwBfV",role:"tablist"},n)};var Tn=n("5xmB");const wn=({children:e})=>e?i.createElement(at.A,{className:"qJuZF"},i.createElement("ul",null,e)):null;var In=n("wGgI");const Rn="xsx1k",Dn="nMT_c",On="Jykpc",Mn="M5BqM",Un="bO138",Fn=({name:e,label:t,items:n,currentValue:s,originalValue:a,onChange:o})=>{const[l,c]=(0,i.useState)(null!==s?s:a),[d,u]=(0,i.useState)(0),[p,m]=(0,i.useState)(l!==a),h=(0,i.useCallback)((t=>{c(t),null==o||o(e,t)}),[e,o]);(0,i.useEffect)((()=>{m(l!==a),u(n.findIndex((e=>e.value===l)))}),[l,n,a]);const g=n.map((e=>{const t=(0,r.A)({[On]:l===e.value});return i.createElement(In.Ay.Item,{key:e.label,label:e.label},i.createElement("a",{className:t,onClick:h.bind(null,e.value),role:"button"},e.value))})),y=(0,r.A)(Dn,{[On]:p});return i.createElement("li",{className:(0,r.A)(Rn)},i.createElement("span",{className:y},t||e),p?i.createElement("span",{className:Un},"Modified"):null,i.createElement(In.Ay,{className:Mn,align:In.VX,selected:d},g))},zn=({className:e,children:t})=>t?i.createElement("div",{className:(0,r.A)("SKrtC",e)},t):null;var qn=n("pUfN");const Bn=({onChange:e})=>{const t=(0,mn.useDeezToolsContext)(),n=(0,a.d4)((({user:e})=>(0,k.zJ)(e))),s=(0,un.CN)({itemType:qn.Wi.CONFIG,itemName:"media-service",context:t});return i.createElement(zn,null,i.createElement(Fn,{key:"media-service",name:"media-service",label:"Media Service host",items:[{label:"dev",value:"https://dev-media.deez.re"},{label:"local",value:"https://localhost:1443"},{label:"qa",value:"https://qa-media.deezer.com"},{label:"prod",value:"https://media.deezer.com"}],currentValue:s,originalValue:n,onChange:e}))};var Gn=n("Vd8Q");const Qn=({onChange:e})=>{const t=(0,mn.useDeezToolsContext)(),n=Gn.default.get("host_pipe"),s=(0,un.CN)({itemType:qn.Wi.CONFIG,itemName:"pipe",context:t});return i.createElement(zn,null,i.createElement(Fn,{key:"pipe",name:"pipe",label:"Pipe host",items:[{label:"dev",value:"dev-pipe.deezerdev.com"},{label:"dirty",value:"pipe-dirty.preview-kube.deez.re"},{label:"prod",value:"pipe.deezer.com"}],currentValue:s,originalValue:n,onChange:e}))},Hn=({onChange:e})=>{const t=(0,mn.useDeezToolsContext)(),n=Gn.default.get("host_messaging"),s=(0,un.CN)({itemType:qn.Wi.CONFIG,itemName:"messaging",context:t});return i.createElement(zn,null,i.createElement(Fn,{name:"messaging",label:"Messaging host",items:[{label:"dev",value:"messaging.deezerdev.com"},{label:"prod",value:"messaging.deezer.com"}],currentValue:s,originalValue:n,onChange:e}))};var Yn=n("D/zM"),Vn=n("+pY+");const jn=class{constructor(e){this._counter=void 0,this._counter=new Yn.A({id:Vn.Ps.DEEZTOOLS,tags:{userId:String((0,k.F6)(O.A.getState().user)),...e}})}log(){this._counter.increment(),this._counter.send()}},$n=({currentValue:e,label:t,name:n,onChange:s,originalValue:a,prefix:o})=>{const[l,c]=(0,i.useState)(void 0!==e?e:a),[d,u]=(0,i.useState)(l!==a),p=(0,i.useCallback)((()=>{""===l&&c(a);const e=l!==a;u(e),s&&e&&s(n,l)}),[l,n,s,a]),m=(0,r.A)(Dn,{[On]:l});return i.createElement("li",{className:Rn},i.createElement("span",{className:m},t||n,i.createElement("span",{className:"cV2PF",title:d?"Modified":" "},d?"*":" ")),o?i.createElement("span",{className:Un},o):null,i.createElement("input",{className:(0,r.A)(Mn,"r8YPI"),onBlur:p,onChange:e=>c(e.target.value),onKeyUp:e=>{"Enter"===e.key&&p()},type:"text",value:String(l)}))},Jn=({onChange:e})=>{const t=(0,mn.useDeezToolsContext)(),n=(0,un.CN)({itemType:qn.Wi.CONFIG,itemName:"standalone",context:t})||"";return i.createElement(zn,null,i.createElement($n,{currentValue:n,label:"Standalone",name:"standalone",onChange:(t,n)=>e(t,n),originalValue:"",prefix:"https://"}))},Xn=()=>{const e=(0,mn.useDeezToolsDispatch)(),t=(t,n)=>{e({type:qn.u3,item:{category:qn.Wi.CONFIG,name:t,value:n}}),new jn({type:"config",name:t}).log()};return i.createElement(wn,null,i.createElement(Bn,{key:"media-service",onChange:t}),i.createElement(Qn,{key:"pipe",onChange:t}),i.createElement(Hn,{key:"messaging",onChange:t}),i.createElement(Jn,{key:"standalone",onChange:t}))};var Zn,es,ts=n("LOxp");const ns=()=>{const e=(0,a.wA)(),t=(0,a.d4)((({user:e})=>(0,k.G8)(e))),n=(0,a.d4)((({user:e})=>(0,k.F6)(e))),s=(0,i.useCallback)(((s,i)=>(0,ts.$)(`deezer://www.deezer.com/${i}`,{dispatch:e,lovedTracksId:t,userId:n})),[e,t,n]);return i.createElement(zn,null,i.createElement($n,{currentValue:"",label:"Deeplink",name:"deeplink",onChange:s,originalValue:"",prefix:"deezer://www.deezer.com/"}),i.createElement("p",{className:"gIOHD"},"Press ",Zn||(Zn=i.createElement("strong",null,"enter"))," to open the deeplink (",es||(es=i.createElement("strong",null,"DO NOT"))," use the “Apply” button as it will reload the page)"))},ss=({name:e,label:t=e,onClick:n})=>i.createElement("li",{className:Rn},i.createElement("span",{className:Dn},e),i.createElement(ue.$n,{className:Mn,variant:"outline",size:"sm",onClick:n},t));n("WpbS");var is=n("2oWs"),as=n("UfUf"),rs=n("lWgj"),os=n("KBFD"),ls=n("SLMx"),cs=n("GXXn");const ds=new class{constructor(e,t){this._logCenter=void 0,this._userContext=void 0,this._logCenter=e,this._userContext=t}log(){const e=Object.entries(this._getPayload()).filter((([,e])=>void 0!==e)).reduce(((e,[t,n])=>Object.assign(e,{[t]:n})),{});this._logCenter.log((0,cs.L)("playback.stream","1.0.0",e))}_getPayload(){const e=ls.A.get(),{offer_id:t,user_id:n}=this._userContext.get();return{user_id:n,client_ip:e,offer_id:t,device_network:{type:os.T.LAN},media:{media_id:"1245679",encoding:rs.rv.name,media_type:as.zu.SONG},created_at:Math.round(Date.now()/1e3),stream_context:{context_id:"2366228282",context_type:"playlist_page"},is_restricted:!1,is_synchronized:!0,listening_duration:280,listen_type:as.lD.MOD,linked_devices:[{type:"input",device_type:"waze",name:"waze"},{type:"output",device_type:"bluetooth",name:"My_Radio"}],player:{player_version:"a_cool_player",seek_count:1,pause_count:0,previous:!1,next:!1,repeat_type:"repeat_all",is_shuffle:!1},linked_incident:"a_bloody_incident",stream_id:"5f107527-65b9-4be5-af2e-69268eb630e2",stream_session_id:"MyStreamSession"}}}(De.A,is.It);var us=n("u7vQ");const ps=()=>i.createElement(zn,null,i.createElement(ss,{name:"Playlogs",label:"Create fake log",onClick:()=>ds.log()}),i.createElement(ss,{name:"Playlogs",label:"Create fake log and send to REC now",onClick:()=>{ds.log(),De.A.flush()}}),i.createElement(ss,{name:"Playlogs",label:"media.format -> 'unknown'",onClick:()=>us.Ay.setLogQuality("Unknown")}));var ms=n("Q7m9");const hs=({name:e,label:t,currentValue:n,originalValue:s,onChange:a})=>{const[o,l]=(0,i.useState)(null!==n?n:s),[c,d]=(0,i.useState)(!1),u=(0,i.useCallback)((()=>{l(!o),a&&a(e,!o)}),[o,e,a]);(0,i.useEffect)((()=>{d(o!==s)}),[o,s]);const p=(0,r.A)(Dn,{[On]:o});return i.createElement("li",{className:Rn},i.createElement(ms.MJ,{onChange:u,display:"flex"},i.createElement(ms.lR,{className:p,htmlFor:t,mb:0},t),i.createElement(J.so,null,c?i.createElement("span",{className:Un},"Modified"):null,i.createElement(zt.d,{id:t,className:Mn,isChecked:Boolean(o),size:"sm"}))))},gs=({onChange:e})=>{const t=(0,mn.useDeezToolsContext)(),n=(0,un.CN)({itemType:qn.Wi.FEATURE,itemName:"ForceDecryptionError",context:t});return i.createElement(zn,null,i.createElement(hs,{key:"ForceDecryptionError",name:"ForceDecryptionError",label:"Force decryption error",currentValue:n,originalValue:!1,onChange:e}))},ys=({onChange:e})=>{const t=(0,mn.useDeezToolsContext)(),n=(0,un.CN)({itemType:qn.Wi.FEATURE,itemName:"ForceExplicit",context:t});return i.createElement(zn,null,i.createElement(hs,{key:"ForceExplicit",name:"ForceExplicit",label:"Force explicit covers",currentValue:n,originalValue:!1,onChange:e}))},fs=()=>i.createElement(zn,null,i.createElement(ss,{name:"Force send to REC",label:"Send to REC now",onClick:De.A.flush})),As=({onChange:e})=>{const t=(0,mn.useDeezToolsContext)(),n=(0,un.CN)({itemType:qn.Wi.FEATURE,itemName:"offline",context:t});return i.createElement(zn,null,i.createElement(hs,{key:"offline",name:"offline",label:"Electron mode",currentValue:n,originalValue:!0,onChange:e}))},_s=({onChange:e})=>{const t=(0,mn.useDeezToolsContext)(),n=(0,un.CN)({itemType:qn.Wi.FEATURE,itemName:"player-logger",context:t});return i.createElement(zn,null,i.createElement(hs,{key:"player-logger",name:"player-logger",label:"Player logger",currentValue:n,originalValue:!1,onChange:e}))},Es=({onChange:e})=>{const t=(0,mn.useDeezToolsContext)(),n=(0,un.CN)({itemType:qn.Wi.FEATURE,itemName:"rtl",context:t});return i.createElement(zn,null,i.createElement(hs,{key:"rtl",name:"rtl",label:"Right To Left mode",currentValue:n,originalValue:!0,onChange:(t,n)=>{e(t,n),document.querySelectorAll("link[rel=stylesheet]").forEach((e=>{e.href=n?e.href.replace(".css",".rtl.css"):e.href.replace(".rtl.css",".css"),document.body.classList.replace(n?"dir-ltr":"dir-rtl",n?"dir-rtl":"dir-ltr"),n?document.body.setAttribute("dir","rtl"):document.body.removeAttribute("dir")}))}}))};var vs,bs,Ss;const ks=({updateUser:e})=>{const t=(0,mn.useDeezToolsContext)(),n=(0,mn.useDeezToolsDispatch)(),s=(e,t)=>{n({type:qn.nh,item:{category:qn.Wi.FEATURE,name:e,value:t}}),new jn({type:"feature",name:e}).log()};return i.createElement(wn,null,vs||(vs=i.createElement(ns,null)),i.createElement(gs,{key:"forceDecryptionError",onChange:s}),i.createElement(ys,{key:"forceExplicit",onChange:s}),bs||(bs=i.createElement(fs,{key:"ForceSendToREC"})),i.createElement(As,{key:"offline",onChange:s}),i.createElement(Es,{key:"rtl",onChange:(t,n)=>{s(t,n),e({DIRECTION:n?"rtl":"ltr"})}}),_.A.isAllowed("gapless_playback")||(0,un.CN)({itemType:qn.Wi.GATEKEEP,itemName:"gapless_playback",context:t})?i.createElement(_s,{key:"player-logger",onChange:s}):null,Ss||(Ss=i.createElement(ps,{key:"playlogs"})))},Ts=JSON.parse('["activate_segment","ad_audio_break_hubvisor","ad_check_flag_show_is_advertising_allowed","ad_collect_rec_logs","ad_display_hubvisor","ad_force_video","adblock_bait_file","artist_page_albums_sorted_by_rank","artist_page_favorite_content","cdn_metrics","concerts_hub","contextual_menu_blindtest","curator_feature","curator_local","curator_partner","dark_mode","deeztools","disable_change_email","disable_change_password","dynamic_pages_sponsored_items","employee_feature","gapless_playback","gcast_force_beta","gender_nonbinary","is_force_cookie_allowed","lyrics_report_problem","metric.api","metric.dynamic_content.item_clicked","metric.dynamic_content.play_clicked","metric.dynamic_content.screen_view","metric.dynamic_content.view_all_clicked","metric.dynamic_page_loading","metric.memoryusage","metric.mparticle.tracking_migration","metric.playback_attempts","metric.remote_control","metric.timetoplay","playlist_assistant_end_of_tracklist","privacy_and_transfer_data_needed","public_api_album","public_api_onboarding","reactivation_desktop_notification","remote_control","request_my_data","revamp2023","search_instant_search","search_refacto_2024","search_sponsored_trending_queries","sentry","single_instance_playback_relive","talk","triforce_queuelist_messages","triforce_queuelist_ui","tuner_flow_config","unlimited_favorite_tracks","unlimited_favorite_tracks_parallel_fetch","use_media_service","use_url_generation","volume_normalization"]'),Cs=()=>{const e=(0,a.d4)((e=>e.user.__DZR_GATEKEEPS__)),t=(0,mn.useDeezToolsDispatch)(),n=(0,mn.useDeezToolsContext)(),s=(e,n)=>{t({type:qn.nh,item:{category:qn.Wi.GATEKEEP,name:e,value:n}}),new jn({type:"gatekeep",name:e}).log()},r=(o=e,Ts.reduce(((e,t)=>{var n;return{...e,[t]:null!==(n=o[t])&&void 0!==n&&n}}),{}));var o;const l=Object.keys(r).filter((e=>"deeztools"!==e)).map((e=>{const t=(0,un.CN)({itemType:qn.Wi.GATEKEEP,itemName:e,context:n});return i.createElement(hs,{key:e,name:e,label:e,currentValue:t,originalValue:r[e],onChange:s})}));return i.createElement(wn,null,l)},ws=()=>{const e={fastAds:!1,forceAdBlocker:!1},t=(e,t)=>{const n=new URLSearchParams(location.search);t?n.set(e,t.toString()):n.delete(e),d.A.push({pathname:location.pathname,search:n.toString()})},n=Object.keys(e).map((n=>{const s="true"===new URLSearchParams(location.search).get(n);return i.createElement(hs,{key:n,name:n,label:n,currentValue:s,originalValue:e[n],onChange:t})}));return i.createElement(wn,null,n)};let Is=function(e){return e.GATEKEEPS="gatekeeps",e.FEATURES="features",e.CONFIG="config",e.ADS="ads",e}({});var xs,Ps,Ns;const Rs=({tabId:e,updateUser:t})=>{switch(e){case Is.CONFIG:return i.createElement("div",{className:bn},xs||(xs=i.createElement(Xn,null)));case Is.GATEKEEPS:return i.createElement("div",{className:bn},Ps||(Ps=i.createElement(Cs,null)));case Is.FEATURES:return i.createElement("div",{className:bn},i.createElement(ks,{updateUser:t}));case Is.ADS:return i.createElement("div",{className:bn},Ns||(Ns=i.createElement(ws,null)));default:return i.createElement("div",{className:bn},i.createElement(Tn.A,{className:"_wVkB",wording:"No content for the moment. Feel free to contribute!"}))}};var Ls,Ds;const Os=(0,Re.A)((({updateUser:e})=>{const[t,n]=(0,i.useState)(Is.GATEKEEPS),s=e=>n(e.id),a=[{id:Is.GATEKEEPS,label:"Gatekeeps",action:s},{id:Is.FEATURES,label:"Features",action:s},{id:Is.CONFIG,label:"Config",action:s},{id:Is.ADS,label:"Ads",action:s}];return i.createElement(Le.A,{size:"lg"},i.createElement("div",{className:"popper-headings"},Ls||(Ls=i.createElement(J.DZ,{variant:"heading.m"},"DeezTools")),i.createElement("h5",{className:"heading-5-sub"},"Internal dev tools for Deezer",i.createElement("a",{href:"https://deezer.jira.com/l/c/2G1ZV1ha",target:"_blank",rel:"noreferrer"},i.createElement(dn.u,{marginStart:"5px",display:"inline-block",boxSize:"14px",_hover:{color:"text.main"}})))),i.createElement(kn,{items:a,activeTab:t}),i.createElement(Rs,{tabId:t,updateUser:e}),Ds||(Ds=i.createElement(fn,null)))}));var Ms=n("eTJY"),Us=n("5Loq");const Fs={root:"slTcE",active:"sD9cd",pending:"riiP7"};var zs,qs;let Bs=function(e){return e.IDLE="idle",e.PENDING="pending",e.ACTIVE="active",e}({});const Gs=({className:e})=>{const t=(0,mn.useDeezToolsContext)(),[n,s]=(0,i.useState)(Bs.IDLE);if((0,i.useEffect)((()=>{(0,un.zV)()&&!(0,un.sg)(t)?s(Bs.ACTIVE):(0,un.sg)(t)?s(Bs.PENDING):s(Bs.IDLE)}),[t]),n===Bs.IDLE)return null;const a=(0,r.A)(Fs.root,Fs[n],e);return i.createElement("span",{className:a,"aria-hidden":!0},n===Bs.ACTIVE?zs||(zs=i.createElement(Ms.S,{boxSize:"8px"})):qs||(qs=i.createElement(Us.j,{boxSize:"8px"})))};var Qs,Hs=n("45ic");const Ys=({updateUser:e})=>{if(!_.A.isAllowed("deeztools")||!(0,un.oz)())return null;const t={popperId:"topbar-deeztools",trigger:[bt.uW],delay:500,isDisabled:!1,className:"topbar-action",params:{updateUser:e}};return i.createElement(Os,t,i.createElement(ue.K0,{className:"cBjIG","aria-label":"DeezTools",onClick:()=>{new jn({type:"display"}).log()},size:"sm",variant:"ghost",icon:i.createElement(i.Fragment,null,Qs||(Qs=i.createElement(Hs.Z,null)),i.createElement(Gs,{className:"JZsLk"}))}))};var Vs,js=n("CtJd"),Ws=n("/o+9");const Ks=()=>_.A.isAllowed("employee_feature")?i.createElement(Ws.m,{label:"Report a Bug","aria-label":"Report a Bug"},i.createElement(ue.K0,{"aria-label":"Report a bug",variant:"ghost",size:"small",icon:Vs||(Vs=i.createElement(js.E,{boxSize:8})),onClick:()=>open("https://deezer.jira.com/servicedesk/customer/portal/7/create/128","_blank")})):null;var $s,Js,Xs,Zs,ei,ti;const ni=(0,a.Ng)((({user:e})=>({isUserConnected:(0,k.UJ)(e),user:e})),(e=>({updateUser:t=>e((0,T.b6)(t))})))((({isUserConnected:e,user:t,updateUser:n})=>i.createElement("div",{className:"page-topbar",id:"page_topbar"},e?i.createElement(i.Fragment,null,$s||($s=i.createElement(tt,null)),Js||(Js=i.createElement(Ks,null)),i.createElement(Ys,{updateUser:e=>n({...t,...e})}),Xs||(Xs=i.createElement(sn,null)),Zs||(Zs=i.createElement(St,null)),ei||(ei=i.createElement(jt,null))):ti||(ti=i.createElement(cn,null)))));n("W8Tb");var si,ii=n("D+hi"),ai=n("+c3z");const ri=(0,a.Ng)((({user:{USER:{ENTRYPOINTS:e}}})=>({conversionEntrypoints:e})))((({conversionEntrypoints:e,iconOnly:t})=>{const{CONVERSION_BANNER_FREE:n,CONVERSION_BANNER_TRIAL:a}=e,r=n||a;return r?i.createElement(ii.QQ,null,i.createElement(J.az,{paddingTop:"spacing.xl",paddingX:"spacing.l"},i.createElement(J.Tk,(0,s.A)({spacing:"spacing.xl",padding:t?"spacing.m":"spacing.l",borderRadius:"xs",bg:"background.accent.primary.default",alignItems:"flex-start","data-testid":"conversionBanner"},t?{as:"a",target:"_blank",href:(0,tn.hY)(r.action)}:{}),t?si||(si=i.createElement(ai.h,{size:"medium",color:"white"})):i.createElement(i.Fragment,null,i.createElement(J.EY,{color:"white",fontSize:"sm",lineHeight:"4"},r.description),i.createElement(ue.$n,{as:"a",href:(0,tn.hY)(r.action),size:"small",target:"_blank",variant:"onContent","data-testid":"conversionBannerCTA"},r.label))))):null})),oi=({icon:e,iconActive:t,iconOnly:n,to:s,children:a})=>{let r=!1;const o=(0,oe.W5)(s);return s&&(r=!!o&&o.isExact),i.createElement(J.so,{as:Ue.A,to:s,alignItems:"center",paddingX:"spacing.s",paddingY:"spacing.s",borderRadius:"s",gap:"spacing.s",color:r?"text.accent.primary.default":"text.neutral.primary.default",background:r?"background.neutral.tertiary.default":void 0,justifyContent:n?"center":void 0,_hover:{background:r?void 0:"background.neutral.secondary.hovered"},_active:{background:r?void 0:"background.neutral.secondary.pressed"}},r?t:e,!n&&i.createElement(J.DZ,{variant:"heading.s",noOfLines:1},a))},li=23.26;class ci extends i.Component{constructor(e){super(e),this._containerRef=null,this._containerWidth=0,this._wrapperRef=null,this._childrenRef=null,this._scrollOffset=0,this._scrollWidth=0,this._frameId=null,this._isLastLoop=!1,this._hasScrollingMarquee=!1,this._onResize=(0,le.A)(this._measureText.bind(this),100),this._onMouseEnter=(0,le.A)(this._start.bind(this),1e3),this.state={isTruncated:!1}}componentDidMount(){this._measureText(),window.addEventListener("resize",this._onResize,!1)}UNSAFE_componentWillReceiveProps(){this._measureText()}componentWillUnmount(){this._clear(),window.removeEventListener("resize",this._onResize)}render(){const{langDirection:e,isCentered:t}=this.props,{isTruncated:n}=this.state;let s={className:(0,r.A)("marquee-wrapper",{"is-centered":t&&!n}),ref:e=>this._wrapperRef=e};return n&&(s.onMouseEnter=()=>this._onMouseEnter(),s.onMouseLeave=()=>this._stop(),s.style=this._getWrapperStyle(0)),i.createElement("div",{className:"marquee",dir:e,ref:e=>this._containerRef=e},i.createElement("div",s,this._renderContent(),this._renderContent(!1)))}_renderContent(e=!0){const{children:t,langDirection:n}=this.props,{isTruncated:s}=this.state;if(!e&&!s)return null;if(e)return i.createElement("div",{className:"marquee-content",ref:e=>this._childrenRef=e},t);const a={paddingLeft:"ltr"===n?"24px":null,paddingRight:"rtl"===n?"24px":null};return i.createElement("div",{className:"marquee-content",style:a},t)}_measureText(){if(!this._childrenRef||!this._containerRef)return;const e=this._childrenRef.offsetWidth>this._containerRef.offsetWidth;this.state.isTruncated!==e&&this.setState({isTruncated:e},(()=>{this._clear()}))}_start(){const{onScrollStart:e}=this.props;this._isLastLoop&&(this._isLastLoop=!1),this._isScrolling()||(this._scrollWidth=this._childrenRef.offsetWidth,this._containerWidth=this._containerRef.offsetWidth,"function"==typeof e&&e(),this._frameId=window.requestAnimationFrame(this._move.bind(this)))}_stop(){this._onMouseEnter.cancel(),this._isScrolling()&&(this._isLastLoop=!0)}_move(){if(this._frameId=window.requestAnimationFrame(this._move.bind(this)),this._scrollOffset=Math.ceil(this._scrollOffset+.8),this._scrollOffset>this._scrollWidth+24&&(this._scrollOffset=0),this._moveTo(this._scrollOffset),0===this._scrollOffset&&this._isLastLoop){const{onScrollEnd:e}=this.props;"function"==typeof e&&e(),this._clear()}}_moveTo(e){if(!this._wrapperRef)return;if(!1===this.state.isTruncated)return void this._setStyle(this._containerRef,this._getGradientStyle());this._setStyle(this._wrapperRef,this._getWrapperStyle(this._getTranslateOffset(e)));const t=.23260000000000003*this._containerWidth;if(this._isScrolling()||0!==e){if(e<t&&!this._hasScrollingMarquee){const n=e*li/t;this._setStyle(this._containerRef,this._getGradientStyle(n))}else if(!this._isLastLoop&&e>t)this._hasScrollingMarquee=!0;else if(this._isLastLoop){const n=this._scrollWidth+24-e;if(this._isLastLoop&&n<t){const e=t?n*li/t:0;this._setStyle(this._containerRef,this._getGradientStyle(e))}}}else this._setStyle(this._containerRef,this._getGradientStyle(0))}_clear(){this._isScrolling()&&window.cancelAnimationFrame(this._frameId),this._moveTo(0),this._frameId=null,this._isLastLoop=!1,this._hasScrollingMarquee=!1,this._scrollOffset=0}_setStyle(e,t){e.style&&Object.assign(e.style,t)}_getWrapperStyle(e){return{transform:`translate3d(${e}px, 0px, 0px)`,willChange:"transform"}}_getGradientStyle(e){const{langDirection:t}=this.props;return void 0===e?{"-webkit-mask-image":"","mask-image":""}:0===e?{"-webkit-mask-image":`linear-gradient(\n\t\t\t\t\t${"ltr"===t?270:90}deg,\n\t\t\t\t\trgba(0 0 0 / 0%) 0%,\n\t\t\t\t\trgba(0 0 0 / 0%) 2.42%,\n\t\t\t\t\trgba(0 0 0 / 100%) 23.26%\n\t\t\t\t)`,"mask-image":`linear-gradient(\n\t\t\t\t\t${"ltr"===t?270:90}deg,\n\t\t\t\t\trgba(0 0 0 / 0%) 0%,\n\t\t\t\t\trgba(0 0 0 / 0%) 2.42%,\n\t\t\t\t\trgba(0 0 0 / 100%) 23.26%\n\t\t\t\t)`}:{"-webkit-mask-image":`linear-gradient(\n\t\t\t\t270deg,\n\t\t\t\ttransparent 2.42%,\n\t\t\t\trgba(0 0 0 / 100%) ${"rtl"===t?e:li}%,\n\t\t\t\trgba(0 0 0 / 100%) ${"ltr"===t?100-e:76.74}%,\n\t\t\t\ttransparent 97.58%\n\t\t\t)`,"mask-image":`linear-gradient(\n\t\t\t\t270deg,\n\t\t\t\ttransparent 2.42%,\n\t\t\t\trgba(0 0 0 / 100%) ${"rtl"===t?e:li}%,\n\t\t\t\trgba(0 0 0 / 100%) ${"ltr"===t?100-e:76.74}%,\n\t\t\t\ttransparent 97.58%\n\t\t\t)`}}_getTranslateOffset(e){const{langDirection:t}=this.props;return 0!==e&&"ltr"===t?e-2*e:e}_isScrolling(){return null!==this._frameId}}ci.defaultProps={isCentered:!1,onScrollStart:()=>{},onScrollEnd:()=>{}};const di=(0,a.Ng)((({user:e})=>({langDirection:e.DIRECTION})))(ci);var ui=n("RTUF"),pi=n("A2sV"),mi=n("fkXJ"),hi=n("34sk"),gi=n("yJX9");const yi=({id:e,icon:t,iconOnly:n,to:s,onClick:r,title:o,subtitle:l,isDroppable:c,isFavorite:d})=>{const u=(0,a.wA)(),[p,m]=i.useState(!1),h=(0,oe.W5)(s||""),{isDragging:g}=(0,ui.i)(),[y]=(0,pi.$IV)({onCompleted:e=>{if("PlaylistAddTracksOutput"===e.addTracksToPlaylist.__typename){const t=[...e.addTracksToPlaylist.addedTrackIds,...e.addTracksToPlaylist.duplicatedTrackIds],n=t.length;d&&t.forEach((e=>{u((0,hi.TD)(gi.Z.favorites,{id:e,timestamp:Date.now()},"song"))})),(0,mi.A)({body:(0,W.AP)("toastmessage_title_addedtoplaylisttrack_web",{sprintf:[n],count:n})})}}}),f=!(!s||!h)&&h.isExact,A=!c&&g||!e;return i.createElement(J.so,{className:A?"playlist-item-disabled":"playlist-item",padding:"spacing.s",marginX:"spacing.s",gap:"spacing.s",as:Ue.A,to:s,onClick:r,pointerEvents:"auto",transitionDuration:"200ms",sx:g?{"& *":{pointerEvents:"none"}}:void 0,_hover:{backgroundColor:"background.neutral.tertiary.default"},_active:{backgroundColor:"background.neutral.tertiary.pressed"},backgroundColor:f?"background.neutral.tertiary.default":void 0,boxShadow:p&&!A?"0 0 0 2px var(--tempo-colors-border-accent-primary-default) inset":"none",borderRadius:"s",onDragEnter:()=>{A||m(!0)},onDragLeave:()=>{A||m(!1)},onDrop:t=>{if(A)return;const n=JSON.parse(t.dataTransfer.getData("selectedItemIds"));e&&y({variables:{input:{playlistId:e,trackIds:n}}}),m(!1)}},i.createElement(J.so,{minWidth:"size.xl",width:"size.xl",height:"size.xl",backgroundColor:"background.neutral.tertiary.default",alignItems:"center",justifyContent:"center",opacity:A?.3:1},t),!n&&i.createElement(J.so,{flex:"1",flexDirection:"column",justifyContent:"center",minWidth:"0px"},i.createElement(di,null,i.createElement(J.EY,{noOfLines:1,color:A?"text.neutral.secondary.disabled":f?"text.accent.primary.default":"text.neutral.primary.default",variant:"body.l.default"},o)),l&&i.createElement(di,null,i.createElement(J.EY,{color:A?"text.neutral.secondary.disabled":"text.neutral.secondary.default",variant:"body.s.default",noOfLines:1},l))))};var fi,Ai,_i=n("dfi7"),Ei=n("8BMA");const vi=({iconOnly:e})=>i.createElement(J.so,{paddingY:"spacing.s",paddingX:"spacing.l",gap:"spacing.s"},fi||(fi=i.createElement(J.so,{borderRadius:"2xs",overflow:"hidden",minWidth:"size.xl",height:"size.xl",alignItems:"center",justifyContent:"center"},i.createElement(_i.EA,{w:"100%",h:"100%"}))),!e&&(Ai||(Ai=i.createElement(J.so,{flex:"1",flexDirection:"column",alignSelf:"center"},i.createElement(Ei.rr,{noOfLines:2,spacing:"spacing.m"})))));var bi=n("9OcB");var ki,Ti,Ci,wi,Ii,xi,Pi,Ni,Ri,Li,Di,Oi,Mi,Ui,Fi,zi=n("cXQW"),qi=n("RSbz"),Bi=n("6vqc"),Gi=n("zMnD"),Qi=n("NBYJ"),Hi=n("TiiB"),Yi=n("5EMo"),Vi=n("gtRZ"),ji=n("//u0"),Wi=n("lASK"),Ki=n("Bz3e"),$i=n("7Gye"),Ji=n("9yOc"),Xi=n("aoCz"),Zi=n("vF4p"),ea=n("ew1V");const ta=()=>{var e;const t=(0,a.wA)(),{dragEvent:n,dragStyle:r}=(0,ea.A0)(),o=(0,a.d4)((e=>null==e?void 0:e.user.id.toString())),l=(0,a.d4)((e=>null==e?void 0:e.user.SETTING_LANG)),c=(0,a.d4)((e=>null==e?void 0:e.user.DIRECTION)),[d,u]=(0,i.useState)({canGoBack:!1,canGoForward:!1});(0,i.useEffect)((()=>{const e=(e,{canGoBack:t,canGoForward:n})=>{u({canGoBack:t,canGoForward:n})};return Ct.Ay&&Ct.Ay.on(Ct.qY.HISTORY_UPDATED,e),()=>{Ct.Ay&&Ct.Ay.on(Ct.qY.HISTORY_UPDATED,e)}}),[]);const p=(0,a.d4)((e=>null==e?void 0:e.feedbacks.favorites.playlist.order.length)),m=(0,a.d4)((e=>{const t=Object.values((null==e?void 0:e.entities.PLAYLISTS)||[]).filter((e=>e.PARENT_USER_ID===o&&"4"!==e.TYPE));return t.reduce(((e,t)=>e+t.NB_SONG),0)+t.length})),h=(0,a.d4)((e=>(0,k.Jt)(null==e?void 0:e.user))),{data:g,loading:y,refetch:f}=(0,pi.XBt)({variables:{first:50}}),A=()=>{t((0,x.qf)({name:"PLAYLIST_ASSISTANT",props:{type:Xi.F.CREATION}}))},_=(0,i.useMemo)((()=>{var e,t;return[...(null==g||null===(e=g.me)||void 0===e||null===(e=e.userFavorites.playlists)||void 0===e?void 0:e.edges)||[],...(null==g||null===(t=g.me)||void 0===t?void 0:t.playlists.edges)||[]].filter((({node:e})=>!!e)).filter((({node:e})=>{var t;return!(null!=e&&e.isFromFavoriteTracks&&(null==e||null===(t=e.owner)||void 0===t?void 0:t.id)===o)})).sort(((e,t)=>{var n,s;return("favoritedAt"in e?e.favoritedAt:null===(n=e.node)||void 0===n?void 0:n.lastModificationDate)>("favoritedAt"in t?t.favoritedAt:null===(s=t.node)||void 0===s?void 0:s.lastModificationDate)?-1:1}))}),[g,o]),E=(0,i.useMemo)((()=>{var e;return null==g||null===(e=g.me)||void 0===e?void 0:e.playlists.edges.filter((({node:e})=>!!e)).find((({node:e})=>null==e?void 0:e.isFromFavoriteTracks))}),[g]),v=null==_?void 0:_.length;(0,i.useEffect)((()=>{f()}),[p,m,o,f]);const[b,S]=(0,i.useState)(!1);return(0,i.useEffect)((()=>{const e=document.getElementsByClassName("naboo")[0],t=()=>{window.innerWidth<=1160?(e.style.setProperty("--layout-sidebar-width","80px"),S(!0)):(e.style.setProperty("--layout-sidebar-width",""),S(!1))};return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)}),[]),i.createElement(J.so,{flexDirection:"column",background:"background.neutral.secondary.default",borderRightWidth:"border.s",borderRightStyle:"solid",borderRightColor:"border.neutral.primary.default",top:"0px",bottom:"0px",paddingBottom:"80px",insetStart:"0",position:"fixed",zIndex:"1",width:"var(--layout-sidebar-width)"},i.createElement(J.Tk,{paddingTop:"spacing.xl",paddingBottom:"spacing.l",borderBottomWidth:"border.s",borderBottomStyle:"solid",borderBottomColor:"divider.neutral.primary.default",alignItems:"stretch",spacing:"spacing.xl",zIndex:"1",background:"background.neutral.secondary.default",__css:{webkitAppRegion:Ji.A.is("windows")?"no-drag":"drag"}},i.createElement(J.so,{paddingX:b?void 0:"spacing.m",direction:Ji.A.is("macos")?"row-reverse":"row",alignSelf:b?"center":void 0,paddingTop:Ji.A.is("macos")?"spacing.m":void 0},i.createElement(zi.e,{size:"small"},i.createElement(ue.K0,{"aria-label":(0,W.AP)("Précédent"),variant:"ghost",icon:"ltr"===c?ki||(ki=i.createElement(qi.Y,null)):Ti||(Ti=i.createElement(Bi.v,null)),disabled:!d.canGoBack,onClick:()=>null===Ct.Ay||void 0===Ct.Ay?void 0:Ct.Ay.goBack()}),i.createElement(ue.K0,{"aria-label":(0,W.AP)("Avancer"),variant:"ghost",icon:"ltr"===c?Ci||(Ci=i.createElement(Bi.v,null)):wi||(wi=i.createElement(qi.Y,null)),disabled:!d.canGoForward,onClick:()=>null===Ct.Ay||void 0===Ct.Ay?void 0:Ct.Ay.goForward()}))),i.createElement(J.so,{marginTop:"spacing.xl",paddingX:"spacing.s",role:"group",gap:"spacing.xs",flexDirection:"column"},i.createElement(oi,{icon:Ii||(Ii=i.createElement(Gi.a,{size:"medium"})),iconActive:xi||(xi=i.createElement(Qi.Y,{size:"medium"})),to:`/${l}/`,iconOnly:b},(0,W.AP)("menutab_title_home_web")),i.createElement(oi,{icon:Pi||(Pi=i.createElement(Hi.w,{size:"medium"})),iconActive:Ni||(Ni=i.createElement(Yi.O,{size:"medium"})),to:`/${l}/channels/explore/explore-tab`,iconOnly:b},(0,W.AP)("menutab_title_explore_web")),i.createElement(oi,{icon:Ri||(Ri=i.createElement(Vi.M,{size:"medium"})),iconActive:Li||(Li=i.createElement(ji.C,{size:"medium"})),to:`/${l}/profile/${o}`,iconOnly:b},(0,W.AP)("menu_title_favorites_web")),h&&i.createElement(oi,{icon:Di||(Di=i.createElement(Wi.m,{size:"medium"})),iconActive:Oi||(Oi=i.createElement(Ki.M,{size:"medium"})),to:`/${l}/profile/${o}/${Zi.E6.downloads}`,iconOnly:b},(0,W.AP)("desktopapp_title_downloads_web"))),i.createElement(ri,{iconOnly:b})),i.createElement(J.so,(0,s.A)({},n,{sx:r,flexDirection:"column",flexGrow:"1",overflow:"auto"}),(!b||v>0)&&i.createElement(J.so,{minHeight:"size.l",justifyContent:b?"center":"space-between",alignItems:"center",paddingStart:"spacing.l",paddingEnd:"spacing.m"},!b&&i.createElement(J.DZ,{as:Ue.A,to:`/${l}/profile/${o}/${Zi.E6.playlists}`,variant:"heading.s"},(0,W.AP)("Playlists")),Boolean(v)&&i.createElement(Ws.m,{"aria-label":(0,W.AP)("playlistspage_title_createaplaylist_web"),hasArrow:!0,label:(0,W.AP)("playlistspage_title_createaplaylist_web"),placement:"top"},i.createElement(ue.K0,{"aria-label":(0,W.AP)("playlistspage_title_createaplaylist_web"),icon:Mi||(Mi=i.createElement($i.c,null)),variant:"ghost",size:"small",onClick:A}))),i.createElement(J.so,{flexDirection:"column",overflow:"auto",overscrollBehavior:"contain",sx:{"&::-webkit-scrollbar":{display:"none"}},_hover:{"&::-webkit-scrollbar":{display:"block"}}},i.createElement(yi,{isFavorite:!0,id:null==E||null===(e=E.node)||void 0===e?void 0:e.id,isDroppable:!0,to:`/${l}/profile/${o}/loved`,iconOnly:b,icon:i.createElement(bi.A,{variant:"favTracks",alt:(0,W.AP)("favoritessidebar_title_favoritetracks_web")}),title:(0,W.AP)("favoritessidebar_title_favoritetracks_web")}),y?Array.from(Array(5)).map(((e,t)=>i.createElement(vi,{iconOnly:b,key:t}))):v?i.createElement(i.Fragment,null,_.slice(0,50).map((({node:e,__typename:t})=>{var n,s,a;return e&&i.createElement(yi,{key:`${t}_${e.id}`,id:e.id,icon:i.createElement(bi.A,{type:kt.Ay.Playlist,src:null===(n=e.picture)||void 0===n?void 0:n.small[0],alt:e.title}),iconOnly:b,title:e.title,subtitle:`${(0,W.AP)("par")} ${(null===(s=e.owner)||void 0===s?void 0:s.name)||"Anonymous"}`,to:`/${l}/playlist/${e.id}`,isDroppable:(null===(a=e.owner)||void 0===a?void 0:a.id)===o||e.isCollaborative})})),_.length>50&&i.createElement(J.az,{marginTop:"spacing.s",marginBottom:"spacing.l",paddingX:"spacing.l"},b?i.createElement(ue.K0,{"aria-label":(0,W.AP)("Voir tout"),as:Ue.A,to:`/${l}/profile/${o}/${Zi.E6.playlists}`,icon:Ui||(Ui=i.createElement(Bi.v,null)),variant:"outline",size:"small"}):i.createElement(ue.$n,{as:Ue.A,to:`/${l}/profile/${o}/${Zi.E6.playlists}`,width:"100%",size:"small",variant:"outline"},(0,W.AP)("Voir tout")))):i.createElement(yi,{onClick:A,icon:Fi||(Fi=i.createElement($i.c,{size:"medium"})),iconOnly:b,title:(0,W.AP)("playlistspage_title_createaplaylist_web")}))),null)};var na=n("y7Wb"),sa=n("HvqQ"),ia=n("UAd1");let aa;function ra(e){document.body.offsetHeight<window.innerHeight?document.body.classList.remove("has-scrollbar-disabled"):(e||(aa=window.pageYOffset),document.body.classList.toggle("has-scrollbar-disabled",!e),e&&window.scrollTo(0,aa))}var oa,la=n("yCtO"),ca=n("hsEi"),da=n("W1Rt"),ua=n("1lpQ"),pa=n("xvdY"),ma=n("dSZ9"),ha=n("I7+f"),ga=n("ATrE"),ya=n("a9NY"),fa=n("1Uwb"),Aa=n("CxZw"),_a=n("o+h5"),Ea=n("1Pdy"),va=n("xCFc"),ba=n("pQlO"),Sa=n("r4LN");const ka=({ariaLabel:e,isDisabled:t=!1,onClick:n})=>i.createElement(ue.K0,{"aria-label":e,icon:oa||(oa=i.createElement(ge.w,null)),isDisabled:t,onClick:n,size:"sm",variant:"link"});var Ta=n("LGn+"),Ca=n("STEc");const wa={TITLE:{SIZE:Ca.uq.Full},ARTIST:{SIZE:Ca.uq.PercentXs},DURATION:{SIZE:Ca.uq.sm},REMOVE:{SIZE:Ca.uq.sm}};var Ia,xa,Pa=n("tgyz"),Na=n("SehT");const La=i.memo((({data:e,index:t,style:n})=>{const s=e.toDisplay[t],{context:a,container:r,isOrderable:o,loadingStatus:l,options:c,shouldExplicitBeHidden:d}=i.useContext(va.Gt),{play:u,playerStatus:p,playQueuelistAtIndex:m,isItemLoadedInPlayer:h,removeTrack:g}=(0,Pa.A)({...a,ID:s.item.id},r,l.isFullyFetched,!0),y=s.item.hasExplicitLyrics&&d,f=(e,t)=>{m(e,t)},A=(0,i.useCallback)((t=>{u({notify:!1,playIndex:t,playItems:e.toPlay,playLyrics:!0})}),[e.toPlay,u]);return i.createElement(fa.A.Row,{style:n,uuid:s.uuid,id:s.item.id,index:t,isActive:h(s.item)&&p.isSameContext,isOrderable:o,isReadable:s.item.right===Aa.A.READABLE,isRestrictedByExplicit:y,type:s.item.type,isDraggable:!0},i.createElement(Ta.A,{size:wa.TITLE.SIZE},i.createElement(Ta.A.Play,{ariaLabel:(0,W.AP)("generic_action_playsongXbyartistX_web",{sprintf:[s.item.title,(0,fe.A)(s,"item.artists[0].name","")]}),hasExplicitCover:s.item.parent.hasExplicitCover,onPlayItems:f,pictureUrl:s.item.cover(_a.r4).url}),Ia||(Ia=i.createElement(Ta.A.Download,null)),i.createElement(Ta.A.PlayableLabel,{hasExplicitLyrics:s.item.hasExplicitLyrics,label:s.item.title,onPlayItems:f,tooltipText:(0,Na.Y)(s.item,d)}),i.createElement(fa.A.IconGroup,null,i.createElement(Ta.A.ShowLyrics,{item:s.item,lyricsId:s.item.lyricsId,onPlayLyrics:A}),xa||(xa=i.createElement(Ta.A.AddToFeedback,null)),i.createElement(Ta.A.OpenContextMenu,{item:s.item}))),i.createElement(fa.A.CellBody,{size:wa.ARTIST.SIZE},i.createElement(Sa.A,{links:s.item.artists.map((e=>({...e,type:kt.Ay.Artist})))})),i.createElement(fa.A.CellBody,{size:wa.DURATION.SIZE},i.createElement(ba.A,{duration:s.item.duration})),c.includes(Ea.Rj.Remove)&&i.createElement(fa.A.CellBody,{size:wa.REMOVE.SIZE},i.createElement(ka,{ariaLabel:(0,W.AP)("Retirer de la file d'attente"),isDisabled:0===t&&1===e.toDisplay.length,onClick:()=>g(t)})))}),mt.t7);var Da=n("ftFY"),Oa=n("EBWn"),Ma=n("ijnh");const Ua=({indexToScrollTo:e,height:t=0,items:n,options:s=[],onUpdateTracklistOrder:a,scrollAlignment:r,shouldExplicitBeHidden:o})=>{const l={id:"0",type:Ma.k},c={ID:l.id,TYPE:l.type},{manageItems:d,tableItems:u}=(0,Da.A)("0",n,c,{generateId:e=>`${e.id}-${(0,fe.A)(e,"legacy.TRACK_NUMBER","")}`}),{playerStatus:p}=(0,Pa.A)(c,l,!0,!0),m=(0,Oa.A)("0",u,c,a),h=i.useRef(null),g=i.useRef(null),y=(0,va.Ay)({container:l,context:c,hasBackground:!1,options:s,manageItems:d,order:m,playerStatus:p,shouldExplicitBeHidden:o,shouldPlayerNeverBeHid:!0});return(0,i.useEffect)((()=>{var t;h&&(null===(t=h.current)||void 0===t||t.scrollToItem(e,r))}),[]),i.createElement(va.ru,{value:y},i.createElement(fa.A,{tableRef:g,rowCount:u.toDisplay.length},i.createElement(fa.A.Body,null,i.createElement(mt.Y1,{height:t,itemCount:u.toDisplay.length,itemData:u,itemSize:Ea.F4.md,ref:h,width:"100%"},La))))},Fa={TITLE:{SIZE:Ca.uq.Full},DURATION:{SIZE:Ca.uq.sm},REMOVE:{SIZE:Ca.uq.sm}};var za;const Ba=i.memo((({data:e,index:t,style:n})=>{const s=e.toDisplay[t],{context:a,container:r,loadingStatus:o,isOrderable:l,shouldExplicitBeHidden:c}=i.useContext(va.Gt),{playerStatus:d,playQueuelistAtIndex:u,isItemLoadedInPlayer:p,removeTrack:m}=(0,Pa.A)({...a,ID:s.item.id},r,o.isFullyFetched,!0),h=s.item.hasExplicitLyrics&&c,g=(e,t)=>{u(e,t)};return i.createElement(fa.A.Row,{style:n,uuid:s.uuid,id:s.item.id,index:s.index,isActive:p(s.item)&&d.isSameContext,isOrderable:l,isReadable:s.item.right===Aa.A.READABLE,isRestrictedByExplicit:h,type:s.item.type},i.createElement(Ta.A,{size:Fa.TITLE.SIZE},i.createElement(Ta.A.Play,{ariaLabel:(0,W.AP)("generic_action_playsongXbyartistX_web",{sprintf:[s.item.title,s.item.parent.name]}),hasExplicitCover:s.item.parent.hasExplicitCover,onPlayItems:g,pictureUrl:s.item.cover(_a.r8).url}),za||(za=i.createElement(Ta.A.Download,null)),i.createElement(Ta.A.PlayableLabel,{description:s.item.description,hasExplicitLyrics:s.item.hasExplicitLyrics,label:s.item.title,onPlayItems:g,tooltipText:(0,Na.Y)(s.item,c)}),i.createElement(fa.A.IconGroup,null,i.createElement(Ta.A.OpenContextMenu,{item:s.item}))),i.createElement(fa.A.CellBody,{size:Fa.DURATION.SIZE},i.createElement(ba.A,{duration:s.item.duration})),i.createElement(fa.A.CellBody,{size:Fa.REMOVE.SIZE},i.createElement(ka,{ariaLabel:(0,W.AP)("Retirer de la file d'attente"),isDisabled:0===t&&1===e.toDisplay.length,onClick:()=>m(t)})))}),mt.t7),Ga=({height:e=0,indexToScrollTo:t,items:n,options:s=[],onUpdateTracklistOrder:a,scrollAlignment:r,shouldExplicitBeHidden:o})=>{const l={id:"0",type:Ma.k},c={ID:l.id,TYPE:l.type},{manageItems:d,tableItems:u}=(0,Da.A)("0",n,c),{playerStatus:p}=(0,Pa.A)(c,l,!0,!0),m=Ea.F4.lg,h=(0,Oa.A)("0",u,c,a),g=i.useRef(null),y=i.useRef(null),f=(0,va.Ay)({container:l,context:c,hasBackground:!1,options:s,manageItems:d,order:h,playerStatus:p,rowHeight:m,shouldExplicitBeHidden:o,shouldPlayerNeverBeHid:!0});return(0,i.useEffect)((()=>{var e;g&&(null===(e=g.current)||void 0===e||e.scrollToItem(t,r))}),[]),i.createElement(va.ru,{value:f},i.createElement(fa.A,{tableRef:y,rowCount:u.toDisplay.length},i.createElement(fa.A.Body,null,i.createElement(mt.Y1,{height:e,itemCount:u.toDisplay.length,itemData:u,itemSize:m,ref:g,width:"100%"},Ba))))},Qa=({indexToScrollTo:e,items:t,itemsType:n,options:s=[],onUpdateTracklistOrder:a,scrollAlignment:r="end",shouldExplicitBeHidden:o})=>{const{height:l}=(0,ya.A)(),c=(l||0)-216;return n===kt.Ay.Episode?i.createElement(Ga,{height:c,indexToScrollTo:e,items:t,options:s,onUpdateTracklistOrder:a,scrollAlignment:r,shouldExplicitBeHidden:o}):i.createElement(Ua,{indexToScrollTo:e,height:c,items:t,options:s,onUpdateTracklistOrder:a,scrollAlignment:r,shouldExplicitBeHidden:o})};var Ha=n("sAMA");class Ya extends i.Component{constructor(e){super(e),this._updateTracklistOrder=this._updateTracklistOrder.bind(this),this._getNbTracksToDisplay=this._getNbTracksToDisplay.bind(this),this.state={nbDisplayTracks:1e4}}render(){const{index:e,isRadio:t,maxPlayedIndex:n,shouldExplicitBeHidden:s,uiType:a}=this.props,r=[Ea.Rj.Reorder];return t||r.push(Ea.Rj.Remove),i.createElement("div",{className:"queuelist-tracklist-inner"},i.createElement(Qa,{indexToScrollTo:t?n+1:e,items:this._getListToRender(),itemsType:a===kt.Ay.Podcast||a===kt.Ay.Show?kt.Ay.Episode:kt.Ay.Song,onUpdateTracklistOrder:this._updateTracklistOrder,options:r,ref:this._tracklistRef,shouldExplicitBeHidden:s,scrollAlignment:t?"end":"start"}))}_getNbTracksToDisplay(){const{isRadio:e,maxPlayedIndex:t}=this.props,{nbDisplayTracks:n}=this.state;return e?t+1:n}_getListToRender(){const{list:e}=this.props;return e.slice(0,this._getNbTracksToDisplay())}_updateTracklistOrder(e){const{list:t}=this.props;if(!e||!e.order||!Array.isArray(e.order))return;const n=t.slice(this._getNbTracksToDisplay()-1,t.length-1);us.Ay.orderTracks([...e.order,...n])}}const Va={dispatchHidePopper:U.Lm},ja=(0,a.Ng)((e=>({userID:e.user.id,shouldExplicitBeHidden:(0,k.Uw)(e.user)===Ha.g,list:e.player.music.list,index:e.player.music.index,maxPlayedIndex:e.player.music.maxPlayedIndex,isRadio:e.player.config.isRadio,playerUI:(0,ga.Cu)(e),uiType:(0,ga.ip)(e)})),Va)(Ya);class Wa extends i.Component{constructor(e){super(e),this._onUpNextToggle=this._onUpNextToggle.bind(this)}shouldComponentUpdate(e){return this.props.isUpnext!==e.isUpnext||this.props.hasUpNext!==e.hasUpNext}render(){const{isAuth:e,isUpnext:t,playerUI:n,hasUpNext:s}=this.props;return e&&(n.upnext||t)?i.createElement("div",{className:"queuelist-upnext-heading"},i.createElement("span",{className:"queuelist-title"},(0,W.AP)("Recommandations automatiques")),i.createElement(zt.d,{isChecked:s,onChange:this._onUpNextToggle,ms:2,"data-testid":"automatic_reco_switch_"+(s?"on":"off")})):null}_onUpNextToggle(e){const t=e.currentTarget.checked;this.props.updateSettings({global:{has_up_next:t}})}}const Ka=(0,a.Ng)((e=>({isAuth:e.user.isAuth,hasUpNext:e.user.hasUpNext,isUpnext:e.player.config.isUpnext,playerUI:(0,ga.Cu)(e)})),{updateSettings:T.Xx})(Wa);var $a,Ja,Xa,Za,er=n("UKg2"),tr=n("CqWf"),nr=n("lb8X"),sr=n("03m0"),ir=n("elFM"),ar=n("SF1U"),rr=n("Fzox"),or=n("Mb6w"),lr=n("OPhi"),cr=n("GkgI");const dr=({className:e,context:t,id:n,onClick:s,type:a})=>{const o=(0,rr.G)((e=>(0,lr.i8)(e.feedbacks,n,a))),l=(0,i.useCallback)((()=>{(o?or.A.remove:or.A.add)({context:t,id:n,type:a}),s&&s()}),[t,n,o,s,a]),c=(0,cr.b)({type:a,action:"dislike"},o?"hover":"add","full"),d={[kt.Ay.Artist]:{default:$a||($a=i.createElement(nr.G,{size:"medium"})),isDisliked:Ja||(Ja=i.createElement(sr.x,{size:"medium"}))},[kt.Ay.Song]:{default:Xa||(Xa=i.createElement(ir.z,{size:"medium"})),isDisliked:Za||(Za=i.createElement(ar.e,{size:"medium"}))}},u=o?"isDisliked":"default",p=(0,fe.A)(d,`${a}.${u}`,null);return i.createElement("button",{className:(0,r.A)("item-action",e),onClick:l},p&&i.createElement("span",{className:"item-icon"},p),i.createElement("span",{className:"item-label"},c))};var ur,pr,mr=n("UDcE"),hr=n("AfN5");const gr=({className:e,onClick:t,tuner:n})=>{const s=(0,i.useCallback)((()=>{const e="default"!==n?"default":"discovery",s=us.Ay.getContext(),i=Gn.default.get("log_contexts")[s.TYPE]===kt.Ay.Flow;us.Ay.play({type:i?hr.Kk.USER:hr.Kk.MULTI_FLOW,id:s.ID,radio:!0,tuner:e,context:s}),null==t||t()}),[t,n]),a={default:{icon:ur||(ur=i.createElement(mr.A,{size:"medium"})),text:(0,W.AP)("flowsettings_text_iwantmorediscoveries_web")},discovery:{icon:pr||(pr=i.createElement(Vi.M,{size:"medium"})),text:(0,W.AP)("flowsettings_text_iwantmorefavorites_web")}},o=e=>(0,fe.A)(a,`[${n}].[${e}]`);return i.createElement("button",{className:(0,r.A)("item-action",e),onClick:s},i.createElement("span",{className:"item-icon"},o("icon")),i.createElement("span",{className:"item-label"},o("text")))};var yr,fr=n("WN1e");const Ar=({className:e,onClick:t})=>{const[n]=(0,a.d4)((e=>[(0,k.F6)(e.user)])),s=us.Ay.getContext(),o=(0,i.useCallback)((()=>{us.Ay.play({type:hr.Kk.USER,id:n,radio:!0,context:s}),t&&t()}),[t,n,s]);return i.createElement("button",{className:(0,r.A)("item-action",e),onClick:o},yr||(yr=i.createElement("span",{className:"item-icon"},i.createElement(fr.R,{size:"medium"}))),i.createElement("span",{className:"item-label"},(0,W.AP)("flowsettings_action_changestyle_web")))};var _r,Er;const vr=({artistId:e,context:t,onClose:n,trackId:s})=>{const r=(0,a.d4)((({user:e})=>(0,k.H3)(e))),o=Gn.default.get("log_contexts")[t.TYPE]===kt.Ay.Flow,l=Gn.default.get("log_contexts")[t.TYPE]===kt.Ay.MultiFlow,c=o||l,d=r&&_.A.isAllowed("tuner_flow_config")?c:o;return i.createElement("div",{className:"player-overlay-user-feedback"},i.createElement("div",{className:"header ellipsis"},c?(0,W.AP)("flowsettings_title_notsatisfiedwithyourflow_web"):(0,W.AP)("banfeatures_title_nothappywithyourmix_web")),i.createElement("ul",{className:"menu"},d&&i.createElement("li",{className:"item"},i.createElement(gr,{tuner:r,onClick:n})),o&&i.createElement("li",{className:"item"},i.createElement(Ar,{onClick:n})),i.createElement("li",{className:"item"},i.createElement(dr,{context:t,id:s,onClick:n,type:kt.Ay.Song})),"0"!==e&&i.createElement("li",{className:"item"},i.createElement(dr,{context:t,id:e,onClick:n,type:kt.Ay.Artist})),!o&&i.createElement("li",{className:"item"},i.createElement(Mt.A,null,i.createElement(Ue.A,{className:"item-action",to:"/channels/mixes",onClick:n},i.createElement("span",{className:"item-label"},(0,W.AP)("banfeatures_title_changemood_web")),_r||(_r=i.createElement(Ut.A,null))))),i.createElement("li",{className:"item"},i.createElement(Mt.A,null,i.createElement(Ue.A,{className:"item-action",to:"/exclusions",onClick:n},i.createElement("span",{className:"item-label"},(0,W.AP)("banfeatures_action_managemyexclusions_web")),Er||(Er=i.createElement(Ut.A,null)))))))};var br,Sr;const kr=({artistId:e,context:t,trackId:n,title:s,placement:a="top"})=>{const[r,o]=(0,i.useState)(!1),l=()=>o(!1),c={artistId:e,context:t,trackId:n,onClose:l};return i.createElement(tr.AM,{isLazy:!0,isOpen:r,onOpen:()=>o(!0),onClose:l,placement:a},i.createElement(tr.Wv,null,i.createElement(J.az,null,i.createElement(Ws.m,{isDisabled:r,label:s},i.createElement(ue.K0,{"data-testid":"angry_face_button",variant:"ghost",isActive:r,_active:{color:"icon.accent.primary.default",bg:"transparent"},"aria-label":s,size:"small",icon:br||(br=i.createElement(er.W,null))})))),i.createElement(tr.hl,{w:"auto"},Sr||(Sr=i.createElement(tr.Rp,null)),i.createElement(tr.ej,{p:0},i.createElement(vr,c))))};var Tr=n("Vsul"),Cr=n("CyAC"),wr=n("VwKc"),Ir=n("Vzbh");const xr=({playerUI:{title:e},track:t})=>e&&e.url&&e.id&&Number(t[e.id])&&t.RIGHTS&&Object.entries(t.RIGHTS).length>0?e.url+t[e.id]:null,Pr=({playerUI:{subTitle:e}},{ART_ID:t=0})=>e&&e.url&&Number(t)?e.url+t:null;var Nr,Rr,Lr,Dr,Or,Mr,Ur,Fr,zr,qr=n("23Qi"),Br=n("Qmjy");class Gr extends i.Component{constructor(e){super(e),this._onPlayerClose=this._onPlayerClose.bind(this),this._onLyricsClick=this._onLyricsClick.bind(this)}render(){return i.createElement("div",{className:"player-wrapper player-queuelist"},this._renderHeader(),this._renderContainer())}_renderHeader(){return i.createElement("div",{className:"player-header"},i.createElement("div",{className:"player-close"},i.createElement(Ws.m,{label:(0,W.AP)("Fermer"),position:"bottom"},i.createElement("button",{className:"svg-icon-group-btn",type:"button",onClick:this._onPlayerClose,"aria-label":(0,W.AP)("generic_action_closepanel_web")},Nr||(Nr=i.createElement(la.e,null))))))}_renderContainer(){return i.createElement("div",{className:"player-container"},this._renderCover(),this._renderContent())}_renderCover(){return i.createElement("div",{className:"queuelist-cover"},this._renderCoverPicture(),this._renderCoverActions(),this._renderCoverTitle(),this._renderCoverSubTitle(),this._renderLabel())}_renderCoverPicture(){const{cover:e,isExplicitCover:t,trackTitle:n}=this.props;return i.createElement(J.az,{position:"relative",width:"100%"},i.createElement(bi.A,{src:e,alt:n,isExplicitCover:t}),this._renderCoverExplicit(),this._renderCoverSticker())}_renderLabel(){const{isFlow:e,isUpnext:t,playerUI:n,uiType:s}=this.props;if(!n.label)return null;let a=(0,W.AP)("MIX");return s===ha.U.AD||s===ha.U.TRITON_AD?a=(0,W.AP)("PUBLICITÉ"):s===ha.U.LIVESTREAM?a=(0,W.AP)("EN DIRECT"):t?a=(0,W.AP)("RECOMMANDÉ"):e&&(a=(0,W.AP)("FLOW")),i.createElement("span",{className:"queuelist-cover-label"},i.createElement("span",{className:"label"},a))}_renderCoverTitle(){const{trackTitle:e,uiType:t}=this.props;let n=e;if(t===ha.U.AD){const e=window.sasAudioConfig||{},t=e.text,s=decodeURIComponent(e.url),a=e=>{e.preventDefault(),e.stopPropagation(),/^http/.test(s)&&(0,Tr.A)(s)};n=i.createElement("a",{className:"queuelist-cover-link",href:s,onClick:a},t)}else null!==xr(this.props)&&(n=i.createElement(Ue.A,{className:"queuelist-cover-link",to:xr(this.props)},e));return i.createElement("div",{className:"queuelist-cover-title"},this._renderExplicit(),n)}_renderCoverSubTitle(){const{trackArtists:e,uiType:t}=this.props;return t===ha.U.AD?null:i.createElement("div",{className:"queuelist-cover-subtitle"},e.map(((e,t)=>[t>0?", ":"",null===Pr(this.props,e)?e.ART_NAME:i.createElement(Ue.A,{className:"queuelist-cover-link",key:e.ART_ID,to:Pr(this.props,e)},e.ART_NAME)])))}_renderExplicit(){return this.props.isExplicit?Rr||(Rr=i.createElement(ua.A,{size:"small",me:"spacing.s"})):null}_renderCoverExplicit(){const{shouldHideCoverForUser:e}=this.props;return e?null:this.props.isExplicit?Lr||(Lr=i.createElement("div",{className:"explicit-container"},i.createElement(ua.A,null))):null}_renderCoverSticker(){const{audioQuality:e}=this.props;let t;switch(e){case Ir.en.LOSSLESS:t=(0,W.AP)("HiFi");break;case Ir.en.HIGH:t="HQ";break;default:return null}return i.createElement("span",{className:"queuelist-cover-sticker sticker"},t)}_renderCoverActions(){return i.createElement("div",{className:"queuelist-cover-actions"},i.createElement("ul",{className:"svg-icon-group"},this._renderActionLyrics(),i.createElement("li",{className:"svg-icon-group-item"},this._renderActionContextMenu("addToPlaylist")),i.createElement("li",{className:"svg-icon-group-item"},this._renderActionLike()),this._renderActionUserFeedback(),i.createElement("li",{className:"svg-icon-group-item"},this._renderActionContextMenu())))}_renderActionLyrics(){const{playerUI:e,isOnline:t}=this.props;if(!e.lyrics||!this.props.hasLyrics||!t)return null;const n=(0,W.AP)("Afficher les paroles");return i.createElement("li",{className:"svg-icon-group-item"},i.createElement(Ws.m,{label:n},i.createElement("button",{className:"svg-icon-group-btn",type:"button",onClick:this._onLyricsClick,"aria-label":n},Dr||(Dr=i.createElement(ca.c,null)))))}_renderActionLike(){const{playerUI:e,id:t,track:n}=this.props;if(!e.like)return null;const s=String(n.SNG_ID_ORIGIN||t);return i.createElement(pa.A,{className:"svg-icon-group-btn",type:"song",context:{ID:s,TYPE:"player",CONTEXT_ID:n.SPONSORED?"sponsored=true":void 0},tooltip:!0,id:s})}_renderActionContextMenu(e){const{track:t,index:n,id:s,context:a,playerUI:r,userId:o}=this.props;if(!r.contextMenu)return null;const l="addToPlaylist"===e,c={anchor:i.createElement("button",{className:"svg-icon-group-btn",type:"button"},l?Or||(Or=i.createElement($i.c,null)):Mr||(Mr=i.createElement(Us.j,null))),context:{ID:o,TYPE:"queuelist"},data:{INDEX:n,SONG:t,PLAYLIST_ID:a.ID},forceShowPlaylists:l,id:s,placement:"right"};return i.createElement(ma.A,c)}_renderActionUserFeedback(){const{context:e,id:t,isRadio:n,playerUI:a,track:r,trackArtists:o}=this.props;if(!a.userFeedback||!e.TYPE||!n&&Gn.default.get("log_contexts")[e.TYPE]!==kt.Ay.Smarttracklist)return null;const l={artistId:o.length>0?o[0].ART_ID:"0",context:e,trackId:String(r.SNG_ID_ORIGIN||t),title:(0,W.AP)("banfeatures_title_nothappywithyourmix_web")};return i.createElement(kr,(0,s.A)({placement:"right"},l))}_renderContent(){return i.createElement("div",{className:"queuelist-content"},i.createElement("div",{className:"queuelist-header"},i.createElement("div",{className:"queuelist-heading"},this._renderTitle(),this._renderSubTitle()),Ur||(Ur=i.createElement(Ka,null)),this._renderSaveAsPlaylist()),Fr||(Fr=i.createElement(ja,null)))}_renderTitle(){const{isRadio:e,isFlow:t,isUpnext:n}=this.props;let s=(0,W.AP)("File d'attente");return e&&!n&&(s=t?(0,W.AP)("Derniers titres écoutés sur Flow"):(0,W.AP)("Derniers titres écoutés dans le mix")),i.createElement("span",{className:"queuelist-title"},s)}_renderSubTitle(){const{list:e,isRadio:t,tracklistDuration:n}=this.props;if(t)return null;const s=(0,W.WI)("%s titre","%s titres",{sprintf:[(0,qr.A)(e.length)],count:e.length});return i.createElement("span",{className:"queuelist-subtitle"}," ","· ",s," · ",(0,Br.A)(n))}_renderSaveAsPlaylist(){const{saveAsPlaylist:e}=this.props.playerUI,{list:t,userId:n}=this.props;if(!e)return null;const s=this._getTrack(),a=1===s.length?{SONG:t[0]}:{},r={anchor:i.createElement(ue.K0,{"aria-label":(0,W.AP)("Ajouter à une playlist"),size:"sm",icon:zr||(zr=i.createElement(da.G,null))}),context:{ID:n,TYPE:"queuelist"},data:a,forceShowPlaylists:!0,id:s};return i.createElement(ma.A,r)}_onPlayerClose(){this.props.setPlayerFull(!1)}_onLyricsClick(){this.props.playerLyrics?this.props.setPlayerFull(!1):this.props.setPlayerLyrics(!0),us.Ay.isPaused()||us.Ay.isPlaying()||us.Ay.control.play()}_getTrack(){const{isUpnext:e,isRadio:t,list:n,maxPlayedIndex:s}=this.props;let i=n;return(t||e)&&(i=i.slice(0,s+1)),[...new Set(i.map((e=>e.SNG_ID||e.UPLOAD_ID)))]}}const Qr=(0,a.Ng)((e=>({id:e.player.music.id,track:e.player.music.track,list:e.player.music.list,index:e.player.music.index,context:e.player.music.context,isExplicit:e.player.music.isExplicit,isExplicitCover:(0,Cr.cV)(e.player.music.track),maxPlayedIndex:e.player.music.maxPlayedIndex,tracklistDuration:e.player.music.tracklistDuration,trackTitle:e.player.music.trackTitle,trackArtists:e.player.music.trackArtists,shouldHideCoverForUser:(0,Cr.vp)(e.user,e.player.music.track),cover:e.player.music.cover,isRadio:e.player.config.isRadio,isFlow:e.player.config.isFlow,isUpnext:e.player.config.isUpnext,playerLyrics:e.player.config.playerLyrics,userId:e.user.id,isOnline:e.app.online,hasLyrics:(0,wr.jk)(e),playerUI:(0,ga.Cu)(e),uiType:(0,ga.ip)(e),audioQuality:(0,wr.iQ)(e)})),{setPlayerFull:ia.no,setPlayerLyrics:ia.IG})(Gr);var Hr=n("Al8Q"),Yr={name:"1mbtf8x",styles:"cursor:default;pointer-events:none"},Vr={name:"1o8xqr1",styles:"display:block;font-size:16px;font-weight:700;line-height:16px;margin-bottom:0;opacity:1;overflow:hidden;padding:8px 16px;text-overflow:ellipsis;white-space:nowrap"},jr={name:"ms3bo3",styles:"background-color:rgb(255 255 255 / 20%);border-radius:4px"},Wr={name:"1eonw7n",styles:"&:hover{background-color:rgb(255 255 255 / 20%);border-radius:4px;}"},Kr={name:"1e8njj4",styles:"font-weight:800;opacity:1;pointer-events:none"},$r={name:"vmbacr",styles:"opacity:0.5;&:hover{opacity:0.8;}"};const Jr=(0,Hr.A)("a",{target:"ewq8og21"})("color:",(({color:e})=>e||"var(--tempo-colors-text-neutral-primary-default)"),";display:inline-block;font-size:42px;font-weight:800;line-height:49px;padding:24px 0;transition-duration:0.15s;transition-property:background-color,color;vertical-align:top;width:100%;",(({isSynchro:e,isActive:t,isOneLine:n,disabled:s,isAutoScrolling:i})=>[e&&i&&!t&&$r,t&&Kr,!i&&Wr,!i&&t&&jr,n&&Vr,s&&Yr]),";"),Xr=(0,Hr.A)("span",{target:"ewq8og20"})({name:"kid949",styles:"display:block;font-size:32px;font-style:italic;font-weight:400;line-height:38px;margin-top:16px"});var Zr=n("FMs+");const eo=i.memo((({milliseconds:e,line:t,lineTranslated:n,isActive:s,tone:a,isOneLine:r,index:o,isAutoScrolling:l,onClick:c,innerRef:d})=>{const u=a&&(Zr.Tj[a]?Zr.Tj[a][1]:void 0),p=-1!==e,m=t?t.trim():"";return p?i.createElement(Jr,{ref:d,isActive:p&&s&&!r,isOneLine:r,isSynchro:p,isAutoScrolling:l,color:u,onClick:()=>{c&&c(o,e)},role:"button","data-milliseconds":String(e),"data-index":o},m,n&&!r&&i.createElement(Xr,null,n)):i.createElement(Jr,{ref:d,color:u,disabled:!0},m)}));eo.displayName="Line",eo.defaultProps={milliseconds:-1,index:0,isOneLine:!1};const to=i.forwardRef(((e,t)=>i.createElement(eo,(0,s.A)({innerRef:t},e))));to.displayName="Line";const no=to;var so=n("IXMZ");const io=(0,so.Bv)(J.so,{baseStyle:{alignItems:"center",height:"60px",justifyContent:"space-between",marginTop:"1.5rem",minHeight:"60px",position:"relative",px:"spacing.2xl",width:"100%",zIndex:"2"}}),ao=(0,so.Bv)(J.so,{baseStyle:{bg:"rgb(255 255 255 / 20%)",borderRadius:"s",fontSize:"14px",height:"32px",minWidth:"0",width:"100%",textAlign:"center",_hover:{bg:"rgba(255 255 255 / 40%)"},"@media only screen and (max-width: 990px)":{margin:0}}});var ro=n("U5dO"),oo=n("pxHn");const lo=(e,t)=>{const{timeToFirstLyric:n,isSync:s,lines:i}=t,a=Math.round(1e3*e);if(a<1e3*n||!s)return-1;const r=i[i.length-1];if(a>Number(r.milliseconds))return i.length-1;let o=0,l=0,c=i.length,d=0,u=0;for(;o!==c;)l=Math.floor((o+c)/2),d=Number(i[l].milliseconds),d<=a?o=l+1:c=l;return u=0===o?o:o-1,u};var co=n("XBvc");const uo=e=>{const t=(0,a.d4)((e=>(0,k.mS)(e.user))),n=(0,a.d4)((e=>(0,k.gE)(e.user)));return(0,i.useCallback)((s=>{const i="lyrics";(0,co.isLogCentralWhitelisted)(i)||v.A.warn(`log_central is deprecated. "${i}" is not a whitelisted event.`);const a={...s,sng:e,container:"panel",ts:(0,k.mI)({SERVER_TIMESTAMP:t,clientTimestampDelta:n})};return Ae.A.call({method:"log_central.log",data:{BATCH:[{channel:i,params:a}]}}),!0}),[n,t,e])};let po=function(e){return e.SYNCHRO="synchro",e.FULL_TEXT="full_text",e}({}),mo=function(e){return e.PANEL="panel",e.PAGE_TRACK="page_track",e}({}),ho=function(e){return e.DISPLAY="display",e.DISPLAY_NEXT="display_next",e.CLICK_TRANSLATE="click_translate",e.CLICK_UNTRANSLATE="click_untranslate",e.CLICK_SHARE="click_share",e.CLICK_CLOSE="click_close",e.CLICK_REPORT_PROBLEM="click_report_problem",e.CLICK_CONFIRM_PROBLEM="click_confirm_problem",e}({}),go=function(e){return e.PROBLEM_SYNCHRONIZATION="problem_synchronization",e.PROBLEM_MATCHING="problem_matching",e.PROBLEM_LANGUAGE="problem_language",e.PROBLEM_TYPO="problem_typo",e.PROBLEM_TRANSLATION="problem_translation",e}({});const yo=new class{constructor(e){this._logCenter=void 0,this._logCenter=e}logReportClick(e,t,n){this.log({trackId:e,isSynchro:t,container:mo.PANEL,action:{type:ho.CLICK_REPORT_PROBLEM},country:n})}logProblem(e,t,n,s){this.log({trackId:e,isSynchro:t,container:mo.PANEL,action:{type:ho.CLICK_CONFIRM_PROBLEM,context:n},country:s})}log({trackId:e,isSynchro:t,container:n,action:s,country:i}){this._logCenter.log((0,cs.L)("lyrics.lyrics_action","1.0.0",{sng:Number(e),lyrics_type:t?po.SYNCHRO:po.FULL_TEXT,container:n,action:s,client_ip:ls.A.get(),country:i}))}}(De.A),[fo,Ao]=(0,oo.q)({name:"Lyrics"}),_o=({children:e,lyricsContentRef:t})=>{const[n,s]=(0,i.useState)(!1),r=(0,a.d4)((e=>e.player.music.id)),o=uo(r),l=(0,a.d4)((e=>e.player.config.playerType)),c=(0,a.d4)((e=>e.player.config.playerQueuelist)),d=(0,a.d4)((e=>e.user.COUNTRY)),u=(0,i.useRef)(!0),p=(0,a.wA)(),m=(0,i.useMemo)((()=>us.Ay.hasLyrics()),[r]),{lyrics:h,cover:g,loading:y,error:f}=((e,t,n)=>{const[s,a]=(0,i.useState)(!0),[r,o]=(0,i.useState)({lines:[],text:"",isSync:!1,timeToFirstLyric:0,hasTranslation:!1,metadata:{copyrights:"",writers:""}}),[l,c]=(0,i.useState)({explicitStatus:!1,small:[],medium:[],large:[]}),[d,{error:u}]=(0,pi.xcD)({onCompleted:e=>{var n,s;if(null!=e&&null!==(n=e.track)&&void 0!==n&&null!==(n=n.album)&&void 0!==n&&n.cover&&c({explicitStatus:e.track.album.cover.explicitStatus,small:e.track.album.cover.small,medium:e.track.album.cover.medium,large:e.track.album.cover.large}),null==e||null===(s=e.track)||void 0===s||!s.lyrics)return a(!1),void t(null);const{synchronizedLines:i,text:r,writers:l,copyright:d}=e.track.lyrics;let u=[];u=i?i.filter((e=>e.line)):r.split(/\r\n|\r|\n/g).map((e=>({__typename:"LyricsSynchronizedLine",line:e,lineTranslated:null,lrcTimestamp:null,milliseconds:-1,duration:null})));const p={lines:u,text:r,isSync:Boolean(i),timeToFirstLyric:u.length>0&&-1!==u[0].milliseconds?(u[0].milliseconds||0)/1e3:0,hasTranslation:u.some((e=>Boolean(e.lineTranslated))),metadata:{copyrights:d||"",writers:l||""}};o(p),a(!1),t(p)},onError:()=>{n(),a(!1)}});return(0,i.useEffect)((()=>{a(!0),d({variables:{trackId:e}})}),[d,e]),{lyrics:r,cover:l,loading:s,error:u}})(r,(e=>{o(e?{action:{type:u.current?"display":"display_next"},type:e.isSync?"synchro":"full_text"}:{action:{type:u.current?"display":"display_next",context:"no_lyrics"}}),u.current=!1}),(()=>{o({action:{type:u.current?"display":"display_next",context:"error"}}),u.current=!1})),A=(0,i.useCallback)((()=>{o(!m||f?{action:{type:"click_close",context:m?"error":"no_lyrics"}}:{action:{type:"click_close"},type:h.isSync?"synchro":"full_text"}),p(c?(0,ia.IG)(!1):(0,ia.no)(!1))}),[p,f,m,h.isSync,c,o]),_=(0,i.useCallback)((()=>{yo.logReportClick(r,h.isSync,d),s(!0)}),[h.isSync,r]);return(0,i.useEffect)((()=>{l===hr.Cc.ADS&&A()}),[A,l]),i.createElement(fo,{value:{cover:g,error:f,handleClose:()=>s(!1),handleLyricsClose:A,handleReportProblemClick:_,hasLyrics:m,isReportProblemOpen:n,loading:y,lyrics:h,trackId:r}},i.createElement(bo,{lyricsContentRef:t},e))},[Eo,vo]=(0,oo.q)({name:"LyricsSync"}),bo=({children:e,lyricsContentRef:t})=>{const n=(0,a.d4)((e=>e.player.control.playing)),{lyrics:s}=Ao(),[r,o]=(0,i.useState)(lo(us.Ay.getPosition(),s)),l=(0,i.useRef)(0),[c,d]=(0,i.useState)(0),[u,p]=(0,i.useState)(!0),m=(0,i.useCallback)((e=>{var s;null===(s=t.current)||void 0===s||s.scrollToLine(e,!0),n||us.Ay.control.play(),p(!0)}),[n]);return(0,i.useEffect)((()=>{o(lo(us.Ay.getPosition(),s));const{lines:e,isSync:n,timeToFirstLyric:i}=s,a=(e,n)=>{var a;d(n),o(lo(n,s)),n<i&&l.current>n&&(null===(a=t.current)||void 0===a||a.scrollToTop()),l.current=n},{current:r}=t;return e.length&&n&&A.A.subscribe(A.A.player.position,a),()=>{e.length&&n&&(null==r||r.clearAutoScrollAnimation(),A.A.unsubscribe(A.A.player.position,a))}}),[s,t]),i.createElement(Eo,{value:{activeLyricIndex:r,position:c,autoScroll:u,setAutoScroll:p,handleHeaderClick:m}},e)};var So,ko;const To=({tone:e})=>{const{error:t,hasLyrics:n,lyrics:s}=Ao(),{handleHeaderClick:a,autoScroll:r,activeLyricIndex:o}=vo(),l=(0,i.useMemo)((()=>{if(n&&s.isSync&&!r&&-1!==o)return s.lines[o]}),[o,r,n,s.isSync,s.lines]);return!t&&l?i.createElement(ao,null,i.createElement(no,{line:l.line,milliseconds:Number(l.milliseconds),index:o,tone:e,onClick:a,isOneLine:!0,isActive:!0})):null},Co=({tone:e})=>{const{handleReportProblemClick:n,handleLyricsClose:s,hasLyrics:a}=Ao();return i.createElement(io,{__css:{"-webkit-app-region":Ji.A.is("windows")?"no-drag":"drag"}},i.createElement((({children:t})=>e===Zr.DP.white||e===Zr.DP.acid||e===Zr.DP.flame||e===Zr.DP.jellyfish||e===Zr.DP.algae?i.createElement(ii.K2,null,t):i.createElement(ii.QQ,null,t)),null,i.createElement(ue.K0,{onClick:s,"aria-label":(0,W.AP)("generic_action_closepanel_web"),icon:So||(So=i.createElement(ge.w,null)),variant:"ghost"}),i.createElement(J.zt,{justifyContent:"flex-end",maxW:"60%",spacing:"spacing.l",w:"60%"},i.createElement(To,{tone:e}),_.A.isAllowed("lyrics_report_problem")&&a&&i.createElement(ue.K0,{onClick:n,"aria-label":(0,W.AP)("lyricstranslation_title_reportaproblem_web"),icon:ko||(ko=i.createElement(ro.Z,null)),variant:"ghost"}))))},wo=(0,Hr.A)("div",{target:"eq17m0q2"})({name:"bxqzz5",styles:"margin:auto;text-align:center"}),Io=(0,Hr.A)(at.A,{target:"eq17m0q1"})({name:"1edk0dm",styles:"flex:1;height:100%;width:100%;.scroller-shadow-top,.scroller-shadow-bottom{display:none;}.nano-content{padding:180px 104px 136px 72px;@media only screen and (max-width: 990px){padding:180px 40px 136px 32px;}}.nano-pane{z-index:1;}"}),xo=(0,Hr.A)("span",{target:"eq17m0q0"})("color:",(({tone:e})=>e&&Zr.Tj[e]?Zr.Tj[e][1]:"var(--tempo-colors-text-neutral-primary-default)"),";display:inline-block;font-size:12px;font-weight:400;line-height:14px;padding:18px 0;"),Po=(0,Hr.A)("div",{target:"ernh3em4"})("color:",(({color:e})=>e||"var(--tempo-colors-text-neutral-primary-default)"),";height:100px;margin:32px auto 40px;position:relative;width:100px;"),No=(0,Hr.A)("svg",{target:"ernh3em3"})({name:"inrq",styles:"transform:rotate(-90deg)"}),Ro=(0,Hr.A)("g",{target:"ernh3em2"})("fill:none;opacity:0.4;stroke:",(({color:e})=>e||"rgb(255 255 255)"),";stroke-width:4;");var Lo={name:"8qouid",styles:"transition:stroke-dashoffset 0.3s linear"};const Do=(0,Hr.A)("g",{target:"ernh3em1"})("fill:none;stroke:currentColor;stroke-width:4;",(({hasTransition:e})=>e&&Lo),";"),Oo=(0,Hr.A)("div",{target:"ernh3em0"})({name:"1r0dpzo",styles:"left:50%;position:absolute;top:50%;transform:translate(-50%, -50%)"});var Mo,Uo,Fo;const zo=90*Math.PI+5,qo=i.memo((({max:e,now:t,tone:n})=>{const s=(0,i.useMemo)((()=>n&&Zr.Tj[n]?Zr.Tj[n][1]:void 0),[n]),a=(0,i.useMemo)((()=>e<0||t<=0?zo:0===e||t>e?0:(e-t)/e*zo),[e,t]),r=(0,i.useRef)(null),o=(0,i.useMemo)((()=>!(0===a&&null===r.current||a===zo||null!==r.current&&a>=r.current)),[a]);let l,c,d,u,p;return(0,i.useEffect)((()=>{r.current=a}),[a]),e>0&&(l=0,c=e,d=t<c?t:c,u=Math.floor(c-d),p=(0,W.WI)("%s seconde","%s secondes",{sprintf:[u],count:u})),i.createElement(Po,{color:s},i.createElement(No,{height:"100",width:"100",x:"0",y:"0"},i.createElement(Ro,{color:s},Mo||(Mo=i.createElement("circle",{cx:"50",cy:"50",r:45}))),i.createElement(Do,{hasTransition:o,role:"timer","aria-describedby":"starter-message","aria-valuemin":l,"aria-valuemax":c,"aria-valuenow":d,"aria-valuetext":p,strokeDasharray:zo,strokeDashoffset:a},Uo||(Uo=i.createElement("circle",{cx:"50",cy:"50",r:45})))),Fo||(Fo=i.createElement(Oo,null,i.createElement(ca.c,{size:"medium"}))))}),((e,t)=>-1===t.max||t.now>t.max+5));qo.displayName="Spinner";const Bo=qo,Go=(0,Hr.A)("div",{target:"e1oxyilq0"})("color:",(({tone:e})=>e&&Zr.Tj[e]?Zr.Tj[e][1]:"var(--tempo-colors-text-neutral-secondary-default)"),";font-size:12px;margin-top:96px;text-align:center;"),Qo=({copyrights:e,writers:t,tone:n})=>i.createElement(Go,{role:"complementary",tone:n},i.createElement("p",null,(0,W.AP)("Licence et autorisation données par LyricFind")),i.createElement("p",{itemType:"https://schema.org/Organization",itemProp:"copyrightHolder",itemScope:!0},"© ",i.createElement("span",{itemProp:"legalName"},e)),i.createElement("p",{itemType:"https://schema.org/Person",itemProp:"lyricist",itemScope:!0},i.createElement("span",{itemProp:"name"},t)));var Ho=n("pkJ8"),Yo=n("AeFk");const Vo=(0,Hr.A)("div",{target:"emp9aai0"})("height:100%;width:100%;",(({maskGradient:e})=>(0,Yo.AH)("mask-image:linear-gradient(\n\t\t\tto bottom,\n\t\t\t",e.map((e=>`rgb(0 0 0 / ${100*e.opacity}%) ${e.percentage}%`)).join(","),"\n\t\t);","")),";"),jo=[{opacity:0,percentage:0},{opacity:1,percentage:18}],Wo=[{opacity:1,percentage:75},{opacity:0,percentage:88}],Ko=(0,Ho.A)((e=>{const t=e.getClientHeight(),n=e.getScrollHeight(),s=e.getScrollTop(),i=s+t,a=s-20,r=t/5;let o=jo.map((e=>({...e,percentage:0})));a>0&&(o=a<=r?jo.map((e=>({...e,percentage:Math.ceil(a/r*e.percentage)}))):jo);let l=Wo;return i>n-r&&(l=Wo.map((e=>({...e,percentage:Math.round(100-(n-i)/r*(100-e.percentage))})))),[...o,...l]}),100),$o=i.forwardRef((({children:e},t)=>{const[n,s]=(0,i.useState)([...jo,...Wo]);return(0,i.useImperativeHandle)(t,(()=>({setMaskGradient:e=>{const t=Ko(e);t&&n.some(((e,n)=>e.percentage!==t[n].percentage))&&s(t)}}))),i.createElement(Vo,{maskGradient:n},e)}));$o.displayName="LyricsMask";const Jo=$o,Xo=i.forwardRef((({lyrics:e,isSynchro:t,tone:n,activeIndex:r,position:o,autoScroll:l,onAutoScrollChange:c,showTranslatedLyrics:d},u)=>{const{isSync:p,metadata:m,lines:h,timeToFirstLyric:g}=e,y=(0,i.useRef)(null),f=(0,i.useRef)(null),A=(0,i.useRef)(null),_=(0,i.useRef)(null),E=(0,i.useRef)(l),v=(0,i.useRef)(null),b=(0,i.useRef)(null),S=(0,i.useRef)(p),k=(0,i.useRef)(r),T=(0,i.useRef)([]),C=(0,i.useRef)(0),w=(0,a.d4)((e=>e.player.music.trackDuration)),I=(0,i.useCallback)((()=>{y.current&&A.current&&A.current.setMaskGradient(y.current)}),[]),x=(0,i.useCallback)((e=>T.current[e]),[]),P=(0,i.useCallback)((()=>{null!==_.current&&window.cancelAnimationFrame(_.current),null!==v.current&&window.clearTimeout(v.current),_.current=null,v.current=null}),[]),N=(0,i.useCallback)((()=>{_.current=window.requestAnimationFrame((()=>{y.current?(y.current.scrollToTop(),_.current=null):_.current=null}))}),[]),R=(0,i.useCallback)(((e,t=!1)=>{if(!f.current||!y.current)return;if(!(t||E.current&&-1!==e))return;const n=x(e);if(!n)return;P();const s=y.current.getClientHeight(),i=y.current.getScrollHeight(),a=n.getBoundingClientRect().height,r=Math.round(n.offsetTop+a/2-s/2),o=Math.max(Math.round(Math.abs((y.current.getScrollTop()-r)/10)),10),l=()=>{if(!y.current)return;const e=y.current.getScrollTop();let t;e-r>0?(t=e-o,t<r&&(t=r)):(t=e+o,t>r&&(t=r)),y.current.scrollTop(t),t===r||i<=t+s||t<0?P():_.current=window.requestAnimationFrame(l)};_.current=window.requestAnimationFrame(l)}),[P,x]),L=(0,i.useCallback)((()=>{if(!f.current||!y.current||null!==b.current)return;const e=x(k.current);if(!e)return;const t=y.current.getClientHeight(),n=y.current.getScrollTop(),s=Math.round(.08*t),i=Math.round(.15*t),a=e.getBoundingClientRect().height,r=Math.round(e.offsetTop+a/2);(r<0||r<=n+t-i&&r>=n+s)&&(R(k.current,!0),c(!0))}),[x,R,c]),D=(0,i.useCallback)((()=>{var e;I(),!S.current||E.current&&null!==_.current||C.current!==(null===(e=y.current)||void 0===e?void 0:e.getScrollHeight())||(E.current?(P(),c(!1)):(b.current&&window.clearTimeout(b.current),b.current=window.setTimeout((()=>{b.current=null}),500)))}),[I,P,c]),O=(0,i.useCallback)(((e,t)=>{us.Ay.control.seek(t/1e3/w),c(!0)}),[c,w]);return(0,i.useImperativeHandle)(u,(()=>({scrollToTop:N,scrollToLine:R,clearAutoScrollAnimation:P}))),(0,i.useLayoutEffect)((()=>{S.current=p}),[p]),(0,i.useLayoutEffect)((()=>{E.current=l}),[l]),(0,i.useEffect)((()=>{var e;C.current=(null===(e=y.current)||void 0===e?void 0:e.getScrollHeight())||0})),(0,i.useEffect)((()=>{I()}),[e,I]),(0,i.useEffect)((()=>{k.current=r,E.current?R(r):L()}),[r,L,R]),(0,i.useEffect)((()=>{e.lines.length&&(c(!0),N())}),[e,c,N]),(0,i.useEffect)((()=>{R(k.current)}),[d,R]),i.createElement(Jo,{ref:A},i.createElement(Io,(0,s.A)({ref:y,shadow:!1,onScroll:D},p?{role:"marquee","aria-live":l?"assertive":"polite"}:{}),p&&i.createElement(Bo,{now:o,max:g,tone:n}),i.createElement("div",{ref:f,itemType:"https://schema.org/MusicComposition",itemScope:!0},i.createElement(wo,{itemType:"http://schema.org/CreativeWork",itemProp:"lyrics",itemScope:!0},i.createElement("div",{itemProp:"text"},!t&&i.createElement(xo,{tone:n},(0,W.AP)("sharelyricserrormessage_text_lyricsnotsyncedwithtrackyet_web")),h.filter((e=>t&&e.line||!t)).map(((e,s)=>i.createElement(no,{key:`lyrics_line_${s}`,ref:e=>T.current.push(e),index:s,line:e.line,lineTranslated:d?e.lineTranslated:void 0,milliseconds:t?Number(e.milliseconds):-1,isAutoScrolling:l,isActive:s===r,tone:n,onClick:O}))))),i.createElement(Qo,{copyrights:m.copyrights,writers:m.writers,tone:n}))))}));Xo.displayName="Lyrics";const Zo=Xo,el=(0,Hr.A)("div",{target:"e11wq35v1"})("align-items:center;color:",(({tone:e})=>e&&Zr.Tj[e]?Zr.Tj[e][1]:"var(--tempo-colors-text-neutral-primary-default)"),";display:flex;flex-direction:column;justify-content:center;"),tl=(0,so.Bv)(J.DZ,{baseStyle:{fontSize:"18px",fontWeight:"600",lineHeight:"21px",margintop:"32px"}}),nl=(0,Hr.A)("div",{target:"e11wq35v0"})({name:"jt4u7l",styles:"font-size:14px;font-weight:400;line-height:17px;margin-top:16px"});var sl;const il=({tone:e})=>i.createElement(el,{tone:e},sl||(sl=i.createElement(qt.i,{size:"medium",scale:3})),i.createElement(tl,null,(0,W.AP)("errormessage_title_networkissue_web")),i.createElement(nl,null,(0,W.AP)("errormessage_text_cantconnecttointernettryagain_web")));var al=n("CTxd");const rl=(0,Hr.A)("div",{target:"e8v5vjq4"})({name:"4pmze7",styles:"align-items:center;bottom:0;display:flex;justify-content:center;left:0;position:absolute;right:0;top:0"});var ol={name:"162lsnr",styles:"padding-left:0;flex:1"};const ll=(0,Hr.A)("div",{target:"e8v5vjq3"})("align-items:center;display:flex;flex:0.4;height:100%;justify-content:center;padding-top:16px;@media only screen and (max-width: 990px){display:none;}",(({hasLyrics:e})=>!e&&ol),";"),cl=(0,Hr.A)(al.Ay,{target:"e8v5vjq2"})({name:"1opi64",styles:"background-color:transparent!important;border-radius:16px;box-shadow:none;display:flex;filter:drop-shadow(0 5.2392px 20.9569px rgb(0 0 0 / 10%)) drop-shadow(0 20.9569px 41.9137px rgb(0 0 0 / 10%));height:28vw;max-height:100%;min-height:300px;min-width:300px;width:28vw;@media screen and (min-aspect-ratio: 5 / 3){height:46.7vh;width:46.7vh;}&:hover{box-shadow:none;}& img{height:100%;width:100%;}"}),dl=(0,Hr.A)("div",{target:"e8v5vjq1"})({name:"m5l2fw",styles:"flex:0.6;height:100%;padding-top:84px;position:relative;width:100%;@media only screen and (max-width: 990px){flex:1;}"}),ul=(0,Hr.A)("div",{target:"e8v5vjq0"})("bottom:32px;display:flex;justify-content:center;left:0;position:absolute;right:0;button{-webkit-app-region:no-drag;border-color:",(({tone:e})=>e===Zr.DP.white||e===Zr.DP.acid||e===Zr.DP.flame||e===Zr.DP.jellyfish||e===Zr.DP.algae?"#000000":"#FFFFFF"),";color:",(({tone:e})=>e===Zr.DP.white||e===Zr.DP.acid||e===Zr.DP.flame||e===Zr.DP.jellyfish||e===Zr.DP.algae?"#000000":"#FFFFFF"),";&:hover{background-color:",(({tone:e})=>e===Zr.DP.white||e===Zr.DP.acid||e===Zr.DP.flame||e===Zr.DP.jellyfish||e===Zr.DP.algae?"rgba(0 0 0 / 25%)":"rgba(255 255 255 / 25%)"),";}&:focus::before{border-color:",(({tone:e})=>e===Zr.DP.white||e===Zr.DP.acid||e===Zr.DP.flame||e===Zr.DP.jellyfish||e===Zr.DP.algae?"#000000":"#FFFFFF"),";}}"),pl=i.forwardRef((({tone:e},t)=>{const{trackId:n,hasLyrics:s,lyrics:r,error:o,cover:l,loading:c}=Ao(),{autoScroll:d,setAutoScroll:u,position:p,activeLyricIndex:m}=vo(),h=uo(n),{isSync:g}=r,y=(0,i.useRef)(null),[f,A]=(0,i.useState)(!1),_=(0,a.d4)((e=>e.player.music.trackTitle)),E=(0,i.useCallback)((()=>{A((e=>{const t=!e;return h({action:{type:t?"click_translate":"click_untranslate"},type:r.isSync?"synchro":"full_text"}),t}))}),[r.isSync,h]);return(0,i.useImperativeHandle)(t,(()=>({scrollToTop:()=>null,scrollToLine:()=>null,clearAutoScrollAnimation:()=>null,...y.current}))),c?null:o?i.createElement(rl,null,i.createElement(il,{tone:e})):i.createElement(rl,null,i.createElement(ll,{hasLyrics:s},i.createElement(cl,{type:kt.Ay.Album,alt:_,urls:l,isExplicit:l.explicitStatus})),s&&i.createElement(dl,null,i.createElement(Zo,{ref:y,isSynchro:g,lyrics:r,activeIndex:m,autoScroll:d,position:p,onAutoScrollChange:u,tone:e,showTranslatedLyrics:f}),r.hasTranslation&&i.createElement(ul,{tone:e},i.createElement(ue.$n,{onClick:E,"aria-label":f?(0,W.AP)("lyrics_action_withouttranslation_web"):(0,W.AP)("lyrics_action_withtranslation_web"),variant:"outline"},f?(0,W.AP)("lyrics_action_withouttranslation_web"):(0,W.AP)("lyrics_action_withtranslation_web")))))}));pl.displayName="LyricsContent";const ml=pl,hl=(0,Hr.A)("div",{target:"e1wal9j60"})("display:flex;height:100%;position:relative;",(({tone:e})=>Zr.Tj[e]&&(0,Yo.AH)("background:",Zr.Tj[e][0],";","")),";");var gl,yl=n("i2Ew");const fl=()=>{const{lyrics:{hasTranslation:e,isSync:t},handleClose:n,trackId:s,isReportProblemOpen:r}=Ao(),[o,l]=(0,i.useState)(),c=(0,a.d4)((e=>e.user.COUNTRY)),d=(0,i.useCallback)((()=>{o&&(yo.logProblem(s,t,o,c),l(void 0),u())}),[t,n,o,s]),u=(0,i.useCallback)((()=>{l(void 0),n()}),[n]),p=(0,i.useMemo)((()=>[t&&{value:go.PROBLEM_SYNCHRONIZATION,label:(0,W.AP)("lyricstranslation_text_errorinlyricssyncronization_web")},{value:go.PROBLEM_TYPO,label:(0,W.AP)("lyricstranslation_text_typoinlyrics_web")},{value:go.PROBLEM_MATCHING,label:(0,W.AP)("lyricstranslation_text_lyricsdonotmatchtrack_web")},{value:go.PROBLEM_LANGUAGE,label:(0,W.AP)("lyricstranslation_text_languageisincorrect_web")},e&&{value:go.PROBLEM_TRANSLATION,label:(0,W.AP)("lyricstranslation_text_translationisincorrect_web")}].filter(Boolean)),[t,e]);return i.createElement(R.aF,{isOpen:r,onClose:u,isCentered:!0},gl||(gl=i.createElement(L.mH,null)),i.createElement(L.$m,null,i.createElement(L.rQ,{textAlign:"center"},(0,W.AP)("lyricstranslation_title_reportaproblem_web")),i.createElement(L.cw,null,i.createElement(yl.z6,{onChange:e=>{l(e)},value:o},i.createElement(J.BJ,{direction:"column",spacing:4,textAlign:"left"},p.map((({value:e,label:t})=>i.createElement(yl.sx,{key:e,value:e,spacing:{base:6,sm:8,md:4}},t)))))),i.createElement(R.jl,null,i.createElement(ue.$n,{variant:"outline",onClick:u},(0,W.AP)("generic_action_cancel_web")),i.createElement(ue.$n,{onClick:d,disabled:!o},(0,W.AP)("Valider")))))},Al=({player:e})=>e.ui.tone;var _l;const El=()=>{const e=(0,i.useRef)(null),t=(0,i.useRef)(null),n=(0,a.d4)(Al),s=(0,i.useMemo)((()=>n===Zr.DP.default&&e.current?e.current:(e.current=n,n)),[n]);return i.createElement(_o,{lyricsContentRef:t},i.createElement(hl,{tone:s},i.createElement(Co,{tone:s}),i.createElement(ml,{ref:t,tone:s}),_.A.isAllowed("lyrics_report_problem")&&(_l||(_l=i.createElement(fl,null)))))};var vl,bl;class Sl extends i.Component{constructor(e){super(e),this._onClose=this._onClose.bind(this),this._onBackToQueuelist=this._onBackToQueuelist.bind(this),this._onKeyUp=this._onKeyUp.bind(this)}componentDidMount(){window.addEventListener("keyup",this._onKeyUp)}componentDidUpdate(e){this.props.location!==e.location&&this._onClose()}componentWillUnmount(){window.removeEventListener("keyup",this._onKeyUp)}render(){const{playerFull:e,playerQueuelist:t,playerLyrics:n}=this.props;return t||n?i.createElement(Y.N,null,e&&i.createElement(V.P.div,{initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{ease:"easeInOut",duration:.4},onAnimationStart:({y:e})=>{"100%"===e&&ra(!0)},onAnimationComplete:({y:e})=>{0===e?ra(!1):(this.props.setPlayerQueuelist(!1),this.props.setPlayerLyrics(!1))},className:(0,r.A)("player-lyrics-full",{"player-full":t})},t&&!n&&(vl||(vl=i.createElement(Qr,null))),n&&(bl||(bl=i.createElement(El,null))))):null}_onBackToQueuelist(){this.props.setPlayerLyrics(!1)}_onClose(){this.props.setPlayerFull(!1)}_onKeyUp(e){"Escape"===e.key&&(this.props.playerLyrics&&this.props.playerQueuelist?this.props.setPlayerLyrics(!1):this.props.setPlayerFull(!1))}}const kl=(0,oe.y)((0,a.Ng)((({player:e})=>({playerFull:e.config.playerFull,playerQueuelist:e.config.playerQueuelist,playerLyrics:e.config.playerLyrics})),{setPlayerFull:ia.no,setPlayerQueuelist:ia.PV,setPlayerLyrics:ia.IG})(Sl));var Tl,Cl=n("RvOg");const wl=()=>{const e=(0,a.d4)((e=>e.player.music.trackDuration));return i.createElement(ue.K0,{variant:"ghost","aria-label":(0,W.AP)("Retour rapide de 30 secondes"),onClick:()=>{const t=(us.Ay.getPosition()-30)/e;us.Ay.control.seek(t)},icon:Tl||(Tl=i.createElement(Cl.I,null)),size:"small","data-testid":"backward_30"})};var Il,xl=n("0BT7");const Pl=()=>{const e=(0,a.d4)((e=>e.player.music.trackDuration));return i.createElement(ue.K0,{variant:"ghost","aria-label":(0,W.AP)("Avance rapide de 30 secondes"),"data-testid":"forward_30",onClick:()=>{const t=(us.Ay.getPosition()+30)/e;t>=1?us.Ay.control.nextSong():us.Ay.control.seek(t)},icon:Il||(Il=i.createElement(xl.Y,null)),size:"small"})};var Nl=n("79CY");const Rl=({trackId:e})=>(0,rr.G)(ga.Cu).like?i.createElement("div",{className:"preview-action"},i.createElement("ul",{className:"svg-icon-group"},i.createElement("li",{className:"svg-icon-group-item"},i.createElement(pa.A,{className:"svg-icon-group-btn",context:{ID:e,TYPE:"player"},id:e,tooltip:!0,type:kt.Ay.Song})))):null,Ll=e=>e.player.music.mediaType,Dl=({track:e})=>{const t=(0,rr.G)(Ll);return i.createElement("div",{className:"preview-thumbnail","data-testid":"content_preview_item_cover"},i.createElement(lt.A,{type:t===hr.zu.EPISODE?kt.Ay.Episode:kt.Ay.Album,height:40,width:40,data:e,coverLink:!1}))},Ol=({track:e,trackArtists:t,trackTitle:n})=>{const s=(0,rr.G)(ga.Cu),a=xr({playerUI:s,track:e});return i.createElement("div",{className:"preview-heading","data-testid":"content_preview_item_title"},i.createElement(di,null,a?i.createElement(Ue.A,{className:"preview-link",to:a},n):n," · ",t.map(((e,t)=>{const n=Pr({playerUI:s},e);return[t>0?", ":"",null===n?e.ART_NAME:i.createElement(Ue.A,{className:"preview-link",key:e.ART_ID,to:n},e.ART_NAME)]}))))},Ml=({type:e})=>{const t=(0,rr.G)((t=>"prev"===e?(e=>e.player.music.trackPrev)(t):(e=>e.player.music.trackNext)(t))),n=(0,rr.G)((t=>"prev"===e?(0,wr.hN)(t):(0,wr.VX)(t))),s=(0,rr.G)((t=>"prev"===e?(0,wr.$7)(t):(0,wr.b3)(t))),a=String(t.SNG_ID_ORIGIN||t[us.Ay.getMediaId(t)]);return i.createElement("div",{className:"player-overlay-preview","data-testid":"content_preview_tooltip"},i.createElement(Dl,{track:t}),i.createElement(Ol,{track:t,trackArtists:n,trackTitle:s}),i.createElement(Rl,{trackId:a}))};var Ul,Fl,zl=n("BcXB");const ql=()=>{const e=(0,a.d4)(zl.m5),t=(0,a.d4)(zl.kQ),n=(0,a.d4)((e=>(0,ga.Cu)(e))),s=us.Ay.getPrevSong()&&!us.Ay.isRadio()&&t!==hr.EV.SINGLE,r=i.createElement(ue.K0,{icon:Ul||(Ul=i.createElement(Nl.w,null)),isDisabled:!e||!n.prev,onClick:()=>{us.Ay.control.prevSong()},variant:"ghost","aria-label":(0,W.AP)("Précédent"),size:"small","data-testid":"previous_track_button"});return s?i.createElement("div",null,i.createElement(tr.AM,{openDelay:500,trigger:"hover",isLazy:!0},i.createElement(tr.Wv,null,r),Fl||(Fl=i.createElement(tr.hl,{w:"auto"},i.createElement(tr.Rp,null),i.createElement(tr.ej,{p:0},i.createElement(Ml,{type:"prev"})))))):r};var Bl,Gl,Ql,Hl,Yl=n("slbf"),Vl=n("dShs"),jl=n("X/L1"),Wl=n("tew7");const Kl=({isPaused:e})=>{const{playerUI:t,loading:n,isChromecastCasting:s}=(0,a.d4)((e=>({playerUI:(0,ga.Cu)(e),loading:e.player.control.loading,isChromecastCasting:e.player.chromecast.casting})));return s&&n?Bl||(Bl=i.createElement(Yl.A,{className:"animate-spin",size:"auto"})):e?Gl||(Gl=i.createElement(Vl.S,null)):t.stop?Ql||(Ql=i.createElement(jl.w,null)):Hl||(Hl=i.createElement(Wl.I,null))};var $l=n("Vynx"),Jl=n("JFzq");const Xl=()=>{const{paused:e,playing:t,playerUI:n,loading:s,isConnected:r,canPlay:l,canPause:c}=(0,a.d4)((e=>({paused:e.player.control.paused,playing:e.player.control.playing,loading:e.player.control.loading,playerUI:(0,ga.Cu)(e),isChromecastCasting:e.player.chromecast.casting,isConnected:(0,k.UJ)(e.user),canPlay:(0,zl.v_)(e),canPause:(0,zl.J2)(e)}))),{trackEvent:d}=(0,o.z1)(),u=e&&!t||!e&&!t,p=n.stop?(0,W.AP)("Stop"):(0,W.AP)("Pause"),m=u?(0,W.AP)("Play"):p;return i.createElement(ue.K0,{icon:i.createElement(Kl,{isPaused:u}),onClick:()=>{if(u?us.Ay.control.play():n.pause?us.Ay.control.pause():us.Ay.control.stop(),$l.A.intent(u?$l.A.TIME_TO_PLAY:$l.A.TIME_TO_PAUSE),!r&&u){const e=Jl.Ay.getPageName();d({eventaction:`click-play-${e}_${us.Ay.getMediaType()}`,event:"click",eventcategory:e,eventlabel:"deezer-player"})}},disabled:!c||!l||s,"aria-label":m,size:"small","data-testid":"play_button_"+(u?"play":n.stop?"stop":"pause")})};var Zl,ec,tc=n("M9Yy");const nc=()=>{const e=(0,a.d4)(zl.m$),t=(0,a.d4)(zl.kQ),n=(0,a.d4)((e=>(0,ga.Cu)(e))),s=us.Ay.getNextSong()&&!us.Ay.isRadio()&&t!==hr.EV.SINGLE,r=i.createElement(ue.K0,{icon:Zl||(Zl=i.createElement(tc.E,null)),isDisabled:!e||!n.next,onClick:()=>{us.Ay.control.nextSong()},variant:"ghost","aria-label":(0,W.AP)("Suivant"),size:"small","data-testid":"next_track_button"});return s?i.createElement("div",null,i.createElement(tr.AM,{openDelay:500,trigger:"hover",isLazy:!0},i.createElement(tr.Wv,null,r),ec||(ec=i.createElement(tr.hl,{w:"auto"},i.createElement(tr.Rp,null),i.createElement(tr.ej,{p:0},i.createElement(Ml,{type:"next"})))))):r},sc=()=>{const{playerUI:e,shuffle:t}=(0,a.d4)((e=>({playerUI:(0,ga.Cu)(e),shuffle:e.player.control.shuffle})));let n="";e.shuffle&&(n=t?(0,W.AP)("Désactiver le mode aléatoire"):(0,W.AP)("Activer le mode aléatoire"));const s=e.chromecastActive||!e.shuffle,r=t&&e.shuffle?"icon.accent.primary.default":"icon.neutral.primary.default",o=i.createElement(ue.K0,{disabled:s,"aria-label":n,onClick:()=>{us.Ay.control.setShuffle(!t)},icon:i.createElement(fr.R,{color:r}),variant:"ghost",size:"small","data-testid":"shuffle_play_button_"+(t?"on":"off")});return s?o:i.createElement(Ws.m,{label:n},o)};var ic=n("cx5i"),ac=n("AfR/");const rc=()=>{const{playerUI:e,repeat:t}=(0,a.d4)((e=>({playerUI:(0,ga.Cu)(e),repeat:e.player.control.repeat})));let n="";if(e.repeat)switch(n=(0,W.AP)("Répéter"),t){case hr.EV.OFF:n=(0,W.AP)("Réécouter tous les titres");break;case hr.EV.ALL:n=(0,W.AP)("Réécouter ce titre");break;case hr.EV.SINGLE:n=(0,W.AP)("Désactiver la fonction Répéter")}const s=!e.repeat,r=t>0&&e.repeat?"icon.accent.primary.default":"icon.neutral.primary.default",o=i.createElement(ue.K0,{isDisabled:s,"aria-label":n,onClick:()=>{us.Ay.control.setRepeat(t===hr.EV.SINGLE?hr.EV.OFF:t+1)},variant:"ghost",size:"small",icon:t===hr.EV.SINGLE?i.createElement(ic.Z,{color:r}):i.createElement(ac.H,{color:r}),"data-testid":"repeat_button_"+(t===hr.EV.OFF?"off":t===hr.EV.ALL?"all":"single")});return s?o:i.createElement(Ws.m,{label:n},o)};var oc=n("17x9");const lc=e=>i.cloneElement(e.children,{className:(0,r.A)(e.children.props.className,"mousetrap")});lc.propType={children:n.n(oc)().element.isRequired};const cc=lc;var dc;class uc extends i.Component{constructor(e){super(e),this._onKeyUp=this._onKeyUp.bind(this),this._onMouseDown=this._onMouseDown.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onChange=this._onChange.bind(this),this._showTooltip=this._showTooltip.bind(this),this._hideTooltip=this._hideTooltip.bind(this),this.isDragging=!1,this.state={position:!1,isActive:!1,tooltipOffset:null,tooltipValue:0},this._sliderTrackRef=i.createRef()}shouldComponentUpdate(e,t){return e.value!==this.props.value||!1!==t.position||t.isActive!==this.state.isActive||t.tooltipOffset!==this.state.tooltipOffset||t.tooltipValue!==this.state.tooltipValue}render(){const{max:e,min:t,value:n,step:a,disabled:o,tooltip:l,autoHide:c,tone:d,testId:u,counter:p,hasColorPicking:m}=this.props,{position:h,isActive:g}=this.state,y=Number(this.isDragging&&!1!==h?h:n),f=100*(y-t)/(e-t)||0,A={className:(0,r.A)("slider",{"slider-autohide":c,"is-active":g,"has-counter":p}),onMouseEnter:c?()=>this._setActive(!0):null,onMouseLeave:c?()=>this._setActive(!1):null,onFocus:c?()=>this._setActive(!0):null,onBlur:c?()=>this._setActive(!1):null},_=this._getSliderTrackStyle(f),E=(0,r.A)("slider-track-active",{[`color-${d}`]:m});return i.createElement(J.az,(0,s.A)({},A,{py:"spacing.2xs",height:"auto"}),this._renderCurrentValue(y),i.createElement("div",{className:"slider-track",ref:this._sliderTrackRef},dc||(dc=i.createElement("div",{className:"slider-track-default"})),i.createElement("div",{className:E,style:_}),i.createElement(cc,null,i.createElement("input",{className:"slider-track-input",type:"range",step:a,min:t,max:e,value:y,disabled:o,"aria-valuemin":t,"aria-valuemax":e,"aria-valuenow":y,onMouseDown:this._onMouseDown,onMouseUp:this._onMouseUp,onKeyUp:this._onKeyUp,onChange:this._onChange,onMouseMove:l?this._showTooltip:null,onMouseOut:l?this._hideTooltip:null,"data-testid":u})),this._renderTooltip()),this._renderMaxValue())}_renderCurrentValue(e){const{counter:t}=this.props;if(!1===t)return null;const n=this._formatValue(e);return i.createElement(J.az,{pr:"spacing.l"},i.createElement(J.EY,{variant:"body.2xs.default",color:"text.neutral.primary.default","data-testid":"elapsed_time"},n))}_renderMaxValue(){const{counter:e,max:t}=this.props;if(!1===e)return null;const n=this._formatValue(t);return i.createElement(J.az,{pl:"spacing.l",position:"absolute",right:"0"},i.createElement(J.EY,{variant:"body.2xs.default",color:"text.neutral.primary.default","data-testid":"remaining_time"},n))}_renderTooltip(){const{tooltipOffset:e,tooltipValue:t}=this.state;if(null===e)return null;const n=this._formatValue(t),s=this._getTooltipStyle(e);return i.createElement("div",{className:"slider-tooltip",style:s},i.createElement(J.EY,{variant:"body.2xs.default"},n))}_onMouseDown(){this.isDragging=!0}_onMouseUp(e){this.props.onChange(e.target.value);const t={position:!1};if(this.props.tooltip){const n=e.target.getBoundingClientRect(),s=Math.floor(n.left),i=Math.floor(n.width);(e.clientX<s||e.clientX>s+i)&&(t.tooltipOffset=null)}this.setState(t,(()=>{this.isDragging=!1}))}_onKeyUp(e){-1!==[33,34,35,36,37,38,39,40].indexOf(e.keyCode)&&(this.props.onChange(e.target.value),this.setState({position:!1}))}_onChange({target:{value:e}}){this.props.onProgress(e),(this.isDragging||Number(e)!==this.props.min&&Number(e)!==this.props.max)&&this.setState({position:e})}_showTooltip(e){const t=this._sliderTrackRef.current.getBoundingClientRect(),n=Math.floor(t.left),s=Math.floor(t.width);let i=e.clientX-n;i<0&&(i=0),i>s&&(i=s);const a=this._getValueByCursorPosition(e.clientX);null!==this.state.tooltipOffset&&a===this.state.tooltipValue||this.setState({tooltipOffset:i,tooltipValue:a})}_hideTooltip(){this.setState({tooltipOffset:null})}_formatValue(e){const{counter:t}=this.props;return"function"==typeof t?t(e):e}_setActive(e){this.setState({isActive:e})}_getSliderTrackStyle(e){return{width:`${e}%`,willChange:"width"}}_getTooltipStyle(e){return{transform:`translate3d(${e}px, 0px, 0px)`,WebkitTransform:`translate3d(${e}px, 0px, 0px)`,willChange:"transform"}}_getValueByCursorPosition(e){const{min:t,max:n,step:s}=this.props,i=this._sliderTrackRef.current.getBoundingClientRect(),a=Math.floor(i.left),r=Math.floor(i.width);let o=e-a;o<0&&(o=0),o>r&&(o=r);const l=o/r*100/100,c=Math.round(l*(n*s/s)+t-l*t);return s>1&&c%s!=0?c-c%s:c}}uc.defaultProps={min:0,max:100,value:0,step:1,tone:(0,Zr.Q5)(),disabled:!1,counter:!0,tooltip:!1,autoHide:!1,onChange:()=>{},onProgress:()=>{},testId:null,hasColorPicking:!1};const pc=uc;var mc=n("s026");class hc extends i.Component{constructor(...e){super(...e),this.state={position:0},this._onPositionChanged=(e,t)=>{this.setState({position:t})},this._onSeek=e=>{const{duration:t}=this.props;e>=t?us.Ay.control.nextSong():us.Ay.isPlaying()||us.Ay.isPaused()?us.Ay.control.seek(e/t):(us.Ay.getTrackList()[0].OFFSET=e/t*t,us.Ay.control.play())}}componentDidMount(){A.A.subscribe(A.A.player.position,this._onPositionChanged)}componentWillUnmount(){A.A.unsubscribe(A.A.player.position,this._onPositionChanged)}render(){const{position:e}=this.state,{playerUI:t,duration:n,seekAllowed:s,tone:a}=this.props;return t.seek?i.createElement(pc,{max:n,value:e,counter:mc.A,onChange:this._onSeek,disabled:!s,tooltip:!0,autoHide:!0,tone:a,testId:"progress_bar",hasColorPicking:!0}):null}}const gc=(0,a.Ng)((e=>({duration:e.player.music.trackDuration,playerUI:(0,ga.Cu)(e),seekAllowed:(0,zl.rt)(e),tone:Al(e)})))(hc);var yc=n("g1Fm"),fc=n("wZBD");const Ac=()=>{const{uiType:e,isUpnext:t,isFlow:n}=(0,a.d4)((e=>({uiType:(0,ga.ip)(e),isUpnext:e.player.config.isUpnext,isFlow:e.player.config.isFlow})));let s=(0,W.AP)("MIX");return e===ha.U.AD||e===ha.U.TRITON_AD?s=(0,W.AP)("PUBLICITÉ"):e===ha.U.LIVESTREAM?s=(0,W.AP)("EN DIRECT"):t?s=(0,W.AP)("RECOMMANDÉ"):n&&(s=(0,W.AP)("FLOW")),i.createElement(fc.J,{size:"small","data-testid":"listening_context_label"},(0,yc.A)(s,!0))};var _c,Ec,vc,bc,Sc,kc,Tc,Cc,wc;const Ic=()=>{const e=(0,a.d4)((e=>(0,ga.Cu)(e)));return i.createElement(J.so,{width:"33%",px:"spacing.l",direction:"column",gap:"spacing.xs",dir:"ltr"},i.createElement(J.so,{justifyContent:"center",alignItems:"center",position:"relative"},e.label&&i.createElement(J.az,{left:"0",top:"50%",transform:"translateY(-50%)",position:"absolute",opacity:{md:"100%",base:"0%"}},_c||(_c=i.createElement(Ac,null))),i.createElement(zi.e,{size:"small",gap:"spacing.s",spacing:0},e.skipBackwards?Ec||(Ec=i.createElement(wl,null)):vc||(vc=i.createElement(sc,null)),bc||(bc=i.createElement(ql,null)),Sc||(Sc=i.createElement(Xl,null)),kc||(kc=i.createElement(nc,null)),e.skipForwards?Tc||(Tc=i.createElement(Pl,null)):Cc||(Cc=i.createElement(rc,null)))),wc||(wc=i.createElement(gc,null)))};var xc=n("GOtF"),Pc=n("+Whx");const Nc=(0,Hr.A)(Ue.A,{target:"ely5kss1"})({name:"tadcwa",styles:"&:hover{text-decoration:underline;}"}),Rc=(0,Hr.A)("a",{target:"ely5kss0"})({name:"tadcwa",styles:"&:hover{text-decoration:underline;}"}),Lc=(0,xc.A)((()=>{const{playerUI:e,trackTitle:t,uiType:n,track:s}=(0,a.d4)((e=>({playerUI:(0,ga.Cu)(e),trackTitle:e.player.music.trackTitle,uiType:(0,ga.ip)(e),track:e.player.music.track}))),{audioBreakState:r}=(0,Pc.ZQ)();if(n===ha.U.AD){const e=window.sasAudioConfig||{},t=e.text,n=decodeURIComponent(e.url),s=e=>{e.preventDefault(),e.stopPropagation(),/^http/.test(n)&&open(n)};return t?/^http/.test(n)?i.createElement(Rc,{href:n,onClick:s},t):i.createElement(Nc,{to:n,onClick:s},t):null}if(n===ha.U.TRITON_AD){const e=e=>{e.preventDefault(),e.stopPropagation(),r.cta.tracking_url.map((e=>{fetch(e)})),/^http/.test(r.cta.url)&&open(r.cta.url)};return i.createElement(Nc,{to:r.cta.url,onClick:e},null!==r.content.title?r.content.title:(0,W.AP)("En savoir plus"))}const o=xr({playerUI:e,track:s});return o?i.createElement(Nc,{to:o},t):t})),Dc=(0,Hr.A)(Ue.A,{target:"erlh4i50"})({name:"tadcwa",styles:"&:hover{text-decoration:underline;}"}),Oc=()=>{const{trackArtists:e,playerUI:t}=(0,a.d4)((e=>({trackArtists:e.player.music.trackArtists,playerUI:(0,ga.Cu)(e)})));return e.map(((e,n)=>{const s=Pr({playerUI:t},e);return[n>0?", ":"",s?i.createElement(Dc,{className:"track-link",key:e.ART_ID,to:s},e.ART_NAME):e.ART_NAME]}))};var Mc;const Uc=()=>{const{playerUI:e,track:t,id:n,mediaType:s,userId:r,context:o}=(0,a.d4)((e=>({playerUI:(0,ga.Cu)(e),id:e.player.music.id,track:e.player.music.track,mediaType:e.player.music.mediaType,userId:e.user.id,context:e.player.music.context})));if(s===hr.zu.LIVE_STREAM&&t.EXTERNAL)return null;const l={anchor:e=>i.createElement(ue.K0,{"aria-label":"Open context menu",variant:"ghost",isActive:e,_active:{color:"icon.accent.primary.default",bg:"transparent"},icon:Mc||(Mc=i.createElement($i.c,null)),size:"small"}),context:{ID:r,TYPE:"player"},data:{SONG:t,PLAYLIST_ID:o.ID},forceShowPlaylists:!0,id:n,placement:"top"},c=String(t.SNG_ID_ORIGIN||n);return i.createElement(zi.e,{size:"small",spacing:"spacing.xs",alignItems:"center"},e.like&&i.createElement(pa.A,{type:kt.Ay.Song,context:{ID:c,TYPE:"player",CONTEXT_ID:t.SPONSORED?"sponsored=true":void 0},tooltip:!0,id:c}),e.contextMenu&&i.createElement("div",{"data-testid":"add_to_playlist_button"},i.createElement(ma.A,l)))};var Fc,zc,qc,Bc;const Gc=()=>{const{playerUI:e,mediaType:t,isExplicit:n,uiType:s,currentTrack:r,isExplicitCover:o}=(0,a.d4)((e=>({playerUI:(0,ga.Cu)(e),mediaType:e.player.music.mediaType,isExplicit:e.player.music.isExplicit,isExplicitCover:(0,Cr.cV)(e.player.music.track),uiType:(0,ga.ip)(e),currentTrack:e.player.music})));return i.createElement(J.so,{width:"33%",alignItems:"center"},e.cover&&i.createElement(J.az,{boxSize:"size.xl","data-testid":"item_cover",minWidth:"size.xl"},i.createElement(bi.A,{src:r.cover,alt:r.trackTitle,isExplicitCover:o})),i.createElement(J.so,{alignItems:"flex-start",minWidth:0},i.createElement(J.so,{direction:"column",ms:"spacing.s",minWidth:0},e.title&&i.createElement(J.so,{alignItems:"center",gap:"spacing.xs"},Fc||(Fc=i.createElement(di,null,i.createElement(J.EY,{variant:"body.l.default",color:"text.neutral.primary.default","data-testid":"item_title"},i.createElement(Lc,null)))),n&&s!==ha.U.AD&&s!==ha.U.TRITON_AD&&(zc||(zc=i.createElement(ua.A,{size:"small"})))),e.subTitle&&(qc||(qc=i.createElement(di,null,i.createElement(J.EY,{variant:"body.s.default",color:"text.neutral.secondary.default","data-testid":"item_subtitle"},i.createElement(Oc,null))))))),t&&(Bc||(Bc=i.createElement(J.so,{ms:"spacing.l"},i.createElement(Uc,null)))))};var Qc,Hc,Yc,Vc;class jc extends i.Component{constructor(e){super(e),this._onAudioQualityUpdate=this._onAudioQualityUpdate.bind(this),this._onTriforceUpdate=this._onTriforceUpdate.bind(this),this._onDiscoverClick=this._onDiscoverClick.bind(this)}render(){return i.createElement(J.az,{className:"player-overlay-settings",fontSize:"sm","data-testid":"audio_settings_menu"},this._renderAudioQuality(),i.createElement("ul",{className:"setting-menu"},this._renderNormalized(),this._renderTriforce()))}_renderAudioQuality(){const e=!0===this.props.isCasting?(0,W.AP)("hificast_title_audioqualityondevices_web"):(0,W.AP)("Qualité Audio"),t=this._getCurrentAudioQuality();return i.createElement(yl.z6,{onChange:this._onAudioQualityUpdate,value:t},i.createElement("ul",{className:"setting-menu"},i.createElement("li",{className:"setting-item"},i.createElement("div",{className:"setting-label-text","data-testid":"audio_setting_title"},e)),this._renderAudioQualityStandard(),this._renderAudioQualityHigh(),this._renderAudioQualityLossless()))}_renderAudioQualityStandard(){const{hasHqAudioRight:e,hasLosslessAudioRight:t}=this.props,n=!t&&!e,s=this._getCurrentAudioQuality()===Ir.en.STANDARD;return i.createElement("li",{className:"setting-item"},i.createElement("label",{className:"setting-label","data-testid":"quality_standard_title"},i.createElement("div",{className:"setting-label-text"},(0,W.AP)("Standard")),!n&&(Qc||(Qc=i.createElement("div",{className:"setting-label-info"},"128kb/s"))),i.createElement("div",{className:"setting-label-control"},i.createElement(yl.sx,{as:"span",value:Ir.en.STANDARD,"data-testid":"quality_standard_button_"+(s?"on":"off")}))))}_renderAudioQualityHigh(){const{hasHqAudioRight:e,conversionEntrypoints:t}=this.props;if(!e&&!t.AUDIO_SETTING_PREMIUM)return null;const n=this._getCurrentAudioQuality()===Ir.en.HIGH;return e?i.createElement("li",{className:"setting-item"},i.createElement("label",{className:"setting-label","data-testid":"quality_hq_title"},i.createElement("div",{className:"setting-label-text"},(0,W.AP)("Supérieure")),Hc||(Hc=i.createElement("div",{className:"setting-label-info"},"320kb/s")),i.createElement("div",{className:"setting-label-control"},i.createElement(yl.sx,{as:"span",value:Ir.en.HIGH,"data-testid":"quality_hq_button_"+(n?"on":"off")})))):i.createElement("li",{className:"setting-item"},i.createElement(Mt.A,null,i.createElement(Ue.A,{target:"_blank",to:(0,tn.hY)(t.AUDIO_SETTING_PREMIUM.action),className:"setting-label"},i.createElement("div",{className:"setting-label-text"},(0,W.AP)("audioquality_title_highfidelity_web")),i.createElement("div",{className:"setting-label-control"},i.createElement("span",{className:"setting-discover-link"},t.AUDIO_SETTING_PREMIUM.label,Yc||(Yc=i.createElement(Ut.A,{size:"14"})))))))}_renderAudioQualityLossless(){const{conversionEntrypoints:e,hasLosslessAudioRight:t,hasHqAudioRight:n}=this.props;if(!t&&!e.AUDIO_SETTING_HIFI||!n)return null;if(!us.Ay.html5.flac)return i.createElement("li",{className:"setting-item disabled"},i.createElement("div",{className:"setting-label-text"},(0,W.AP)("audioquality_title_highfidelity_web")),i.createElement("div",{className:"setting-notice"},(0,W.AP)("infomessage_text_notsupportedbybrowserusechromefirefoxedge_web")));const s=this._getCurrentAudioQuality()===Ir.en.LOSSLESS;return i.createElement("li",{className:"setting-item"},i.createElement("label",{className:"setting-label","data-testid":"quality_loseless_title"},i.createElement("div",{className:"setting-label-text"},(0,W.AP)("audioquality_title_highfidelity_web")),i.createElement("div",{className:"setting-label-control"},t?i.createElement(yl.sx,{as:"span",value:Ir.en.LOSSLESS,"data-testid":"quality_loseless_button_"+(s?"on":"off")}):i.createElement(Mt.A,null,i.createElement(Ue.A,{className:"setting-discover-link",to:(0,tn.hY)(e.AUDIO_SETTING_HIFI.action),target:"_blank"},e.AUDIO_SETTING_HIFI.label,Vc||(Vc=i.createElement(Ut.A,null)))))),i.createElement("div",{className:"setting-notice"},(0,W.AP)("audiosettings_text_highfidelitydescription_web")))}_renderNormalized(){return _.A.isAllowed("volume_normalization")?i.createElement("li",{className:"setting-item"},i.createElement("label",{className:"setting-label"},i.createElement("div",{className:"setting-label-text","data-testid":"normalize_title"},(0,W.AP)("audiosettings_title_normalizeaudio_web")),i.createElement("div",{className:"setting-label-control"},i.createElement(zt.d,{as:"span","data-testid":"normalize_button_"+(this.props.isNormalized?"on":"off"),isChecked:this.props.isNormalized,onChange:this._onNormalizedUpdate}))),i.createElement("div",{className:"setting-notice","data-testid":"normalize_subtitle"},(0,W.AP)("audiosettings_text_normalizeaudiodescription_web"))):null}_renderTriforce(){return _.A.isAllowed("triforce_queuelist_ui")&&this.props.isPremium?i.createElement("li",{className:"setting-item"},i.createElement("label",{className:"setting-label"},i.createElement("div",{className:"setting-label-text","data-testid":"synchronised_title"},(0,W.AP)("Synchronisation de la file d'attente")),i.createElement("div",{className:"setting-label-control"},i.createElement(zt.d,{as:"span",isChecked:this.props.isTriforceEnabled,"data-testid":"synchronised_button_"+(this.props.isTriforceEnabled?"on":"off"),onChange:this._onTriforceUpdate}))),i.createElement("div",{className:"setting-notice","data-testid":"synchronised_subtitle"},(0,W.AP)("Le contenu de votre file d'attente reste le même sur tous les appareils où vous utilisez Deezer."))):null}_onAudioQualityUpdate(e){const t={site:{player_hq:e===Ir.en.HIGH||e===Ir.en.LOSSLESS}};!0===this.props.isCasting?t.site.cast_audio_quality=e:t.site.player_audio_quality=e,this.props.updateSettings(t),us.Ay.control.setAudioQuality(e)}_onNormalizedUpdate(e){if(!e.isTrusted)return void e.preventDefault();const t=e.target.checked;us.Ay.control.setNormalized(t),wt.A.set({site:{player_normalize:t}}),Ae.A.call({method:"log_central.log",data:{BATCH:[{channel:"feature_activation",params:{ts:Math.floor(Date.now()/1e3),state:t?"on":"off",feature:"normalization",os_based:!1}}]}})}_onTriforceUpdate(e){if(!e.isTrusted)return void e.preventDefault();const t=e.target.checked;this.props.updateSettings({site:{triforce:t}})}_onDiscoverClick(e){e.preventDefault(),(0,Tr.A)(e.target.href)}_getCurrentAudioQuality(){return this.props.isCasting?this.props.currentCastAudioQuality:this.props.currentAudioQuality}}const Wc={updateSettings:T.Xx},Kc=(0,a.Ng)((({user:e,player:t})=>({conversionEntrypoints:e.USER.ENTRYPOINTS,currentAudioQuality:e.currentAudioQuality,currentCastAudioQuality:e.currentCastAudioQuality,hasHqAudioRight:e.hasHqAudioRight,hasLosslessAudioRight:e.hasLosslessAudioRight,isPremium:(0,k.ki)(e),isTriforceEnabled:(0,k.Qi)(e),isCasting:t.chromecast.casting,isNormalized:(0,zl.mQ)({player:t})})),Wc)(jc);var $c,Jc,Xc=n("Ohse");const Zc=()=>{const[e,t]=(0,i.useState)(!1);return(0,i.useEffect)((()=>(A.A.subscribe(A.A.player.openAudioSettings,open),()=>A.A.unsubscribe(A.A.player.openAudioSettings,open))),[]),i.createElement(tr.AM,{placement:"top",isLazy:!0,onOpen:()=>t(!0),onClose:()=>t(!1)},i.createElement(tr.Wv,null,i.createElement(ue.K0,{"aria-label":(0,W.AP)("Audio"),size:"small",variant:"ghost",isActive:e,_active:{color:"icon.accent.primary.default",bg:"transparent"},icon:$c||($c=i.createElement(Xc.U,null)),"data-testid":"audio_settings_button"})),Jc||(Jc=i.createElement(tr.hl,{w:"auto"},i.createElement(tr.Rp,null),i.createElement(tr.ej,{p:0},i.createElement(Kc,null)))))};var ed=n("oxTq"),td=n("ITz4"),nd=n("mIO1");const sd=()=>{const e=(0,a.d4)(zl.yk),t=(0,a.d4)(zl.bE),n=(0,i.useCallback)((e=>{us.Ay.control.setVolume(Number(e/100),!0)}),[]);return i.createElement(pc,{min:0,max:100,step:1,value:e?0:Math.round(100*t),counter:!1,onProgress:n,testId:"volume_menu_bar"})};var id,ad,rd;const od=()=>{const e=(0,a.d4)(zl.yk),t=(0,a.d4)(ga.Cu),n=(0,i.useCallback)((()=>{us.Ay.control.mute(!e)}),[e]);return i.createElement(tr.AM,{placement:"top",trigger:"hover",isLazy:!0},i.createElement(tr.Wv,null,i.createElement(ue.K0,{"aria-label":"volume button",disabled:!t.volume,onClick:n,"data-testid":"volume_button_"+(e?"mute":"default"),icon:e?id||(id=i.createElement(td.V,null)):ad||(ad=i.createElement(nd.s,null)),variant:"ghost",isActive:e,_active:{color:"icon.accent.primary.default",bg:"transparent"},size:"small"})),rd||(rd=i.createElement(tr.hl,{w:"240px","data-testid":"volume_menu"},i.createElement(tr.Rp,null),i.createElement(tr.ej,null,i.createElement(sd,null)))))};var ld,cd,dd,ud;Yo.i7`
	0% {opacity: 1}
	50% {opacity: 0.2}
	100% {opacity: 1}
`;const pd=()=>{const e=(0,a.wA)(),{playerUI:t,context:n,isRadio:s,hasLyrics:r,playerLyrics:o,isOnline:l,trackArtists:c,track:d,id:u,list:p,playerQueuelist:m,playerFull:h,casting:g,connecting:y,active:f}=(0,a.d4)((e=>({playerUI:(0,ga.Cu)(e),context:e.player.music.context,isRadio:e.player.config.isRadio,hasLyrics:(0,wr.jk)(e),playerLyrics:e.player.config.playerLyrics,isOnline:e.app.online,trackArtists:e.player.music.trackArtists,track:e.player.music.track,id:e.player.music.id,list:e.player.music.list,playerQueuelist:e.player.config.playerQueuelist,playerFull:e.player.config.playerFull,connecting:e.player.chromecast.connecting,casting:e.player.chromecast.casting,active:e.player.chromecast.active}))),A=t.userFeedback&&n.TYPE&&(s||Gn.default.get("log_contexts")[n.TYPE]===kt.Ay.Smarttracklist),_=Gn.default.get("log_contexts")[n.TYPE]===kt.Ay.Flow||Gn.default.get("log_contexts")[n.TYPE]===kt.Ay.MultiFlow?(0,W.AP)("flowsettings_title_notsatisfiedwithyourflow_web"):(0,W.AP)("banfeatures_title_nothappywithyourmix_web"),E=t.lyrics&&r&&l;return i.createElement(zi.e,{size:"small",alignItems:"center",width:"33%",justifyContent:"flex-end",spacing:"spacing.xs"},A&&i.createElement(kr,{placement:"top",artistId:c.length>0?c[0].ART_ID:"0",context:n,trackId:String(d.SNG_ID_ORIGIN||u),title:_}),E&&i.createElement(Ws.m,{label:o?(0,W.AP)("lyrics_action_hidelyrics_web"):(0,W.AP)("Afficher les paroles")},i.createElement(ue.K0,{"data-testid":"lyrics_button",icon:ld||(ld=i.createElement(ca.c,null)),variant:"ghost",isActive:o,_active:{color:"icon.accent.primary.default",bg:"transparent"},onClick:()=>{e(o?(0,ia.no)(!1):(0,ia.IG)(!0)),us.Ay.isPaused()||us.Ay.isPlaying()||us.Ay.control.play()},"aria-label":o?(0,W.AP)("lyrics_action_hidelyrics_web"):(0,W.AP)("Afficher les paroles")})),t.queuelist&&i.createElement(ue.K0,{"data-testid":"queue_list_button","aria-label":"open queuelist",variant:"ghost",isActive:m,_active:{color:"icon.accent.primary.default",bg:"transparent"},isDisabled:!p.length,onClick:()=>{e(m?(0,ia.no)(!h):(0,ia.PV)(!0))},icon:cd||(cd=i.createElement(ed.j,null))}),!1,dd||(dd=i.createElement(od,null)),ud||(ud=i.createElement(Zc,null)))};var md=n("p2PB");var gd=n("qBrz"),yd=n("FvhZ"),fd=n("DFyM"),Ad=n("JPje");const _d={buffer:0,volume:0,repeat:0,shuffle:!1,mute:!1,playing:!1,paused:!1,loading:!1,hasPrev:!1,hasNext:!1,hasRepeat:!1,hasShuffle:!1,normalized:!0};var Ed=n("PIVb");const vd={available:!1,connecting:!1,casting:!1,loading:!1,active:!1,chunksInfo:{},skipLimited:!1};var bd=n("5LFp");const Sd={isRadio:!1,isUpnext:!1,isFlow:!1,isMyFlow:!1,isBlindTestMode:!1,playerType:"",playerFull:!1,playerQueuelist:!1,playerLyrics:!1};var kd=n("7+7Q"),Td=n("bAWj");const Cd={autoScroll:!0,hasLyrics:!1,metadata:{},isSync:!1,isLoading:!1,list:[]};let wd=function(e){return e.SET_TONE="components/Player/ui/SET_TONE",e}({});const Id={tone:(0,Zr.Q5)()};let Pd={statusExclamationMark:80,object:null,type:"no_restriction",init:function(){try{if(O.A.getState().user.id<=0||(0,k.jQ)(O.A.getState().user))return!1;if(O.A.getState().user.USER.OPTIONS.web_streaming&&0===O.A.getState().user.USER.OPTIONS.web_streaming_duration)return!1;Ae.A.call({method:"restriction.get",data:{},success:function(e){e&&(Pd.object=e,Math.round((new Date).getTime()/1e3)<Pd.object.date_end_discover?Pd.type="discovery_unlimited":(Pd.type="discovery",A.A.subscribe(A.A.player.updateRestrictTime,Pd.updateRestrictTime)))}})}catch(e){v.A.error(e)}return!0},updateRestrictTime:function(e,t){return Pd.object.time_left-=t,Pd.object.time_used+=t,Pd.object.percent=100*Pd.object.time_used/(Pd.object.time_used+Pd.object.time_left),Pd.object.percent=Math.min(Pd.object.percent,100),!0}};const Nd=Pd;var Rd=n("p/gB"),Ld=n("AY3M");const Dd=(0,Rd.Us)(kt.Ay.Album),Od=(0,Rd.Pe)(kt.Ay.Artist,Ld.sI),Md=(0,Rd.Pe)(kt.Ay.Playlist,Ld.lh),Ud=(0,Rd.Us)(kt.Ay.Episode),Fd=(0,Rd.Pe)(kt.Ay.User,Ld.N_),zd=(0,Rd.Pe)(kt.Ay.Album,Ld.LF),qd=(0,Rd.Pe)(kt.Ay.Artist,Ld.LF),Bd=(0,Rd.Pe)(kt.Ay.Playlist,Ld.LF),Gd=(0,Rd.Pe)(kt.Ay.Radio,Ld.LF),Qd=(0,Rd.Pe)(kt.Ay.Track,Ld.LF),Hd=(0,Rd.Us)(kt.Ay.Livestream),Yd=(0,Rd.Us)(kt.Ay.Playlist),Vd=(0,Rd.Pe)(kt.Ay.User,Ld.N_),jd=(0,Rd.Us)(kt.Ay.Radio),Wd=(0,Rd.Pe)(kt.Ay.Artist,Ld.Gv),Kd=(0,Rd.Us)(kt.Ay.Show),$d=(0,Rd.Us)(kt.Ay.Smarttracklist),Jd=(0,Rd.Us)(kt.Ay.Track),Xd={album:Dd,artist:Od,episode:Ud,flow:Fd,landingalbum:zd,landingartist:qd,landingplaylist:Bd,landingradio:Gd,landingtrack:Qd,livestream:Hd,playlist:Yd,profile:Vd,mix:jd,mixes:Wd,show:Kd,smarttracklist:$d,track:Jd},Zd=/.*\/([0-9]+).*/,eu=/.*\/smarttracklist\/([0-9a-z-]+).*/;var tu=n("DNpT"),nu=n("w2Jm"),su=n("IZwO"),iu=n("RuKb"),au=n("2dhM");let ru=!1;const ou=({getState:e,dispatch:t},n)=>{const s=n?n.offset:Math.floor(us.Ay.getPosition()),i=n?n.id:us.Ay.getSongId(),a=n?n.type:us.Ay.getMediaType(),r=n?n.duration:us.Ay.getDuration();if(!i||!a||!r)return;const o=(0,nu.q)(String(a));if(null===o)return;const l=(0,iu.v6)(e().bookmarks,o,String(i));(l?(0,tu.Ki)(l,s,r):(0,tu.Ht)(o,String(i),s,r)).then((e=>{t((0,su.S8)(e))}))};var cu=n("dn5u"),du=n.n(cu);const uu=du()(),pu="LIMITATION";function mu(e,[t]){var n;t&&t.VALUE&&!Number(t.VALUE.USER_ID)||uu!==(null==t||null===(n=t.VALUE)||void 0===n?void 0:n.UNIQID)&&A.A.trigger(A.A.live.simultaneousAccess)}n("hB5o"),n("LvTk");var hu=n("YNBm");class gu{constructor(){(0,hu.A)(this).list=[]}add(e){const t=(0,hu.A)(this);return t.list=t.list.filter((t=>t.name!==e.name)),t.list.push(e),this}clear(){return(0,hu.A)(this).list.length=0,this}has(e={}){return Boolean((0,hu.A)(this).list.filter((t=>Object.keys(e).reduce(((n,s)=>n&&t[s]===e[s]),!0))).length)}pause(){return(0,hu.A)(this).paused=!0,this}prioritize(e={}){const t=(0,hu.A)(this),n=t.list.filter((t=>Object.keys(e).reduce(((n,s)=>n&&t[s]===e[s]),!0)));if(n.length){const e=n[n.length-1];return t.list=t.list.filter((e=>n.indexOf(e)<0)),t.list.unshift(e),!0}return!1}resume(){return(0,hu.A)(this).paused=!1,this.run(),this}run(){const e=(0,hu.A)(this);if(e.paused||e.running)return this;const t=e.list[0];if(t){const s=Date.now();if(t.timeout&&self.clearTimeout(t.timeout),t.timestamp>s)return t.timeout=self.setTimeout((()=>this.run()),t.timestamp-s),this;e.list.shift(),e.running=!0;const i=t.fn();(n=i,!Boolean(n)||"object"!=typeof n&&"function"!=typeof n||"function"!=typeof n.then?Promise.resolve():i).catch((e=>v.A.error(e))).then((()=>{e.running=!1,this.run()}))}var n;return this}}var yu=n("8VJL"),fu=n("odOL");const Au={};let _u;function Eu(e){const t={from:e.getAttribute("from"),to:e.getAttribute("to")},n=e.getElementsByTagName("items")[0];t.node=n?n.getAttribute("node"):void 0;const s=e.getElementsByTagName("payload")[0]||e.getElementsByTagName("item")[0];t.payload=s.childNodes.length?s.childNodes[0].textContent:void 0;try{t.payload=JSON.parse(t.payload)}catch(e){}return t}function vu(e){const t=Eu(e);return((0,hu.A)(this).listeners.message||[]).filter((e=>Object.keys(e.options||{}).reduce(((n,s)=>n&&(Array.isArray(e.options[s])?e.options[s]:[e.options[s]]).indexOf(t[s])>-1),!0))).forEach((e=>{try{e.fn(t)}catch(e){this.emit("error",e)}})),!0}function bu(e){const t={client:e.getAttribute("from"),type:e.getAttribute("type")};return t.client!==this.socket.jid&&this.emit("presence",t),!0}fu.Strophe.Builder.prototype.cdata||(fu.Strophe.Builder.prototype.cdata=function(e){return this.node.appendChild(fu.Strophe.xmlGenerator().createCDATASection(e)),this});class AuthenticationError extends yu.A{}class ConnectionError extends yu.A{}class Su{static get singleton(){const e=(0,un.WV)({itemType:qn.Wi.CONFIG,itemName:"messaging"})||Gn.default.get("host_messaging");return _u||(_u=new Su({endpoint:`wss://${e}/websocket`,jid:`${O.A.getState().user.id}@${e}`,password:O.A.getState().user.USER_TOKEN}))}constructor({endpoint:e="",id:t=du()(),jid:n,password:s}={}){this.id=t,Object.defineProperty(this,"endpoint",{value:e}),Object.defineProperty(this,"jid",{value:n}),Object.defineProperty(this,"password",{value:s}),Object.defineProperty(this,"socket",{value:new fu.Strophe.Connection(e)});const i=(0,hu.A)(this);i.listeners={},i.retries=0}connect(){const e=(0,hu.A)(this);if(e.connecting)return e.connecting;if(this.socket.connected)return Promise.resolve();const t=e.connecting=new Promise(((t,n)=>{e.connected=(e,s)=>e?n(e):t(s)}));return this.socket.connect(this.jid,this.password,function t(n,s){switch(n){case fu.Strophe.Status.ERROR:this.emit("error",new Error(s));break;case fu.Strophe.Status.CONNFAIL:case fu.Strophe.Status.CONNTIMEOUT:this.emit("error",new ConnectionError(s||"Timeout"));break;case fu.Strophe.Status.AUTHFAIL:s=new AuthenticationError,this.emit("error",s),e.connected(s),e.retries=0,delete e.connecting,delete e.connected;break;case fu.Strophe.Status.CONNECTED:this.socket.addHandler(vu.bind(this),null,"message"),this.socket.addHandler(bu.bind(this),null,"presence"),this.emit("connect"),e.connected(),e.retries=0,delete e.connecting,delete e.connected;break;case fu.Strophe.Status.DISCONNECTED:this.emit("disconnect"),e.disconnecting?(e.disconnected(),delete e.disconnecting,delete e.disconnected,delete this.socket.connect_callback):self.setTimeout((()=>e.connecting?this.socket.connect(this.jid,this.password,t.bind(this)):this.connect()),1e3*(Math.random()*(Math.pow(2,++e.retries)-Math.pow(2,e.retries-1))+Math.pow(2,e.retries-1)));case fu.Strophe.Status.CONNECTING:case fu.Strophe.Status.AUTHENTICATING:case fu.Strophe.Status.DISCONNECTING:case fu.Strophe.Status.ATTACHED:case fu.Strophe.Status.REDIRECT:}}.bind(this)),t}disconnect(){const e=(0,hu.A)(this);if(this===_u)return Promise.reject(new Error("Cannot disconnect the singleton since the socket might be used somewhere else."));if(e.disconnecting)return e.disconnecting;if(!this.socket.connected)return Promise.resolve();const t=e.disconnecting=new Promise(((t,n)=>{e.disconnected=(e,s)=>e?n(e):t(s)}));return this.socket.disconnect(),t}emit(e,...t){((0,hu.A)(this).listeners[e]||[]).forEach((e=>{try{e.fn(...t)}catch(e){this.emit("error",e)}}))}get(e,t={}){const n=new fu.Strophe.Builder("iq",{from:this.jid,type:"get"}).c("pubsub",{xmlns:"http://jabber.org/protocol/pubsub"}).c("items",{node:e});return this.connect().then((()=>new Promise(((e,s)=>this.socket.sendIQ(n,(t=>e(Eu(t))),s,t.timeout)))))}off(e,t){const n=(0,hu.A)(this),s=n.listeners[e]||[];let i=s.length;for(;i--;)t&&s[i]!==t||s.splice(i,1);s.length||delete n.listeners[e]}on(e,t,n){const s=(0,hu.A)(this);s.listeners[e]=s.listeners[e]||[],s.listeners[e].push({fn:t,options:n})}post(e,t,n={}){const s=new fu.Strophe.Builder("iq",{from:this.jid,type:"set"}).c("pubsub",{xmlns:"http://jabber.org/protocol/pubsub"}).c("publish",{node:e}).c("item").cdata("string"==typeof t?t:JSON.stringify(t));return this.connect().then((()=>new Promise((function e(t){const n=Math.floor(Date.now()/1e3);return Object.keys(Au).filter((e=>e<n)).forEach((e=>delete Au[e])),Au[n]>=10?self.setTimeout((()=>e(t)),1e3):(Au[n]=(Au[n]||0)+1,t())})))).then((()=>new Promise(((e,t)=>this.socket.sendIQ(s,e,t,n.timeout)))))}presence(e,t={}){return this.connect().then((()=>new Promise(((n,s)=>this.socket.sendPresence(new fu.Strophe.Builder("presence",e),n,s,t.timeout)))))}}Su.AuthenticationError=AuthenticationError,Su.ConnectionError=ConnectionError;const ku=Su;var Tu=n("wlv8"),Cu=n.n(Tu),wu=n("nLzw"),Iu=n("c33K");let xu=function(e){return e[e.DEFAULT=0]="DEFAULT",e[e.ALBUM=1]="ALBUM",e[e.ARTIST=2]="ARTIST",e[e.CHARTS=3]="CHARTS",e[e.FAMILY=4]="FAMILY",e[e.GENRE=5]="GENRE",e[e.HISTORY=6]="HISTORY",e[e.PLAYLIST=7]="PLAYLIST",e[e.SEARCH=8]="SEARCH",e[e.SONG=9]="SONG",e[e.USER=10]="USER",e[e.OFFLINE=11]="OFFLINE",e}({}),Pu=function(e){return e[e.DEFAULT=0]="DEFAULT",e[e.ARTIST=1]="ARTIST",e}({}),Nu=function(e){return e[e.DEFAULT=0]="DEFAULT",e[e.ALBUM=1]="ALBUM",e[e.LIVE=3]="LIVE",e[e.MIX=4]="MIX",e[e.PERSONAL=5]="PERSONAL",e[e.PLAYLIST=6]="PLAYLIST",e[e.PODCAST=7]="PODCAST",e[e.RECOMMENDED=8]="RECOMMENDED",e[e.SHUFFLE_MY_MUSIC=9]="SHUFFLE_MY_MUSIC",e[e.SMART_TRACKLIST=10]="SMART_TRACKLIST",e[e.TOP_TRACKS=11]="TOP_TRACKS",e}({}),Ru=function(e){return e[e.SONG=0]="SONG",e[e.EPISODE=2]="EPISODE",e[e.LIVE=3]="LIVE",e}({}),Lu=function(e){return e[e.NONE=0]="NONE",e[e.ALL=1]="ALL",e[e.ONE=2]="ONE",e}({});class Du extends Iu.G{constructor(){super("IndexChanged",[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"index",kind:"scalar",T:13},{no:3,name:"timestamp",kind:"scalar",T:4,L:2}])}}const Ou=new Du;class Mu extends Iu.G{constructor(){super("ListChanged",[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"contexts",kind:"message",repeat:1,T:()=>zu},{no:3,name:"tracks",kind:"message",repeat:1,T:()=>Ku},{no:4,name:"tracks_order",kind:"scalar",localName:"tracks_order",repeat:1,T:13},{no:5,name:"shuffled",kind:"scalar",T:8},{no:6,name:"timestamp",kind:"scalar",T:4,L:2}])}}const Uu=new Mu;class Fu extends Iu.G{constructor(){super("ListChanged.Context",[{no:1,name:"container",kind:"message",T:()=>Bu},{no:2,name:"log",kind:"message",T:()=>ju}])}}const zu=new Fu;class qu extends Iu.G{constructor(){super("ListChanged.Context.Container",[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:()=>["ListChanged.Context.Container.ContainerType",Nu]},{no:3,name:"mix",kind:"message",oneof:"extra",T:()=>Qu},{no:4,name:"smart_tracklist_method",kind:"scalar",localName:"smart_tracklist_method",oneof:"extra",T:9},{no:5,name:"topTracks",kind:"message",oneof:"extra",T:()=>Yu}])}}const Bu=new qu;class Gu extends Iu.G{constructor(){super("ListChanged.Context.Container.Mix",[{no:1,name:"type",kind:"enum",T:()=>["ListChanged.Context.Container.Mix.MixType",xu]}])}}const Qu=new Gu;class Hu extends Iu.G{constructor(){super("ListChanged.Context.Container.TopTracks",[{no:1,name:"type",kind:"enum",T:()=>["ListChanged.Context.Container.TopTracks.TopTracksType",Pu]}])}}const Yu=new Hu;class Vu extends Iu.G{constructor(){super("ListChanged.Context.Log",[{no:1,name:"context_id",kind:"scalar",localName:"context_id",T:9},{no:2,name:"listening_context",kind:"scalar",localName:"listening_context",T:9}])}}const ju=new Vu;class Wu extends Iu.G{constructor(){super("ListChanged.Track",[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"context",kind:"scalar",T:13},{no:3,name:"type",kind:"enum",T:()=>["ListChanged.Track.TrackType",Ru]}])}}const Ku=new Wu;class $u extends Iu.G{constructor(){super("RepeatChanged",[{no:1,name:"repeat",kind:"enum",T:()=>["RepeatChanged.RepeatMode",Lu]}])}}const Ju=new $u;var Xu=n("oEcL"),Zu=n("ij5m"),ep=n("zCrf"),tp=n("ISNy");let np;const sp=[Uu],ip=new gu,ap=new gu,rp={paused:!0},op={stack:[]};function lp(...e){op.console&&window.console.log("[TRIFORCE]",...e),op.enabled&&op.stack.push(e)}const cp={songs:ep.d0,episodes:Xu.l$,lives:Zu.qS},dp={songs:tp.KW,episodes:Xu.KN,lives:Zu.b2};function up(e){const t=[],n=e.music.unshuffledList.map(((e,n)=>{const s=us.Ay.getContextByIndexFromOriginal(n),i={container:{id:s.ID,extra:{}},log:{context_id:s.CONTEXT_ID||"",listening_context:s.TYPE}};let a,r=t.findIndex((e=>(0,wu.A)(e,i)));switch(r<0&&(r=t.push(i)-1),us.Ay.getMediaType(e)){case hr.zu.EPISODE:a=Ru.EPISODE;break;case hr.zu.LIVE_STREAM:a=Ru.LIVE;break;default:a=Ru.SONG}return{context:r,id:String(e[us.Ay.getMediaId(e)]),type:a}})),s=[],i=e.music.list.map(((t,n)=>{let i=0;const a=us.Ay.getContextByIndex(n),r=t[us.Ay.getMediaId(t)],o=e.music.unshuffledList.filter((e=>e[us.Ay.getMediaId(e)]===t[us.Ay.getMediaId(t)])).filter((t=>(0,wu.A)(a,us.Ay.getContextByIndexFromOriginal(e.music.unshuffledList.indexOf(t)))));return o.length>1&&(i=s.filter((e=>r===e)).length,s.push(r)),e.music.unshuffledList.indexOf(o[i])}));t.forEach((({container:e,log:{listening_context:t,context_id:n=""}})=>{if(/album(?!_similar)|artist_discography/i.test(t))e.type=Nu.ALBUM;else if(/livestream/.test(t))e.type=Nu.LIVE;else if(/personal/.test(t))e.type=Nu.PERSONAL;else if(/playlist(?!_radio)/.test(t))e.type=Nu.PLAYLIST;else if(/show/.test(t))e.type=Nu.PODCAST;else if("up_next_artist"===t)e.type=Nu.RECOMMENDED;else if(/^shuffled/.test(t))e.type=Nu.SHUFFLE_MY_MUSIC;else if(/smarttracklist/.test(t)){const t=n.split(",").filter((e=>e.startsWith("card_name"))).map((e=>e.split("=")[1])).shift()||"";e.type=Nu.SMART_TRACKLIST,e.extra={oneofKind:"smart_tracklist_method",smart_tracklist_method:t}}else/artist|smartradio/.test(t)?(e.type=Nu.MIX,e.extra={oneofKind:"mix",mix:{type:xu.ARTIST}}):"history_radio"===t||"playlist_radio"===t?(e.type=Nu.MIX,e.extra={oneofKind:"mix",mix:{type:xu.HISTORY}}):"search_radio"===t?(e.type=Nu.MIX,e.extra={oneofKind:"mix",mix:{type:xu.SEARCH}}):/user|flow/.test(t)?(e.type=Nu.MIX,e.extra={oneofKind:"mix",mix:{type:xu.USER}}):/radio/i.test(t)?(e.type=Nu.MIX,e.mix={type:xu.DEFAULT}):e.type=Nu.DEFAULT}));const a=!i.reduce(((e,t,n)=>e&&t===n),!0);return{contexts:t,id:rp.id||du()(),shuffled:a,timestamp:rp.now(),tracks:n,tracks_order:a?i:[]}}function pp(e,t){const n=atob(e),s=Array.from(n).map((e=>e.charCodeAt(0))),i=s.length&&sp.includes(t)?Cu().inflate(new Uint8Array(s)):s;return t.fromBinary(new Uint8Array(i))}function mp(e,t,n={}){const s={PlaybackCurrentIndex:Ou,PlaybackQueueList:Uu,PlaybackRepeatMode:Ju};let i;lp(`Enqueueing a task to update ${e} with:`,t),n.defer&&(rp.retries=(rp.retries||0)+1,i=Date.now()+Math.round(Math.random()*(Math.pow(2,rp.retries)-Math.pow(2,rp.retries-1))*1e3)),rp.retries>5?lp(`Exceeded 5 retries (${e}), task won't be scheduled`):ap.add({name:e,timestamp:i,fn:()=>(lp(`Sending to node ${e}:`,t),ku.singleton.post(e,function(e,t){const n=t.toBinary(e),s=n.length&&sp.includes(t)?Cu().deflate(n,7):n;return btoa(String.fromCharCode(...s))}(t,s[e])||null))}).run()}function hp(e){const t=e/(us.Ay.getDuration()||0);return Number.isFinite(t)?t:0}function gp(e){us.Ay.isPlaying()||us.Ay.control.play();const t=us.Ay.getPosition()/(us.Ay.getDuration()||0)+e;t>0&&t<1&&us.Ay.control.seek(t)}let yp=!1;function fp(e,t){try{var n;navigator.mediaSession.setPositionState({duration:Math.max(null!==(n=us.Ay.getDuration())&&void 0!==n?n:1/0,0),position:t})}catch(e){}}var _p=n("Z64h");function Ep(e,t,n={}){e.dispatch((0,I.S7)(t,n))}const vp=e=>({type:wd.SET_TONE,tone:e});var bp=n("nMcH");const Sp=new Image;let kp,Tp=28;(0,bp.A)()&&(Tp*=2),(0,yd.I7)((()=>e=>t=>{const n=e(t);return t.type===fd.xo&&function(){A.A.subscribeOnce(A.A.player.tracklist_changed,(()=>A.A.resolve(A.A.player.playerReady))),A.A.subscribeOnce(A.A.player.playerLoaded,(()=>{us.Ay.restoreSetting(O.A.getState().user.USER.SETTING)})),Nd.init(),us.Ay.html5.init();const t=Xd[O.A.getState().app.currentPage]||Md,n=["flow","landing"].includes(O.A.getState().app.currentPage),s=d.A.location&&d.A.location.query&&("true"===d.A.location.query.autoplay||"1"===d.A.location.query.autoplay);let i=O.A.getState().user.PLAYLIST_WELCOME_ID;t===Vd?i=O.A.getState().user.USER.USER_ID:t===$d&&eu.test(d.A.location.pathname)?i=d.A.location.pathname.replace(eu,"$1"):t!==Md&&Zd.test(d.A.location.pathname)&&(i=d.A.location.pathname.replace(Zd,"$1"));let a=Gn.default.get("log_contexts")[t];switch(t){case Od:a="topArtistFull";break;case zd:case qd:case Bd:case Gd:case Qd:a=Gn.default.get("log_contexts")[O.A.getState().app.currentPage]}us.Ay.play({autoplay:n||s,context:{ID:i,TYPE:t},id:i,initializing:!0,sync:!1,type:a,radio:[jd,Wd,Vd].includes(t),callbackTrack(e){if(e.length)return;const t=O.A.getState().user.PLAYLIST_WELCOME_ID,n=Md;us.Ay.play({autoplay:!1,context:{ID:t,TYPE:n},id:t,initializing:!0,sync:!1,type:Gn.default.get("log_contexts")[n]})}})}(),n}),(e=>t=>n=>{const s=e.getState().player.control.playing,i=t(n),a=e.getState().player.control.playing,r=e.getState().user.isAuth,o=e.getState().user.id;if(!r)return i;switch(n.type){case fd.xo:!function(e){const t=`${e}_${e}_STREAM`;E.A.addChannel(t),A.A.subscribe(A.A.live[pu.toLocaleLowerCase()],mu)}(o);break;case Ad.EC:!a||s||us.Ay.chromecast.isCasting()||function(e){const t=`${e}_${e}_STREAM`,n=String(us.Ay.getCurrentSong(us.Ay.getMediaId())),s={ACTION:"PLAY",APP:pu,VALUE:{USER_ID:String(e),UNIQID:uu,SNG_ID:n}};E.A.publish(t,s)}(o)}return i}),(e=>t=>n=>{const s=e.getState(),i=t(n),a=e.getState();if(s===a)return i;if(!_.A.isAllowed("triforce_queuelist_messages"))return i;if(!(0,k.ki)(a.user))return i;if(rp.now||(rp.now=()=>(0,k.mI)(a.user)),rp.enabled!==(0,k.Qi)(a.user)){const e=void 0===rp.enabled;if(rp.enabled=(0,k.Qi)(a.user),!e)if(rp.enabled){const e=e=>np[e.node](e);Promise.resolve().then((()=>ku.singleton.get("PlaybackQueueList").then(e))).then((()=>ku.singleton.get("PlaybackCurrentIndex").then(e))).then((()=>ku.singleton.get("PlaybackRepeatMode").then(e)))}else ip.clear(),ap.clear(),delete rp.id}if("enabled"in op||(op.enabled=/triforce/i.test(window.location.search),op.console=op.enabled,op.enabled&&(window.triforce={get console(){return op.console},set console(e){op.console=Boolean(e)},copy:()=>window.copy(op.stack),dump:()=>op.stack.forEach((e=>window.console.log("[TRIFORCE]",...e)))})),n.type===fd.xo&&(A.A.subscribe(A.A.player.play,(()=>rp.paused=!1)),A.A.subscribe(A.A.player.playing,((e,t)=>rp.paused=!t)),A.A.subscribe(A.A.player.paused,((e,t)=>rp.paused=!us.Ay.isPlaying()||Boolean(t))),np={PlaybackCurrentIndex(t){const n=pp(t.payload,Ou);n&&(lp("Received from PlaybackCurrentIndex node:",n),ip.add({id:n.id,name:"PlaybackCurrentIndex",fn(){if(!ip.prioritize({name:"PlaybackQueueList"})&&!ip.prioritize({id:rp.id,name:"PlaybackCurrentIndex"})&&!ap.has({name:"PlaybackQueueList"})){if(!rp.paused||n.timestamp&&n.timestamp<rp.timestamp){if(n.id!==rp.id){lp("Payload id isn't matching with the current one, sending the current state");const t=up(e.getState().player);return mp("PlaybackQueueList",t,{defer:!0}),void mp("PlaybackCurrentIndex",{id:t.id,index:us.Ay.getIndexSong(),timestamp:rp.now()})}return n.index!==us.Ay.getIndexSong()?(lp("Currently playing, sending the current index"),void mp("PlaybackCurrentIndex",{id:rp.id,index:us.Ay.getIndexSong(),timestamp:rp.now()},{defer:!0})):void lp("Asked to change for the same id, so this is a no-op")}(_.A.isAllowed("triforce_queuelist_ui")||"B"===(a.user.USER.ABTEST.triforce_queuelist_ui||{}).option)&&(delete rp.retries,lp("Updating the index with:",n.index),us.Ay.setTriforceIndex(n.index))}}}).run())},PlaybackQueueList(t){const n=pp(t.payload,Uu);if(!n)return;if(lp("Received from PlaybackQueueList node:",{...n,tracks:n.tracks.map((e=>({...e})))}),n.id===rp.id)return void lp("Payload id is matching with the current one, stopping here.");if(!n.tracks.length)return void lp("No tracks found in the payload, stopping here.");const s=n.contexts.map((({container:{id:e},log:{context_id:t,listening_context:n}})=>({CONTEXT_ID:t,ID:e,TYPE:n})));function i(t){if(!cp[t]||!dp[t])return Promise.resolve();const i=cp[t],a=dp[t],r=Ru[t.substring(0,t.length-1).toUpperCase()]||Ru.SONG,o=n.tracks.filter((e=>e.type===r)),l=o.map((e=>e.id));return i({ids:l})(e.dispatch,e.getState).then((()=>{const t=a(e.getState().entities,l);o.forEach(((e,i)=>{const a=e.context;Object.keys(e).forEach((t=>delete e[t])),e.context=s[a],e.data={...t[i]},"up_next_artist"===e.context.TYPE&&n.recommended.push(e)}))}))}n.recommended=[],ip.add({name:"PlaybackQueueList",fn(){if(!ip.prioritize({name:"PlaybackQueueList"}))return Promise.all([i("songs"),i("episodes"),i("lives")]).then((()=>{if(ip.prioritize({name:"PlaybackQueueList"}))return;n.tracks=n.tracks.filter((e=>n.recommended.indexOf(e)<0)),n.original=[...n.tracks],n.tracks=n.tracks_order.length?n.tracks_order.map((e=>n.tracks[e])):n.tracks;const t={[xu.ARTIST]:"artist",[xu.USER]:"user"};if(n.recommended.length)n.radio="up_next_artist";else{const{container:e}=n.contexts[0];e.type===Nu.LIVE?n.radio="livestream":e.type===Nu.MIX&&(n.radio=t[e.extra.mix.type])}if(delete n.contexts,delete n.tracks_order,lp("Hydrated the payload:",n),!rp.paused||n.timestamp&&n.timestamp<rp.timestamp){const{CONTEXT_ID:t,ID:s,TYPE:i}=us.Ay.getContext(),a={CONTEXT_ID:t,ID:String(s),TYPE:i},r=us.Ay.getMediaId(),o=us.Ay.getCurrentSong(r),l=n.tracks.filter((e=>(0,wu.A)(e.context,a))).filter((e=>e.data[r]===o));if(lp("Currently playing, searching for the current track"),!l.length){lp("Current track not found, sending the current state");const t=up(e.getState().player);return mp("PlaybackQueueList",t,{defer:!0}),void mp("PlaybackCurrentIndex",{id:t.id,index:us.Ay.getIndexSong(),timestamp:rp.now()})}n.index=n.tracks.indexOf(l[0]),lp("Current track found, sending the index in case of de-sync"),mp("PlaybackCurrentIndex",{id:n.id,index:n.index,timestamp:rp.now()})}(_.A.isAllowed("triforce_queuelist_ui")||"B"===(a.user.USER.ABTEST.triforce_queuelist_ui||{}).option)&&(delete rp.retries,rp.id=n.id,lp("Updating the queuelist"),us.Ay.setTriforceState(n))}))}}).run()},PlaybackRepeatMode(e){const t=pp(e.payload,Ju);lp("Received from PlaybackRepeatMode node:",t),(_.A.isAllowed("triforce_queuelist_ui")||"B"===(a.user.USER.ABTEST.triforce_queuelist_ui||{}).option)&&us.Ay.control.setRepeat(t?t.repeat:0,{sync:!1})}},ku.singleton.on("connect",(()=>{lp("Socket connected, sending a presence signal"),ap.clear().resume(),ku.singleton.presence()})),ku.singleton.on("disconnect",(()=>{lp("Socket disconnected, pausing the outgoing queue"),ap.pause()})),ku.singleton.on("message",(e=>rp.enabled&&np[e.node](e)),{node:Object.keys(np)}),ku.singleton.connect()),!1===n.sync||!rp.enabled)return i;switch(n.type){case Ad.yd:rp.timestamp=rp.now();break;case Ad.f6:s.player.control.repeat!==a.player.control.repeat&&(delete rp.retries,mp("PlaybackRepeatMode",{repeat:a.player.control.repeat}));break;case fd.Qx:if(!(0,wu.A)(s.player.music.list,a.player.music.list)){const e=up(a.player);delete rp.retries,rp.id=e.id=du()(),mp("PlaybackQueueList",e),mp("PlaybackCurrentIndex",{id:rp.id,index:a.player.music.index,timestamp:rp.now()})}case fd.gz:if(!(0,wu.A)(s.player.music.track,a.player.music.track)||!(0,wu.A)(s.player.music.context,a.player.music.context)){if(!rp.id){const e=up(a.player);rp.id=e.id,mp("PlaybackQueueList",e)}mp("PlaybackCurrentIndex",{id:rp.id,index:a.player.music.index,timestamp:rp.now()})}}return i}),(e=>t=>n=>{const s=t(n),i=e.getState();if(n.type===fd.gz||n.type===fd.GD){const e=(0,wr.tc)(i),t=(0,wr.KX)(i).map((({ART_NAME:e})=>e)).filter(Boolean).join(", "),n=(0,wr.ZQ)(i),s=(0,wr.uY)(i);if(document.title=`${s} - ${t} - Deezer`,"mediaSession"in navigator){const a=(0,Cr.vp)(i.user,i.player.music.track);!yp&&navigator.mediaSession.setPositionState&&(A.A.subscribe(A.A.player.position,fp),yp=!0),navigator.mediaSession.metadata=new MediaMetadata({title:s,artist:t,album:e,artwork:a?[]:[{src:n,sizes:"250x250",type:"image/jpeg"}]})}}if("mediaSession"in navigator&&(n.type===Ad.Qx||n.type===Ad.aw)){navigator.mediaSession.setActionHandler("nexttrack",(0,zl.oy)(i)?us.Ay.control.nextSong:null),navigator.mediaSession.setActionHandler("pause",(0,zl.J2)(i)?us.Ay.control.pause:null),navigator.mediaSession.setActionHandler("play",(0,zl.v_)(i)?us.Ay.control.play:null),navigator.mediaSession.setActionHandler("previoustrack",(0,zl.eX)(i)?us.Ay.control.prevSong:null),navigator.mediaSession.setActionHandler("seekbackward",(0,zl.rt)(i)?({seekOffset:e})=>gp(e?hp(e):-.05):null),navigator.mediaSession.setActionHandler("seekforward",(0,zl.rt)(i)?({seekOffset:e})=>gp(e?hp(e):.05):null);try{navigator.mediaSession.setActionHandler("seekto",(0,zl.rt)(i)?({seekTime:e})=>{const t=e/us.Ay.getDuration();t>0&&t<1&&us.Ay.control.seek(t)}:null)}catch(e){}}return s}),(e=>t=>n=>{const s=t(n),i=e.getState().user;if(n.type===fd.xo&&(0,k.UJ)(i)&&!(0,k.jQ)(i)&&!(0,k.Dx)(i)&&"US"===(0,k.JJ)(i))return Ep(e,$.cn),s;if(n.type!==fd.xo||_p.$.HTML5Renderer||Ep(e,$.Iv),n.type!==Ad.EC)return s;if(e.getState().player.config.playerType!==hr.Cc.MOD)return s;if(n.playing){if((0,k.UJ)(i)||us.Ay.getMediaType()!==hr.zu.SONG||Ep(e,$.mu),(0,k.UJ)(i)&&!(0,k.jQ)(i))if((0,k.fn)(i)){if(!(0,k.Dx)(i)){const t=(0,k.ai)(i);"US"===(0,k.JJ)(i)?Ep(e,$.cn):t>0?Ep(e,$.aC,{streamingDuration:t}):Ep(e,$.h5)}}else Ep(e,$.v4);return s}return n.playing||(0,k.UJ)(i)||e.dispatch((0,x.qf)({name:te.b.AUTH_MODAL,size:"small"})),s}),(e=>t=>n=>{const s=t(n);if(n.type!==fd.LK)return s;let i=n.cover;if(i===kp)return s;kp=i;let a=(0,Zr.Q5)();return e.dispatch(vp(a)),Sp.onload=()=>{try{var{color:t}=(0,Zr.xH)(Sp);a=(0,Zr.HH)(t),(0,wr.Cv)(e.getState())===n.cover&&e.dispatch(vp(a))}catch(e){}},Sp.crossOrigin="",Sp.src=n.cover.replace("250x250",`${Tp}x${Tp}-000000-80-0-0`),s}),(e=>t=>n=>{n.type===fd.xo&&(e=>{ru||(A.A.subscribe(A.A.player.seekCompleted,(()=>{ou(e)}),"bookmarking_middleware"),A.A.subscribe(A.A.player.paused,((t,n)=>{!0===n&&ou(e)}),"bookmarking_middleware"),A.A.subscribe(A.A.player.trackChange,((t,n)=>{ou(e,{id:n.previousTrack.id,type:n.previousTrack.type,offset:n.previousTrack.offset,duration:n.previousTrack.duration})}),"bookmarking_middleware"),ru=!0)})(e);const s=t(n);if(n.type!==au.S.MARK_AS_PLAYED&&n.type!==au.S.MARK_AS_NOT_PLAYED)return s;const i=us.Ay.getSongId(),a=us.Ay.getMediaType();if(!i||!a||!function(e){return{}.hasOwnProperty.call(e,"bookmark")}(n))return s;const r=(0,nu.q)(String(a)),o=n.bookmark;return null===r||o.type===r&&o.id===i&&us.Ay.control.stop(),s}));const Cp=(0,gd.combineReducers)({config:function(e=Sd,t={}){let n;switch(t.type){case fd.xo:case fd.Qx:case fd.gz:return{...e,isRadio:us.Ay.isRadio(),isUpnext:"up_next_artist"===us.Ay.getContext("TYPE"),isFlow:us.Ay.helper.isPlayingFlow(),isMyFlow:us.Ay.helper.isPlayingUserFlow(),playerType:us.Ay.getPlayerType()};case bd.MC:return Boolean(t.active)!==e.isBlindTestMode?{...e,isBlindTestMode:Boolean(t.active)}:e;case bd.Dp:return n=us.Ay.getPlayerType(),n!==e.playerType?{...e,playerType:n}:e;case bd.HO:return e.playerFull!==t.active?{...e,playerFull:t.active}:e;case bd.J:return e.playerQueuelist!==t.active?{...e,playerFull:t.active||e.playerFull,playerQueuelist:t.active,playerLyrics:!t.active&&e.playerFull}:e;case bd.Kf:return e.playerLyrics!==t.active?{...e,playerFull:t.active||e.playerFull,playerLyrics:t.active}:e;default:return e}},control:function(e=_d,t={}){switch(t.type){case fd.xo:case fd.Qx:case fd.gz:return{...e,volume:us.Ay.getVolume(),hasShuffle:(0,us.S1)(),shuffle:us.Ay.isShuffle(),hasRepeat:(0,us.k2)(),repeat:us.Ay.getRepeat(),mute:us.Ay.isMuted()};case Ad.Qx:return{...e,hasNext:t.hasNext};case Ad.aw:return{...e,hasPrev:t.hasPrev};case Ad.EC:return t.playing!==e.playing?{...e,playing:t.playing,loading:!1}:e;case Ad.oB:return t.loading!==e.loading?{...e,loading:t.loading}:e;case Ad.yd:return t.paused!==e.paused?{...e,paused:t.paused}:e;case Ad.Iq:return t.volume!==e.volume?{...e,volume:t.volume}:e;case Ad.tU:return{...e,mute:t.mute};case Ad.f6:return{...e,repeat:t.repeat};case Ad.RA:return{...e,shuffle:t.shuffle};case Ad.Ym:return t.buffer!==e.buffer?{...e,buffer:t.buffer}:e;case Ad.vg:return{...e,playing:!1,paused:!1,loading:!1};case Ad.pU:return{...e,normalized:t.normalized};default:return e}},music:wr.Ay,chromecast:function(e=vd,t={}){switch(t.type){case fd.xo:return{...vd,loading:us.Ay.chromecast.isLoading(),active:us.Ay.chromecast.isActive(),chunksInfo:us.Ay.chromecast.getChunksInfo()};case Ed.Kx:return{...e,available:t.status,connecting:!1,active:t.active,chunksInfo:t.chunksInfo};case Ed.tM:return{...e,available:!0,connecting:t.status,casting:!1,chunksInfo:t.chunksInfo};case Ed.qC:return{...e,available:!0,connecting:!1,active:t.active,casting:t.status,chunksInfo:t.chunksInfo};case Ed.iY:return{...e,loading:t.loading,active:t.active,chunksInfo:t.chunksInfo};case Ed.Y0:return{...e,skipLimited:t.skipLimited};default:return e}},lyrics:(e=Cd,t)=>{switch(t.type){case Td.ht:return{...e,isSync:t.isSync,hasLyrics:t.hasLyrics,metadata:t.metadata,isLoading:t.isLoading,list:t.list};case Td.MB:return{...e,hasLyrics:t.hasLyrics,isLoading:t.isLoading};case Td.xy:return t.autoScroll!==e.autoScroll?{...e,autoScroll:t.autoScroll}:e;default:return t.data&&t.data.entities&&t.data.entities.LYRICS?(0,kd.A)({},e,t.data.entities.LYRICS):e}},ui:(e=Id,t)=>t.type===wd.SET_TONE?{tone:t.tone}:e});var xp,Pp,Np,Rp,Lp,wp=n("3mue"),Ip=n("pJNj");const Dp=i.lazy((()=>n.e(8314).then(n.bind(n,"OER3"))));class Op extends i.Component{constructor(e){super(e),this.state={fading:!1},this._onFading=this._onFading.bind(this),this._onFinish=this._onFinish.bind(this),this._onTrackChange=this._onTrackChange.bind(this),this._onTrackRecognized=this._onTrackRecognized.bind(this),this._onChangePlayerType=this._onChangePlayerType.bind(this),this._onTracklistChange=this._onTracklistChange.bind(this),this._onToggleFavorite=this._onToggleFavorite.bind(this),this._onPlayingChange=this._onPlayingChange.bind(this),this._onPauseChange=this._onPauseChange.bind(this),this._onTracklistFinish=this._onTracklistFinish.bind(this),this._onLoaded=this._onLoaded.bind(this),this._onTrackDurationChange=this._onTrackDurationChange.bind(this),this._onVolumeChange=this._onVolumeChange.bind(this),this._onToggleMute=this._onToggleMute.bind(this),this._onRepeatChange=this._onRepeatChange.bind(this),this._onSimultaneousAccess=this._onSimultaneousAccess.bind(this),this._onShuffleChange=this._onShuffleChange.bind(this),this._onQualityChange=this._onQualityChange.bind(this),this._onNormalizedChange=this._onNormalizedChange.bind(this),this._setAvailableStatus=this._setAvailableStatus.bind(this),this._setConnectingStatus=this._setConnectingStatus.bind(this),this._setCastingStatus=this._setCastingStatus.bind(this),this._setChromecastActiveState=this._setChromecastActiveState.bind(this)}componentDidMount(){!function(){let e,t=[];const{offer_id:n,user_id:s}=is.It.get();A.A.subscribe(A.A.player.licenseChanged,((i,{license_country:a})=>{if(e&&e!==a){const i=(0,cs.L)("playback.media_request_errors","2.0.0",{error:{type:"OtherError",subtype:"CountryMismatch"},media:{id:"id-of-the-track",type:"song"},apiCalls:t,license:{new:a,old:e},client_ip:ls.A.get(),offer_id:n,user_id:s});De.A.log(i)}e=a,t=[]})),Ae.A.addEventListener(Ae.Q.CALL_STARTED,(({detail:e})=>{t.push({method:new URL(e.url).searchParams.get("method"),params:e.data})}))}(),this.props.initPlayer(),A.A.ready(A.A.user.userReady,this._onToggleFavorite),A.A.subscribe(A.A.player.displayCurrentSong,this._onTrackChange,"player"),A.A.subscribe(A.A.player.displayRecognizedTrack,this._onTrackRecognized,"player"),A.A.subscribe(A.A.player.changePlayerType,this._onChangePlayerType,"player"),A.A.subscribe(A.A.player.tracklist_changed,this._onTracklistChange,"player"),A.A.subscribe(A.A.user.addFavorite,this._onToggleFavorite,"player"),A.A.subscribe(A.A.user.deleteFavorite,this._onToggleFavorite,"player"),A.A.subscribe(A.A.player.playing,this._onPlayingChange,"player"),A.A.subscribe(A.A.player.paused,this._onPauseChange,"player"),A.A.subscribe(A.A.player.finishTrackList,this._onTracklistFinish,"player"),A.A.subscribe(A.A.player.pourcentLoaded,this._onLoaded,"player"),A.A.subscribe(A.A.player.duration,this._onTrackDurationChange,"player"),A.A.subscribe(A.A.player.volume_changed,this._onVolumeChange,"player"),A.A.subscribe(A.A.player.mute_changed,this._onToggleMute,"player"),A.A.subscribe(A.A.player.repeat_changed,this._onRepeatChange,"player"),A.A.subscribe(A.A.player.shuffle_changed,this._onShuffleChange,"player"),A.A.subscribeOnce(A.A.player.playerLoaded,(()=>{us.Ay.restoreSetting(this.props.userSetting)})),A.A.subscribe(A.A.player.fading,this._onFading,"player"),A.A.subscribe(A.A.player.finish,this._onFinish,"player"),A.A.subscribe(A.A.live.simultaneousAccess,this._onSimultaneousAccess,"player"),A.A.subscribe(A.A.player.qualityChanged,this._onQualityChange,"player"),A.A.subscribe(A.A.player.normalizedChanged,this._onNormalizedChange,"player"),A.A.subscribe(A.A.player.trackAddNext,this._onTrackAddNext,"player"),A.A.subscribe(A.A.player.trackAddToQueue,this._onTrackAddToQueue,"player"),A.A.subscribe(A.A.chromecast.available,this._setAvailableStatus,"player"),A.A.subscribe(A.A.chromecast.connecting,this._setConnectingStatus,"player"),A.A.subscribe(A.A.chromecast.casting,this._setCastingStatus,"player"),A.A.subscribe(A.A.chromecast.loading,this._setChromecastActiveState,"player")}componentDidUpdate(e){this.props.id!==e.id&&this.props.dispatchHidePopper()}componentWillUnmount(){A.A.unsubscribeAll("player")}render(){const{hasDesktopNotifications:e}=this.props;return i.createElement(J.az,{className:"page-player",id:"page_player","data-testid":"miniplayer_container"},e?xp||(xp=i.createElement(Dp,null)):null,i.createElement(J.so,{minWidth:"768px",alignItems:"center",backgroundColor:"background.neutral.secondary.default",bottom:"0",borderTopWidth:"1px",borderTopStyle:"solid",borderTopColor:"border.neutral.primary.default",justifyContent:"space-between",height:"var(--layout-player-height)",left:"0",px:"spacing.l",position:"fixed",right:"0",zIndex:"300"},Pp||(Pp=i.createElement(Gc,null)),Np||(Np=i.createElement(Ic,null)),Rp||(Rp=i.createElement(pd,null))),Lp||(Lp=i.createElement(kl,null)))}_onFading(){this.props.hasAudioAds&&null!==us.Ay.getAudioAds()||(this.setState({fading:!0}),us.Ay.control.nextSong(!0))}_onFinish(){this.state.fading||us.Ay.control.nextSong(!0),this.setState({fading:!1})}_onTrackChange(e,t,n){this.props.updateTrack(n)}_onTrackRecognized(e,t){t?this.props.updateRecognizedTrack({track:t}):this._onTrackChange()}_onChangePlayerType(){this.props.updatePlayerType()}_onTracklistChange(e,t){this.props.updateTracklist(t),A.A.trigger(A.A.list.deselectAll)}_onToggleFavorite(e,t){(!t||"song"===t.type&&String(t.id)===this.props.id)&&this.props.updateFavorite()}_onPlayingChange(e,t){this.props.setPlaying({playing:t})}_onPauseChange(e,t,n){this.props.setPaused({paused:t,...n})}_onTracklistFinish(){this.props.setTracklistFinished()}_onLoaded(e,t){this.props.setBuffer({buffer:t})}_onTrackDurationChange(e,t){this.props.setTrackDuration({trackDuration:t})}_onVolumeChange(e,t){this.props.setVolume({volume:t/100})}_onToggleMute(e,t){this.props.setMute({mute:t})}_onRepeatChange(e,t,n){this.props.setRepeat({repeat:t,...n})}_onSimultaneousAccess(){const{playing:e,playerType:t,hasEventSimultaneousListening:n,triggerAppCustoEvent:s}=this.props;if(e&&!(0,us._k)(t)&&!us.Ay.chromecast.isActive()){if(us.Ay.control.pause(),n&&s(md.Sc.SIMULTANEOUS_LISTENING))return;this.props.openModal({name:"PLAYER_LIMITATION"})}}_onShuffleChange(e,t){this.props.setShuffle({shuffle:t}),A.A.trigger(A.A.list.deselectAll)}_onQualityChange(e,t){this.props.setQuality(t)}_onNormalizedChange(e,t){this.props.setNormalized(t)}_onTrackAddNext(e,{notify:t,count:n}){!0===t&&(0,mi.A)({body:(0,W.WI)("Le titre a bien été ajouté à la file d'attente.","Les titres ont bien été ajoutés à la file d'attente.",{count:n})})}_onTrackAddToQueue(e,{count:t}){(0,mi.A)({body:(0,W.WI)("Le titre a bien été ajouté à la file d'attente.","Les titres ont bien été ajoutés à la file d'attente.",{count:t})})}_setChromecastActiveState(e,t){this.props.setLoading({loading:t}),this.props.setChromecastActiveState({loading:t,active:us.Ay.chromecast.isActive(),chunksInfo:us.Ay.chromecast.getChunksInfo()})}_setAvailableStatus(e,t){this.props.setChromecastAvailableStatus({status:t,active:us.Ay.chromecast.isActive(),chunksInfo:us.Ay.chromecast.getChunksInfo()})}_setConnectingStatus(e,t){this.props.setChromecastConnectingStatus({status:t,chunksInfo:us.Ay.chromecast.getChunksInfo()})}_setCastingStatus(e,t){this.props.setChromecastCastingStatus({status:t,active:us.Ay.chromecast.isActive(),chunksInfo:us.Ay.chromecast.getChunksInfo()})}_seek(e,t){e&&(e.preventDefault(),e.stopPropagation()),this.props.canSeek&&(void 0===t&&(t=e.pageX/e.currentTarget.parentNode.offsetWidth),us.Ay.control.seek(t))}}O.A.addReducers({player:Cp});const Mp=(0,a.Ng)((e=>({id:e.player.music.id,track:e.player.music.track,playing:e.player.control.playing,playerType:e.player.config.playerType,userSetting:e.user.USER.SETTING,hasAudioAds:e.user.USER.OPTIONS.ads_audio,hasEventSimultaneousListening:(0,sa.lm)(e,md.Sc.SIMULTANEOUS_LISTENING),hasDesktopNotifications:(0,k.AU)(e.user),canSeek:(0,zl.rt)(e)})),{dispatchHidePopper:U.Lm,initPlayer:wr.kI,setPlaying:wp.Li,setPaused:wp.XP,setLoading:wp.r1,setTracklistFinished:wp.qq,setBuffer:wp.V6,setTrackDuration:wr.WN,setVolume:wp.ls,setRepeat:wp.oD,setShuffle:wp.UD,setMute:wp.YI,setQuality:wr.Up,setNormalized:wp.ej,updateFavorite:wr.O,updateTrack:wr.FZ,updateRecognizedTrack:wr.NL,updatePlayerType:ia.pE,updateTracklist:wr.Fh,triggerAppCustoEvent:na.sS,openModal:x.qf,setChromecastActiveState:Ip.uP,setChromecastAvailableStatus:Ip.E9,setChromecastConnectingStatus:Ip.F$,setChromecastCastingStatus:Ip.ix})(Op);var Up=n("WeLa");class Fp extends i.Component{shouldComponentUpdate(e){return!!e.current&&(!this.props.current||Boolean(this.props.current&&e.current.name!==this.props.current.name))}render(){const{current:e}=this.props;return e&&e.value?(e.type===md.DP.CUSTO&&(this._custoModal(),(0,Up.s6)(e.onTriggered||[])),null):null}_custoModal(){const{current:e}=this.props;e&&e.value&&e.type===md.DP.CUSTO&&this.props.openModal({name:"CUSTO",props:{custo:e.value,closeModal:()=>{this.props.removeCurrent(),this.props.closeModal()}},size:"medium",addRadius:!0,disableClosingAction:!(0,sa.db)(e)})}}Fp.displayName="AppCusto";const zp=(0,a.Ng)((({appCusto:{current:e}})=>({current:e})),{openModal:x.qf,closeModal:x.Oo,removeCurrent:na.in})(Fp);var qp=n("9odk");const Bp=({openScreen:e,isOnboardingOpen:t,toRenderWhenNoOnboarding:n,toRenderWhenOnboarding:s})=>{const a=(0,qp.AP)();return i.useEffect((()=>{null!=a&&a.shouldBeOnboarded&&!t&&e({name:F.F.ONBOARDING,data:{showGenreFilter:!0}})}),[t,a,e]),a&&!1===a.shouldBeOnboarded?n:s};Bp.defaultProps={toRenderWhenNoOnboarding:null,toRenderWhenOnboarding:null};const Gp=(0,a.Ng)((({user:{id:e},fullscreen:{name:t}})=>({currentUserId:e,isOnboardingOpen:t===F.F.ONBOARDING})),{openScreen:w.J2,closeScreen:w.Fn})(Bp);class Qp extends i.Component{render(){const{darkModeOn:e}=this.props,t="dark"===document.documentElement.getAttribute("data-theme");return _.A.isAllowed("dark_mode")?(e===t||(e?(document.body.classList.add("no-transitions"),document.documentElement.setAttribute("data-theme","dark"),window.requestAnimationFrame((()=>{document.body.classList.remove("no-transitions")}))):xt()),null):(xt(),null)}}const Hp=(0,a.Ng)((e=>({darkModeOn:(0,k.NF)(e.user)})))(Qp);var Yp=n("imBb"),Vp=n.n(Yp);const nm=({label:e,displaySize:t,shortcut:n})=>{if(!e)return null;const s="wide"!==t?null==n?void 0:n.split(","):[n],a=(0,r.A)("cZzQk",{X8ULE:"wide"===t,qQd6L:"wide"!==t&&1===(null==s?void 0:s.length)});return i.createElement("div",{className:"pr654"},null==s?void 0:s.map(((e,t)=>{if(!e)return null;const n=t;return i.createElement("div",{className:a,key:"shortcut"+n},e)})),i.createElement("div",{className:"zt_Lq"},e))};var sm=n("TYt9"),im=n("fJgm");const am=e=>{e>0&&e<1&&us.Ay.control.seek(e)},rm=()=>{am(1e-4)},om=()=>{us.Ay.isPlaying()||us.Ay.control.play();const e=(us.Ay.getPosition()/(us.Ay.getDuration()||1)-.05).toFixed(3);am(Number(e))},lm=()=>{us.Ay.isPlaying()||us.Ay.control.play();const e=(us.Ay.getPosition()/(us.Ay.getDuration()||1)+.05).toFixed(3);am(Number(e))},cm=(e,t)=>{let n=parseFloat(t||"0")/10;return 0===n&&(n=1e-5),am(n)},dm=()=>{let e=Number((us.Ay.getVolume()-.1).toFixed(2));e=Math.max(0,e),0!==e||us.Ay.isMuted()||us.Ay.control.mute(),us.Ay.control.setVolume(e)},um=()=>{let e=Number((us.Ay.getVolume()+.1).toFixed(2));e=Math.min(1,e),us.Ay.control.setVolume(e)},pm=()=>{us.Ay.control.mute(!us.Ay.isMuted())},mm=(0,le.A)((()=>{us.Ay.control.nextSong()}),100),hm=(0,le.A)((()=>{us.Ay.control.prevSong()}),100),gm=e=>{"preventDefault"in e&&e.preventDefault(),$l.A.intent("play"),A.A.trigger("EVENT.TRACKLIST.togglePlayAll")},ym=e=>{"preventDefault"in e&&e.preventDefault(),us.Ay.getPlayerType()!==hr.Cc.ADS&&us.Ay.getPlayerType()!==hr.Cc.TRITON_AD&&($l.A.intent((0,sm.G)(us.Ay)),us.Ay.control.togglePause())},fm=()=>{const e=Number(us.Ay.getRepeat());us.Ay.control.setRepeat(2===e?0:e+1)},Am=()=>{A.A.ready(A.A.user.initialized,(()=>{if(-1!==[hr.Cc.ADS,hr.Cc.LIVESTREAM].indexOf(us.Ay.getPlayerType()))return;if(us.Ay.getMediaType()!==hr.zu.SONG)return;const e=us.Ay.getCurrentSong("SNG_ID"),t=im.A.isFavorite(kt.Ay.Song,e)?"remove":"add",n=us.Ay.getContext();im.A[t]({type:kt.Ay.Song,id:e,context:n})}))},_m=e=>{var t;"preventDefault"in e&&e.preventDefault(),null===(t=document.getElementById("topbar-search"))||void 0===t||t.focus()},Em=Ji.A.is("macos")?"alt":"ctrl",vm=()=>{const[e,t]=(0,i.useState)(!1),n=(0,i.useCallback)((()=>{t(!e)}),[e]),a=()=>{document.body.classList&&(document.body.classList.add("konami"),setTimeout((()=>{document.body.classList.remove("konami")}),1e4))},o=(0,i.useMemo)((()=>[{keys:["0","1","2","3","4","5","6","7","8","9"],callback:cm,options:{label:(0,W.AP)("Aller à la position"),shortcut:"0...9",displaySize:"wide"}},{keys:"space",callback:ym,options:{label:(0,W.AP)("Lecture/Pause"),shortcut:(0,W.AP)("Espace"),displaySize:"wide"}},{keys:"shift+enter",callback:gm,options:{label:(0,W.AP)("Lire les titres présents sur la page"),shortcut:"⇧ ⏎",displaySize:"wide"}},{keys:["s","shift+s"],callback:_m,options:{label:(0,W.AP)("Rechercher"),shortcut:"S"}},{keys:`${Em}+left`,callback:om,options:{label:(0,W.AP)("Reculer"),shortcut:`${Em},←`}},{keys:`${Em}+right`,callback:lm,options:{label:(0,W.AP)("Avancer"),shortcut:`${Em},→`}},{keys:"r",callback:rm,options:{label:(0,W.AP)("Rejouer le titre"),shortcut:"R"}},{keys:"shift+left",callback:hm,options:{label:(0,W.AP)("Lire le titre précédent"),shortcut:"⇧,←",event:"keyup"}},{keys:"shift+right",callback:mm,options:{label:(0,W.AP)("Lire le titre suivant"),shortcut:"⇧,→",event:"keyup"}},{keys:["m","shift+m"],callback:pm,options:{label:(0,W.AP)("Silence"),shortcut:"M"}},{keys:"shift+up",callback:um,options:{label:(0,W.AP)("Augmenter le volume"),shortcut:"⇧,↑"}},{keys:"shift+down",callback:dm,options:{label:(0,W.AP)("Baisser le volume"),shortcut:"⇧,↓"}},{keys:["l","shift+l"],callback:Am,options:{label:(0,W.AP)("Ajouter le titre aux Coups de cœur"),shortcut:"L"}},{keys:"shift+r",callback:fm,options:{label:(0,W.AP)("Mode de répétition"),shortcut:"⇧,R"}},{keys:["h","shift+h","?"],callback:n,options:{label:(0,W.AP)("Afficher les raccourcis clavier"),shortcut:"H / ?",displaySize:"wide",event:"keypress"}},{keys:"up up down down left right left right b a enter",callback:a}]),[n]);(0,i.useEffect)((()=>(o.forEach((e=>(({keys:e,callback:t,options:n})=>{const s=(null==n?void 0:n.event)||"keydown";Vp().bind(e,t,s)})(e))),()=>{o.forEach((e=>Vp().unbind(e.keys)))})),[o]);const l=(0,r.A)("h3wew",{igbv2:e});return i.createElement("div",{className:l,"aria-hidden":!e,"data-testid":"hotkey-panel"},i.createElement("div",{className:"KGl0e"}),i.createElement("div",{className:"vBn6X"},o.map((e=>i.createElement(nm,(0,s.A)({key:e.keys.toString()},e.options))))))};n("Dk60");class bm{constructor(e,t,n,s=void 0){this.userId=void 0,this.name=void 0,this.to=void 0,this.event=void 0,this.channel=void 0,this.eventHandler=void 0,this.listeners=void 0,this._connected=!1,this.event=e,this.userId=t,this.name=n,this.to=s,this.channel=[this.userId,this.userId,this.event.toUpperCase()].join("_"),this.listeners=[]}connect(){if(!0!==this._connected){if(this.event in A.A.live==0)throw new Error(`Unknown event ${this.event}: you should specify an event from Events.live`);E.A.addChannel(this.channel),this.eventHandler=this.onMessage.bind(this),A.A.subscribe(A.A.live[this.event],this.eventHandler),this._connected=!0}}disconnect(){!1!==this._connected&&(E.A.deleteChannel(this.channel),A.A.unsubscribe(A.A.live[this.event],this.eventHandler),this._connected=!1,this.listeners=[])}get connected(){return this._connected}onMessage(e,t){if(!1===this._connected)return;const{body:n,headers:s}=t[0];if("string"!=typeof n)throw new Error("No string body property on message");if("object"!=typeof s)throw new Error("No headers on message");const{destination:i,from:a}=s;if(void 0===a)throw new Error("No sender defined");a!==this.name&&(i&&i!==this.name||this.to&&a!==this.to||this.listeners.forEach((e=>e(n))))}publish(e,t){if(!this._connected)return Promise.reject(new Error("Not connected"));if(void 0!==this.to&&void 0!==t&&t!==this.to)return Promise.reject(new Error("Cannot publish to another peer that the one we connected to"));const n={from:this.name};void 0!==this.to&&(n.destination=this.to),void 0!==t&&(n.destination=t);const s={APP:this.event.toUpperCase(),headers:n,body:e};return E.A.publish(this.channel,s),Promise.resolve()}addListener(e){this.listeners.push(e)}removeListener(e){this.listeners=this.listeners.filter((t=>t!==e))}}var Sm=n("8cVe");function km(e,t){const n=JSON.parse(e);if("string"!=typeof n.messageType)throw new Error('No string property "messageType" on message');if("string"!=typeof n.messageId||""===n.messageId)throw new Error('No string property "messageId" on message');if("string"!=typeof n.payload)throw new Error('No string property "payload" on message');if("string"!=typeof n.protocolVersion)throw new Error('No string property "protocolVersion" on message');const s=t[n.messageType];if(void 0===s)throw new Error(`Unknow message type ${n.messageType}`);return s(n)}function Tm(e){return({messageId:t,payload:n})=>{const s=""===n?{}:JSON.parse((0,Sm.D4)(n));return new e({messageId:t,...s})}}function Cm(e){return JSON.stringify({messageId:e.messageId,messageType:e.messageType,protocolVersion:e.protocolVersion,clock:e.clock,payload:e.payloadString()})}class wm{constructor({messageType:e,messageId:t=du()(),clock:n={}}){this.messageId=void 0,this.messageType=void 0,this.protocolVersion="com.deezer.remote.discovery.proto1",this.clock={},this.messageId=t,this.messageType=e,this.clock=n}payloadString(){const e=this.payloadJSON();return 0===Object.getOwnPropertyNames(e).length?"":(0,Sm.lF)(JSON.stringify(e))}}class Im extends wm{constructor({from:e,params:t,messageId:n}){if(super({messageType:"connectionOffer",messageId:n}),this.from=void 0,this.params=void 0,"string"!=typeof e)throw new Error('"from" should be a string');this.from=e,this.params=t}payloadJSON(){return{from:this.from,params:this.params}}}class xm extends wm{constructor({from:e,params:t,messageId:n}){if(super({messageType:"connect",messageId:n}),this.from=void 0,this.params=void 0,"string"!=typeof e)throw new Error('"from" should be a string');this.from=e,this.params=t}payloadJSON(){return{from:this.from,params:this.params}}}class Pm extends wm{constructor({from:e,params:t,messageId:n}){if(super({messageId:n,messageType:"discoveryRequest"}),this.from=void 0,this.params=void 0,"string"!=typeof e)throw new Error('"from" should be a string');this.from=e,this.params=t}payloadJSON(){return{from:this.from,params:this.params}}}var Nm=n("xNxK"),Rm=n("mEUi");class Lm extends Rm.Ay{}class Dm extends Error{constructor(e){super(e),this.name="Stopped"}}class Om{constructor(){this.internalCache=new Map,this.waiting=new Map}clear(){this.waiting.forEach((({reject:e})=>{e(new u.MU)})),this.waiting.clear(),this.internalCache.clear()}cache(e){this.internalCache.set(e.id,e);const t=this.waiting.get(e.id);if(void 0===t)return;const{resolve:n}=t;this.waiting.delete(e.id),n(e)}get(e,t){return(0,Nm.h)(new Promise(((t,n)=>{const s=this.internalCache.get(e);void 0===s?this.waiting.set(e,{resolve:t,reject:n}):t(s)})),t).finally((()=>this.waiting.delete(e)))}}class Mm{constructor({messageType:e,messageId:t=du()(),clock:n={}}){this.messageId=void 0,this.messageType=void 0,this.protocolVersion="com.deezer.remote.queue.proto1",this.clock={},this.messageId=t,this.messageType=e,this.clock=n}}class Um extends Mm{constructor({queue:e,messageId:t}){super({messageType:"publishQueue",messageId:t}),this.queue=void 0,this.queue=e}payloadString(){return function(e){const t=Uu.toBinary(e),n=t.length>0?Cu().deflate(t,7):t;return btoa(String.fromCharCode(...n))}(this.queue)}}function Fm({messageId:e,payload:t}){const n=function(e){if("string"!=typeof e)return;const t=atob(e),n=Array.from(t).map((e=>e.charCodeAt(0))),s=Cu().inflate(new Uint8Array(n));return Uu.fromBinary(new Uint8Array(s))}(t);if(!n)throw new Error("Could not decode received queue");return new Um({messageId:e,queue:n})}class zm extends Mm{constructor({messageId:e}){super({messageType:"refreshQueue",messageId:e})}payloadString(){return""}}class qm extends Lm{constructor(e,t,n){super(),this.conn=void 0,this.cache=new Om,this.closed=!1,this.onQueueNeedsRefresh=void 0,this.conn=new bm("remotequeue",e,t,n),this.conn.addListener((e=>this.didReceiveMessage(e)))}connect(){this.conn.connect()}disconnect(){this.conn.disconnect()}queueWithId(e,t){return!0===this.closed?Promise.reject(new Dm):this.cache.get(e,t)}publishQueue(e){var t;const n=Cm(new Um({queue:e}));return this.dispatchEvent(new CustomEvent("sendqueue",{detail:{content:n,containerType:(null===(t=e.contexts[0])||void 0===t||null===(t=t.container)||void 0===t?void 0:t.type)||0}})),this.conn.publish(n)}stop(){this.disconnect(),this.cache.clear(),this.onQueueNeedsRefresh=void 0,this.closed=!0}didReceiveMessage(e){const t=km(e,{refreshQueue:Tm(zm),publishQueue:Fm});switch(t.messageType){case"publishQueue":return this.cache.cache(t.queue);case"refreshQueue":return this.onQueueNeedsRefresh&&this.onQueueNeedsRefresh();default:throw new Error("Unknow message type "+t.messageType)}}}class Bm extends Rm.Ay{}class Gm extends Error{constructor(e,t){super(t),this.code=void 0,this.code=e}}class Qm{constructor({messageType:e,messageId:t=du()(),clock:n={}}){this.messageId=void 0,this.messageType=void 0,this.protocolVersion="com.deezer.remote.command.proto1",this.clock={},this.messageId=t,this.messageType=e,this.clock=n}payloadString(){const e=this.payloadJSON();return 0===Object.getOwnPropertyNames(e).length?"":(0,Sm.lF)(JSON.stringify(e))}}class Hm extends Qm{constructor({acknowledgementId:e,messageId:t}){if(super({messageType:"ack",messageId:t}),this.acknowledgementId=void 0,"string"!=typeof e)throw new TypeError("Parse Error, no acknowledgementId");this.acknowledgementId=e}payloadJSON(){return{acknowledgementId:this.acknowledgementId}}}class Ym extends Qm{constructor({messageId:e}={}){super({messageType:"ready",messageId:e})}payloadJSON(){return{}}}class Vm extends Qm{constructor({queueId:e,elementId:t,progress:n,buffered:s,duration:i,quality:a,isPlaying:r,isShuffle:o,repeatMode:l,volume:c,messageId:d}){super({messageType:"playbackProgress",messageId:d}),this.queueId=void 0,this.elementId=void 0,this.progress=void 0,this.buffered=void 0,this.duration=void 0,this.quality=void 0,this.volume=void 0,this.isPlaying=void 0,this.isShuffle=void 0,this.repeatMode=void 0,this.queueId=e,this.elementId=t,this.progress=n,this.buffered=s,this.duration=i,this.quality=a,this.isPlaying=r,this.isShuffle=o,this.repeatMode=l,this.volume=c}payloadJSON(){return{queueId:this.queueId,elementId:this.elementId,progress:this.progress,buffered:this.buffered,duration:this.duration,quality:this.quality,volume:this.volume,isPlaying:this.isPlaying,isShuffle:this.isShuffle,repeatMode:this.repeatMode}}}class jm extends Qm{constructor({queueId:e,elementId:t,progress:n,shouldPlay:s,setShuffle:i,setRepeatMode:a,setVolume:r,messageId:o}){super({messageType:"skip",messageId:o}),this.queueId=void 0,this.elementId=void 0,this.progress=void 0,this.shouldPlay=void 0,this.setShuffle=void 0,this.setRepeatMode=void 0,this.setVolume=void 0,this.queueId=e,this.elementId=t,this.progress=n,this.shouldPlay=s,this.setRepeatMode=a,this.setShuffle=i,this.setVolume=r}payloadJSON(){return{queueId:this.queueId,elementId:this.elementId,progress:this.progress,shouldPlay:this.shouldPlay,setShuffle:this.setShuffle,setRepeatMode:this.setRepeatMode,setVolume:this.setVolume}}}class Wm extends Qm{constructor({messageId:e}){super({messageType:"ping",messageId:e})}payloadJSON(){return{}}}class Km extends Qm{constructor({messageId:e}){super({messageType:"close",messageId:e})}payloadJSON(){return{}}}class $m extends Qm{constructor({messageId:e}){super({messageType:"stop",messageId:e})}payloadJSON(){return{}}}class Jm extends Qm{constructor({commandId:e,status:t,messageId:n}){if(super({messageType:"status",messageId:n}),this.commandId=void 0,this.status=void 0,"string"!=typeof e)throw new TypeError("Parse Error, no commandId");if("number"!=typeof t&&void 0!==t)throw new TypeError("Parse Error, no status");this.commandId=e,this.status=t}payloadJSON(){return{commandId:this.commandId,status:this.status}}}class Xm extends Bm{constructor(e,t,n){super(),this.conn=void 0,this.remotePromises=void 0,this.commandHandler=void 0,this.stopWatchDog=()=>{},this.conn=new bm("remotecommand",e,t,n),this.remotePromises=new Map}connect(e,t){this.stopWatchDog=function(e,t,n){let s,i=!1;function a(){clearTimeout(s)}function r(e=!1){i||(s=window.setTimeout((()=>{if(!e)return n.onInactive(),void r(!0);n.onLost()}),Math.floor(t+1e3*Math.random())))}function o(){a(),r()}return r(),e.addListener(o),()=>{i=!0,e.removeListener(o),a()}}(this.conn,5e3,{onInactive:()=>this.publish(new Wm({})),onLost:t||(()=>{})}),this.commandHandler=e,this.conn.addListener((e=>this.onMessage(e))),this.conn.connect()}async disconnect(e){!e&&this.conn.connected&&await this.publish(new Km({})),this.commandHandler=void 0,this.conn.disconnect(),this.stopWatchDog(),this.remotePromises=new Map}onCommandStatus(e){const t=this.remotePromises.get(e.commandId);t&&(e.status>0?t.reject(e.status):t.resolve())}onMessage(e){const t=(e=>km(e,{ack:Tm(Hm),ready:Tm(Ym),playbackProgress:Tm(Vm),skip:Tm(jm),ping:Tm(Wm),close:Tm(Km),stop:Tm($m),status:Tm(Jm)}))(e);if(t instanceof Hm){const e=new CustomEvent("msgack",{detail:{id:t.acknowledgementId}});return void this.dispatchEvent(e)}if(t instanceof Jm)return void this.onCommandStatus(t);const n=new Hm({acknowledgementId:t.messageId});if(this.publish(n),!(t instanceof Wm)&&void 0!==this.commandHandler){const e={commandId:t.messageId,status:0};this.commandHandler(t).then((()=>e)).catch((n=>(v.A.error(`command ${t.messageType} errored`,n),{...e,status:n instanceof Gm?n.code:1}))).then((e=>{this.publish(new Jm(e))}))}}publish(e,t){const n=Cm(e),s=()=>{const t=new CustomEvent("msgsent",{detail:{id:e.messageId,type:e.messageType}});return this.dispatchEvent(t),this.conn.publish(n)};return void 0===t?s().catch((()=>{})):(0,Nm.h)(new Promise(((t,n)=>{this.remotePromises.set(e.messageId,{resolve:t,reject:n}),s()})),t).catch((t=>{const n=t instanceof u.MU?"timeout":"error",s={status:n,id:e.messageId,type:e.messageType,code:"error"===n?t:void 0},i=new CustomEvent("msgstatus",{detail:s});this.dispatchEvent(i);const a=`${s.type} failed (reason: ${n}, code: ${s.code})`;throw"timeout"===n?new u.MU(a):Error(a)})).then((()=>{const t=new CustomEvent("msgstatus",{detail:{status:"ok",id:e.messageId,type:e.messageType}});this.dispatchEvent(t)})).finally((()=>{this.remotePromises.delete(e.messageId)}))}}class Zm{constructor(e,t){this.userId=void 0,this.conn=void 0,this.discoveryRequestHandler=void 0,this.pendingOffers=new Map,this.seen=new Set,this.userId=e,this.conn=new bm("remotediscover",e,t),this.conn.addListener((e=>this.handleMessage(e)))}listen(e){this.discoveryRequestHandler=e,this.conn.connect()}stop(){this.pendingOffers.forEach((({reject:e})=>e(new u.MU))),this.pendingOffers=new Map,this.conn.disconnect()}handleMessage(e){const t=km(e,{discoveryRequest:Tm(Pm),connectionOffer:Tm(Im),connect:Tm(xm)});switch(t.messageType){case"discoveryRequest":this.handleDiscoveryRequest(t);break;case"connect":this.handleConnect(t)}}handleDiscoveryRequest({from:e,params:t}){const{discovery_session:n}=t,s=e+n;if(!0!==this.seen.has(s)&&(this.seen.add(s),this.discoveryRequestHandler)){const n={from:e,params:t,accept:(t={},n=3e4)=>{const s=new Im({from:this.conn.name,params:t}),i=Cm(s);return this.conn.publish(i,e).then((()=>(0,Nm.h)(new Promise(((e,t)=>{this.pendingOffers.set(s.messageId,{resolve:e,reject:t})})),n).finally((()=>{this.pendingOffers.delete(s.messageId)}))))}};this.discoveryRequestHandler(n)}}handleConnect({from:e,params:t}){var n;const s=t.offer_id;if(void 0===s)return;const{resolve:i,reject:a}=null!==(n=this.pendingOffers.get(s))&&void 0!==n?n:{};void 0!==i&&void 0!==a&&i({command:new Xm(this.userId,this.conn.name,e),queue:new qm(this.userId,this.conn.name,e)})}}function eh(e,t){if(t)return[e,t.id,t.index].join("-")}var nh=n("sEfC"),sh=n.n(nh);class ih{constructor(e){this._less_eq=void 0,this._count=void 0,this._less_eq=e,this._count=0}get less_eq(){return this._less_eq===1/0?"+Inf":this._less_eq.toString()}add(e){if(!this.test(e))throw new Error(`${e} is out of bound`);this._count++}test(e){return e<=this._less_eq}serialize(){return{count:this._count,less_eq:this.less_eq}}reset(){this._count=0}}const ah=class{constructor({id:e,buckets:t,tags:n}){if(this._tags=void 0,this._buckets=void 0,this._id=void 0,this._count=void 0,this._sum=void 0,!t.length)throw new Error("Buckets values are mandatory");this._id=e,this._count=0,this._sum=0,this._buckets=[...new Set(t)].sort(((e,t)=>e-t)).map((e=>new ih(e))),n&&Object.keys(n).length&&(this._tags=n)}get id(){return this._id}get buckets(){return this._buckets}get count(){return this._count}get sum(){return this._sum}add(e){const t=this._buckets.filter((t=>t.test(e)));if(!t.length)throw new Error(`${e} is out of bound`);t.forEach((t=>t.add(e))),this._count++,this._sum+=e}send(){const e={metric:{id:this._id},histogram:{buckets:this._buckets.map((e=>e.serialize())),count:this._count,sum:this._sum}};this._tags&&(e.metric.tags=this._tags),De.A.log((0,cs.L)("metrics.histogram","1.0.0",e)),this.reset()}reset(){this._buckets.forEach((e=>e.reset())),this._count=0,this._sum=0}},rh=e=>{const t={},n=({detail:e})=>{const n=`${e.type}${e.status}${e.code||""}`;t[n]=t[n]||new Yn.A({id:Vn.Ps.REMOTE_COMMAND_STATUS,tags:{command_type:e.type,status:e.status,errorCode:e.code}}),t[n].increment(1)};return e.addEventListener("msgstatus",n),{stop:()=>e.removeEventListener("msgstatus",n),flush:()=>{Object.values(t).filter((e=>e.value>0)).forEach((e=>e.send()))}}},oh=e=>{const t={},n=({detail:e})=>{t[e.type]=t[e.type]||new Yn.A({id:Vn.Ps.REMOTE_COMMAND_TYPE,tags:{command_type:e.type}}),t[e.type].increment(1)};return e.addEventListener("msgsent",n),{stop:()=>e.removeEventListener("msgsent",n),flush:()=>{Object.values(t).filter((e=>e.value>0)).forEach((e=>e.send()))}}},lh=(e,t)=>{const n={},s=new ah({id:Vn.xK.REMOTE_BUS_LATENCY,buckets:[100,500,1e3,3e3,1/0],tags:{country_code:t}}),i=({detail:e})=>{"ack"!==e.type&&(n[e.id]=Date.now())},a=e=>{const{id:t}=e.detail;if(t in n){const e=Date.now()-n[t];s.add(e),delete n[t]}};return e.addEventListener("msgsent",i),e.addEventListener("msgack",a),{stop:()=>{e.removeEventListener("msgsent",i),e.removeEventListener("msgack",a)},flush:()=>s.send()}},ch=(e,t)=>{const n=[rh,oh,lh].map((n=>n(e,t))),s=setInterval((()=>{n.forEach((e=>e.flush()))}),3e4);return{stop:()=>{n.forEach((e=>e.stop())),clearInterval(s)},flush:M.A}},dh=new Map([[0,"DEFAULT"],[1,"ALBUM"],[3,"LIVE"],[4,"MIX"],[5,"PERSONAL"],[6,"PLAYLIST"],[7,"PODCAST"],[8,"RECOMMENDED"],[9,"SHUFFLE_MY_MUSIC"],[10,"SMART_TRACKLIST"],[11,"TOP_TRACKS"],[-1,"UNRECOGNIZED"]]);function uh(e){const t=({detail:e})=>{((e,t)=>{const n=new ah({id:Vn.xK.REMOTE_QUEUE_SIZE,buckets:[1e3,1e5,5e5,1e6,1/0],tags:{queue_type:null!=t?t:"UNRECOGNIZED"}});n.add(e),n.send()})(new Blob([e.content]).size,dh.get(e.containerType))};return e.addEventListener("sendqueue",t),{stop:()=>{e.removeEventListener("sendqueue",t)}}}class ph{constructor(e,t,n,s,i){this.commandConnection=void 0,this.queueConnection=void 0,this.eventGroup=void 0,this.player=void 0,this.countryCode=void 0,this.trackers=[],this.playRequestHandler=void 0,this.playerEventsBound=!1,this.enableTracking=void 0,this.player=e,this.queueConnection=n,this.commandConnection=t,this.eventGroup=du()(),this.countryCode=s,this.enableTracking=i}set onPlayRequested(e){this.playRequestHandler=e}connect(e){this.trackers=this.enableTracking?[uh(this.queueConnection),ch(this.commandConnection,this.countryCode)]:[],this.queueConnection.connect(),this.commandConnection.connect(this.onCommand.bind(this),e),this.queueConnection.onQueueNeedsRefresh=()=>{this.publishQueue(this.player.getQueue()||this.player.generateQueue())};let t=0;const n=()=>{this.commandConnection.publish(new Ym,3e3).then((()=>this.bindPlayerListeners())).catch((()=>{!this.playerEventsBound&&t<3&&(t++,n())}))};n()}disconnect(e){return this.trackers.forEach((e=>e.stop())),this.trackers=[],A.A.unsubscribeAll(this.eventGroup),this.playerEventsBound=!1,this.queueConnection.stop(),this.commandConnection.disconnect(e)}publishQueue(e){this.queueConnection.publishQueue(e).catch((e=>v.A.error(e)))}publishState(){const e=this.player.getState();this.commandConnection.publish(new Vm({...e,elementId:eh(e.queueId,e.track)}),1e3).catch((()=>{}))}bindPlayerListeners(){if(this.playerEventsBound)return;this.playerEventsBound=!0;const e=sh()(this.publishState.bind(this),30);A.A.subscribe(A.A.player.position,(0,Ho.A)((()=>this.publishState()),3e3,{leading:!0}),this.eventGroup),A.A.subscribe(A.A.player.tracklist_changed,(()=>{this.onTracklistChange()}),this.eventGroup),A.A.subscribe(A.A.player.volume_changed,sh()(e,300),this.eventGroup),A.A.subscribe(A.A.player.paused,e,this.eventGroup),A.A.subscribe(A.A.player.mute_changed,e,this.eventGroup),A.A.subscribe(A.A.player.repeat_changed,e,this.eventGroup)}onTracklistChange(){this.publishQueue(this.player.generateQueue()),this.publishState()}onCommand(e){switch(this.playerEventsBound||this.bindPlayerListeners(),e.messageType){case"skip":return this.onSkip(e);case"stop":return Promise.resolve(this.stop());case"close":return this.stop(),this.disconnect("remote");default:return Promise.reject(new Gm(0))}}stop(){this.player.stop()}async onSkip(e){const{queueId:t,elementId:n,progress:s,shouldPlay:i,setShuffle:a,setRepeatMode:r,setVolume:o}=e,l=t!==this.player.getQueueId();if(l){const e=await this.queueConnection.queueWithId(t,12e4);await this.player.replaceQueue(e)}if(void 0!==n){const{score:e,index:t}=function(e,t,n){var s;const i=function(e){const t=e.match(/^((?:[0-9A-Fa-f]+-?)+[0-9A-Fa-f]+)-([-]?[0-9]+)-([0-9]+)$/);if(!t)return;const[,n,s,i]=t;return{queue:n,id:s,index:Number(i)}}(n);if(!i)return{score:0,index:-1};const{queue:a,id:r,index:o}=i;return a===e&&(null===(s=t[o])||void 0===s?void 0:s.SNG_ID)===r?{score:1,index:o}:t.reduce(((t,n,s)=>{let i=e===a?.25:0;return n.SNG_ID===r&&(i+=.5),s===o&&(i+=.25),t.score<i?{score:i,index:s}:t}),{score:0,index:-1})}(this.player.getQueueId(),this.player.getTrackList(),n);if(e<.5)throw new Gm(0);(l||t!==this.player.getTrackListIndex())&&this.player.playTrackAtIndex(t,!0)}void 0!==a&&this.player.setShuffle(a),void 0!==r&&this.player.setRepeatMode(r),void 0!==o&&(0===o&&this.player.isMuted()||this.player.setVolume(o)),void 0!==s&&s>0&&this.player.seek(s),i&&this.playRequestHandler&&await this.playRequestHandler(),void 0!==i&&i!==this.player.isPlaying()&&(i?this.player.play():this.player.pause())}}const mh={[xu.ARTIST]:"artist",[xu.USER]:"user"};const gh={[Ir.en.LOW]:0,[Ir.en.STANDARD]:1,[Ir.en.HIGH]:2,[Ir.en.LOSSLESS]:3,[Ir.en.UNKNOWN]:-1};function yh(e,t){const n={queue:void 0,quality:void 0};return A.A.subscribe(A.A.player.qualityChanged,((e,t)=>{n.quality=t})),{play:()=>e.control.play(),pause:()=>e.control.pause(),stop:()=>[hr.zu.LIVE_STREAM,hr.zu.EPISODE].includes(e.getMediaType())?e.control.stop():e.control.pause(),seek:t=>e.control.seek(t),setShuffle:t=>e.control.setShuffle(t),setRepeatMode:t=>e.control.setRepeat(t),setDeviceID:t=>{e.setLinkedDevice(t?{device_type:"remote_control",name:t,type:"in"}:void 0)},isPlaying:()=>e.isPlaying(),getPosition:()=>e.getPosition(),getDuration:()=>e.getDuration(),setVolume:(0,le.A)((t=>e.control.setVolume(t)),100),isMuted:()=>e.isMuted(),playTrackAtIndex:(t,n=!1)=>e.playTrackAtIndex(t,n),getSongId:()=>e.getSongId(),getTrackListIndex:()=>e.getTrackListIndex(),getTrackList:()=>e.getTrackList(!0).map((e=>e.data)),getQueueId:()=>{var e;return(null===(e=n.queue)||void 0===e?void 0:e.id)||""},getQueue:()=>n.queue,generateQueue:()=>{const t=function(e){const t=e.getTrackList(!0,!0),n=[],s=t.map((({context:t,data:s})=>{const i=function(e){const t={id:e.ID.toString(),extra:{oneofKind:void 0}};if(/album(?!_similar)|artist_discography/i.test(e.TYPE))t.type=Nu.ALBUM;else if(/livestream/.test(e.TYPE))t.type=Nu.LIVE;else if(/personal/.test(e.TYPE))t.type=Nu.PERSONAL;else if(/artist_top/.test(e.TYPE))t.type=Nu.TOP_TRACKS,t.extra={oneofKind:"topTracks",topTracks:{type:Pu.ARTIST}};else if(/playlist(?!_radio)/.test(e.TYPE)||/history_page/.test(e.TYPE)||/profile_top/.test(e.TYPE))t.type=Nu.PLAYLIST;else if(/show/.test(e.TYPE))t.type=Nu.PODCAST;else if("up_next_artist"===e.TYPE)t.type=Nu.RECOMMENDED;else if(/^shuffled/.test(e.TYPE))t.type=Nu.SHUFFLE_MY_MUSIC;else if(/smarttracklist/.test(e.TYPE)){const n=(e.CONTEXT_ID||"").split(",").filter((e=>e.startsWith("card_name"))).map((e=>e.split("=")[1])).shift()||"";t.type=Nu.SMART_TRACKLIST,t.extra={oneofKind:"smart_tracklist_method",smart_tracklist_method:n}}else/artist|smartradio/.test(e.TYPE)?(t.type=Nu.MIX,t.extra={oneofKind:"mix",mix:{type:xu.ARTIST}}):"history_radio"===e.TYPE||"playlist_radio"===e.TYPE?(t.type=Nu.MIX,t.extra={oneofKind:"mix",mix:{type:xu.HISTORY}}):"search_radio"===e.TYPE?(t.type=Nu.MIX,t.extra={oneofKind:"mix",mix:{type:xu.SEARCH}}):/user|flow/.test(e.TYPE)?(t.type=Nu.MIX,t.extra={oneofKind:"mix",mix:{type:xu.USER}}):"mix_bottom_sheet_layer"===e.TYPE?(t.type=Nu.MIX,t.extra={oneofKind:"mix",mix:{type:xu.GENRE}}):/radio|mix/i.test(e.TYPE)?(t.type=Nu.MIX,t.extra={oneofKind:"mix",mix:{type:xu.DEFAULT}}):t.type=Nu.DEFAULT;return{container:t,log:{context_id:e.CONTEXT_ID||"",listening_context:e.TYPE||""}}}(t);let a,r=n.findIndex((e=>(0,wu.A)(e,i)));switch(r<0&&(r=n.push(i)-1),e.getMediaType(s)){case hr.zu.EPISODE:a=Ru.EPISODE;break;case hr.zu.LIVE_STREAM:a=Ru.LIVE;break;default:a=Ru.SONG}return{context:r,id:String(s[e.getMediaId(s)]),type:a}})),i=[],a=e.getTrackList(!0,!1).map((({context:n,data:s})=>{let a=0;const r=s[e.getMediaId(s)],o=t.filter((({context:t,data:i})=>i[e.getMediaId(i)]===s[e.getMediaId(s)]&&(0,wu.A)(n,t)));return o.length>1&&(a=i.filter((e=>r===e)).length,i.push(r)),t.indexOf(o[a])})),r={contexts:n,id:du()(),tracks:s,tracks_order:[],shuffled:!1,timestamp:0};return a.reduce(((e,t,n)=>e&&t===n),!0)||(r.tracks_order=a,r.shuffled=!0),r}(e);return n.queue=t,t},replaceQueue:s=>async function(e,t){if(!0===e.hydrated)return Promise.resolve(e);const n=e.contexts.map((({container:e,log:t})=>({CONTEXT_ID:null==t?void 0:t.context_id,ID:(null==e?void 0:e.id)||"",TYPE:(null==t?void 0:t.listening_context)||""}))),s=e=>({type:t})=>t===e,i=e=>e.id,{tracks:a}=e,r=a.filter(s(Ru.SONG)).map(i),o=a.filter(s(Ru.EPISODE)).map(i),l=a.filter(s(Ru.LIVE)).map(i),c=[...r.length?await t(r,"song"):[],...o.length?await t(o,"episode"):[],...l.length?await t(l,"live"):[]],{originals:d,recommended:u}=a.reduce(((e,t,s)=>{if(!c[s])return e;const i=t.context,a={context:n[i],data:c[s]};return"up_next_artist"===a.context.TYPE?e.recommended.push(a):e.originals.push(a),e}),{originals:[],recommended:[]}),p={hydrated:!0,contexts:e.contexts,tracks_order:e.tracks_order,timestamp:e.timestamp,id:e.id,shuffled:e.shuffled,original:d,recommended:u,tracks:(Array.isArray(e.tracks_order)&&e.tracks_order.length?e.tracks_order.map((e=>d[e])):d).map((e=>e.data))};if(u.length)p.radio="up_next_artist";else{const{container:t}=e.contexts[0];if(t&&t.type===Nu.LIVE)p.radio="livestream";else if(t&&t.type===Nu.MIX){var m;p.radio=mh["mix"===(null==t||null===(m=t.extra)||void 0===m?void 0:m.oneofKind)&&t.extra.mix.type||0]||""}}return p}(s,t).then((t=>{n.queue=s,e.setTriforceState(t)})),getState(){var t;const s=n.quality||e.control.getAudioQuality()||"standard",i=this.getQueueId();let a,r,o;if(e.getMediaType()===hr.zu.LIVE_STREAM)o=0,a=e.getPosition(),r=e.getPosition()/2;else{var l;const t=null!==(l=e.getDuration())&&void 0!==l?l:180;a=Number(t),o=a,r=e.getPosition()/a}const c=null===(t=e.getSongId())||void 0===t?void 0:t.toString();return{queueId:i,track:c?{id:c,index:e.getTrackListIndex()}:void 0,buffered:o,volume:Number(e.isMuted()?0:e.getVolume()),progress:r,duration:a,quality:gh[s],isPlaying:e.isPlaying(),isShuffle:e.isShuffle(),repeatMode:e.getRepeat()}}}}class fh{constructor(e,t,n,s,i,a){this.discovery=void 0,this.currentReceiverConnection=void 0,this.player=void 0,this.playRequestHandler=void 0,this.deviceName=void 0,this.countryCode=void 0,this.enableTracking=void 0,this.player=yh(e,s),this.discovery=new Zm(t,du()()),this.deviceName=n,this.countryCode=i,this.enableTracking=a}set onPlayRequested(e){this.playRequestHandler=e}listenForRemotes(){this.discovery.listen(this.handleConnectionOffer.bind(this))}isConnectedToRemote(){return void 0!==this.currentReceiverConnection}disconnect(){return this.discovery.stop(),this.disconnectFromCurrentSender()}async disconnectFromCurrentSender(e){this.currentReceiverConnection&&(await this.currentReceiverConnection.disconnect(e),this.player.setDeviceID(void 0),this.currentReceiverConnection=void 0)}async handleConnectionOffer(e){const{command:t,queue:n}=await e.accept({device_name:this.deviceName,device_type:"web",supported_control_versions:["1.0.0-beta2"]});await this.disconnectFromCurrentSender("remote"),this.currentReceiverConnection=new ph(this.player,t,n,this.countryCode,this.enableTracking),this.player.setDeviceID(e.from),this.currentReceiverConnection.onPlayRequested=()=>this.playRequestHandler?this.playRequestHandler():Promise.resolve(),this.currentReceiverConnection.connect(this.disconnectFromCurrentSender.bind(this,"timeout"))}}var Ah=n("+Hyk"),_h=function(e){return e.UPDATE_STATE="updateState",e.JOIN="join",e.LEAVE="leave",e.PING="ping",e}(_h||{});function Eh(e,t){return e>=([...t].sort(((e,t)=>e-t))[t.length-1]||0)}const vh=async(e,t)=>{switch(t){case"song":return await O.A.dispatch((0,ep.d0)({ids:e})),(0,tp.KW)(O.A.getState().entities,e);case"episode":return await O.A.dispatch((0,Xu.l$)({ids:e})),(0,Xu.KN)(O.A.getState().entities,e);case"live":return await O.A.dispatch((0,Zu.qS)({ids:e})),(0,Zu.b2)(O.A.getState().entities,e);default:throw new Error("Unhandled track type")}},bh=({onAutoplayBlocked:e})=>((0,i.useEffect)((()=>{let t;const n=(0,k.F6)(O.A.getState().user),s=function(e,t=""){if(!("BroadcastChannel"in window))return e(),()=>{};const n=new BroadcastChannel((t?t+"-":"")+"single-active-tab"),s=Date.now();let i=0,a={leadTab:void 0,tabs:[s]},r=()=>{a.leadTab=s,n.postMessage({type:_h.UPDATE_STATE,state:a}),e(),r=()=>{}};const o=()=>s===a.leadTab,l=setTimeout(r,500),c=setInterval((()=>{o()?n.postMessage({type:_h.PING}):Date.now()-i>6e4&&Eh(s,a.tabs)&&r()}),5e3);return n.onmessage=e=>{const t=e.data;switch(t.type){case _h.JOIN:o()&&(a.tabs.push(t.id),n.postMessage({type:_h.UPDATE_STATE,state:a}));break;case _h.LEAVE:a.tabs=a.tabs.filter((e=>e!==t.id)),t.id===a.leadTab&&(a.leadTab=void 0,Eh(s,a.tabs)&&r());break;case _h.PING:clearTimeout(l),i=Date.now();break;case _h.UPDATE_STATE:clearTimeout(l),i=Date.now(),a={...t.state}}},n.postMessage({type:_h.JOIN,id:s}),()=>{n.postMessage({type:_h.LEAVE,id:s}),n.close(),clearInterval(c)}}((()=>{let i=!1;const a=Ct.Ay?null===Ct.Ay||void 0===Ct.Ay?void 0:Ct.Ay.getHostname():Ji.A.getBrowserName();t=new fh(us.Ay,n,a,vh,(0,k.JJ)(O.A.getState().user),_.A.isAllowed("metric.remote_control")),t.onPlayRequested=()=>i?Promise.resolve():Ah.A.audio({timeout:1e3}).then((({result:t})=>(i=t,t?Promise.resolve():e()))),t.listenForRemotes(),window.addEventListener("beforeunload",(()=>{t.disconnect(),s()}))}),n);return()=>{s(),t&&t.disconnect()}}),[]),null);var Sh=n("vMeB");var wh=n("oN5d"),Ih=n("jUB+");const xh=()=>{const[e,t]=i.useState({message:"",timerId:0});i.useEffect((()=>(wh.Ay.addEventListener(wh.v9.OPEN,n),()=>{wh.Ay.removeEventListener(wh.v9.OPEN,n)})));const n=n=>{clearTimeout(e.timerId);const s=(0,Sh.A)((()=>t({message:"",timerId:0})),n.detail.duration||Ih.j);t({message:n.detail.body,timerId:s})};return""===e.message?null:i.createElement(V.P.aside,{initial:{opacity:0,transform:"translate3d(200px, 0, 0)"},animate:{opacity:1,transform:"translate3d(0, 0, 0)"},role:"alert",className:"Y6Dsl"},i.createElement("div",{className:"mtZhp"},i.createElement("h2",{className:"LWPFL"},e.message)))};var Ph=n("FuY1");let Nh,Rh,Lh;n("noe2");class Dh extends i.Component{constructor(){super(),this._onPageChanged=this._onPageChanged.bind(this),this._onPageDisplayed=this._onPageDisplayed.bind(this),this._updateWidth=this._updateWidth.bind(this),this._onTransitionEnd=this._onTransitionEnd.bind(this),this.state={isLoading:!1,width:0},this.contentRef=i.createRef()}componentDidMount(){A.A.subscribe(A.A.navigation.page_changed,this._onPageChanged),A.A.subscribe(A.A.navigation.page_displayed,this._onPageDisplayed)}componentWillUnmount(){clearTimeout(Nh),clearTimeout(Lh),clearInterval(Rh),A.A.unsubscribe(A.A.navigation.page_changed,this._onPageChanged),A.A.unsubscribe(A.A.navigation.page_displayed,this._onPageDisplayed)}render(){const e=(0,r.A)({"page-loader":!0,opened:this.state.isLoading}),t=(0,r.A)({"page-loader-bar":!0,"has-transition":this.state.hasTransition});return i.createElement("div",{className:e,id:"page_loader",ref:this.contentRef},i.createElement("div",{className:t,style:{width:`${this.state.width}%`}}))}_onPageChanged(){this.state.isLoading||(this.setState({isLoading:!0,hasTransition:!0,width:20+55*Math.random()}),Nh=setTimeout((()=>{this._updateWidth(),Rh=setInterval(this._updateWidth,1e3)}),1e3))}_onPageDisplayed(){setImmediate((()=>{this.state.isLoading&&(clearTimeout(Nh),clearInterval(Rh),this.setState({hasTransition:!1,width:100}),Lh=setTimeout((()=>{this.contentRef.current&&this.contentRef.current.addEventListener("transitionend",this._onTransitionEnd,!1),this.setState({isLoading:!1})}),500))}))}_onTransitionEnd(){this.setState({width:0}),this.contentRef.current&&this.contentRef.current.removeEventListener("transitionend",this._onTransitionEnd)}_updateWidth(){this.state.width>=90&&clearInterval(Rh),this.setState({width:this.state.width+5})}}var Oh,Mh,Uh=n("hYAH");function Fh(){return i.createElement("div",{className:"modal",id:"modal",role:"dialog","aria-hidden":"true",style:{display:"none"}},Oh||(Oh=i.createElement("div",{className:"modal-backdrop"})),Mh||(Mh=i.createElement("div",{className:"modal-wrapper"})))}var zh=n("ACKC"),qh=n("G/O0"),Bh=n("V9V8"),Gh=n("YJQc");const Qh=({id:e,onClose:t,onError:n,userId:s,placeholders:r})=>{const[o,l]=(0,i.useState)(!1),[c,d]=(0,i.useState)(!1),u=(0,a.wA)(),p=(0,Gh.oc)(),m=(0,a.d4)((({user:e})=>(0,k.Pe)(e))),h=(0,a.d4)((({user:e})=>(0,k.G8)(e))),g=(0,a.d4)((({user:e})=>(0,k.zJ)(e))),y=(0,a.d4)((({user:e})=>(0,k.Mn)(e))),f=(0,i.useMemo)((()=>new Bh.A),[]),A=(0,i.useMemo)((()=>new zh.Ay((0,un.WV)({itemType:qn.Wi.CONFIG,itemName:"media-service"})||g,m,{timeService:f,trackTokenProvider:async function e(t,{fetchPolicy:n="cache-first"}={}){if(!p)return;const{data:s}=await p.query({fetchPolicy:n,query:Gh.J1`
								query TrackMediaToken($trackId: String!) {
									track(trackId: $trackId) {
										media {
											token {
												payload
												expiresAt
											}
										}
									}
								}
							`,variables:{trackId:t.id}}),{track:{media:{token:{payload:i="",expiresAt:a=Date.now()}={}}={}}={}}=s,r=new zh.X8(i,{expire:new Date(a).getTime()});return r.isExpired(f.now())&&n.startsWith("cache")?e(t,{fetchPolicy:"network-only"}):r}})),[p,m,g,f]);return(0,i.useEffect)((()=>{var e;window.IASReady={_e:[()=>l(!0)]};const t=document.createElement("script");return t.async=!0,t.id="ias-wjs",t.src="https://sdk.inappstory.com/v2.4.3/dist/js/IAS.js",null===(e=document.getElementsByTagName("script")[0])||void 0===e||e.insertAdjacentElement("beforebegin",t),()=>{delete window.IASReady,t.remove()}}),[]),(0,i.useEffect)((()=>{if(!o)return;const{IAS:i}=window,a=(new i.AppearanceManager).setStoryReaderOptions({sharePanel:{targets:[]}}),l={};null==r||r.forEach((({key:e,value:t})=>{l[e]=t}));const c={apiKey:Gn.default.get("inappstory_api_key"),userId:s,tags:[],placeholders:{blogname:y||"",...l},lang:"en"},p=new qh.A,m=new i.StoryManager({...c},{storyLinkClickHandler:e=>{const{data:t}=e,{url:n}=t;(0,ts.$)(n,{dispatch:u,lovedTracksId:h,userId:s})?m.closeStoryReader():window.open(n)}}),g=({payload:e})=>function(e,{mediaProvider:t,previewer:n,placeholders:s}){if(!e)return;let i;try{i=JSON.parse(e)}catch(e){return}switch(i.action){case"muteAudio":"boolean"==typeof i.data.isMuted&&(n.muted=i.data.isMuted);break;case"playAudio":{const{data:e}=i;let{content:a}=e;const{type:r}=e,o=null==s?void 0:s.find((e=>(null==e?void 0:e.key)===a));if(o&&(a=o.value),!a)break;"external"===r&&(n.load(a),n.volume=us.Ay.getVolume()),"internal"===r&&t.getMedia({id:a},{type:zh.Sq.PREVIEW}).then((e=>{const t=e.sources[0];t&&(n.load(t.url),n.volume=us.Ay.getVolume())})).catch((()=>{}));break}case"stopAudio":n.stop()}}(e,{mediaProvider:A,previewer:p,placeholders:r});return m.on("closeStory",t),m.on("showSlide",g),m.showStory(e,a).then(d).catch(n),()=>{p.stop(),m.closeStoryReader(),m.off("closeStory",t),m.off("showSlide",g)}}),[r,u,e,h,A,t,n,o,y,s]),(0,i.useEffect)((()=>{if(!c)return;const e=us.Ay.isPlaying();return us.Ay.control.pause(),()=>{e&&us.Ay.control.play()}}),[c]),null};var Hh=n("pIhH");const Yh=({story:e})=>e.id;var Vh,jh;function Wh(){const e=(0,oe.W6)(),t=(0,a.wA)(),n=(0,a.d4)((({user:e})=>(0,k.F6)(e))),s=(0,a.d4)(Yh),{data:r,loading:o}=(0,pi.ZO1)({variables:{storyId:s||""},skip:!s});(0,i.useEffect)((()=>{const n=e=>{const n=new URL(e).searchParams.get("stories");n&&t((0,Uh.o)({id:n}))};n(window.location.href);const s=e.listen((()=>{n(window.location.href)}));return()=>{s()}}),[]);const l=(0,i.useCallback)((()=>{window.location.href.includes("stories")&&e.replace(window.location.pathname),t((0,Uh.E)())}),[]),c=(0,i.useMemo)((()=>{var e;return(null==r||null===(e=r.me)||void 0===e||null===(e=e.simpleStory)||void 0===e?void 0:e.placeholders)||[]}),[r]);return i.createElement("div",{className:"page-shadow"},Vh||(Vh=i.createElement(Fh,null)),s&&n&&!o?i.createElement(Qh,{id:s,onClose:l,onError:l,userId:n,placeholders:c}):null,_.A.isAllowed("reactivation_desktop_notification")&&(jh||(jh=i.createElement(Hh.Ay,null))))}var Kh=n("r2ys"),$h=n("ebSJ"),Jh=n("uHHB");let Xh;var eg,tg,ng,sg,ig,ag,rg,og,lg,cg,dg,ug,pg,mg,hg,gg,yg,fg,Ag;class _g extends i.Component{constructor(e){super(e),e.updateCurrentPage(e.location.pathname),this._onLiveFeed=this._onLiveFeed.bind(this),this.state={error:null}}componentDidMount(){(()=>{if(void 0!==Xh)return Xh;if("undefined"!=typeof document){const e=document.createElement("div");e.style.width="100px",e.style.height="100px",e.style.position="absolute",e.style.top="-9999px",e.style.overflow="scroll",document.body.appendChild(e),Xh=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}else Xh=0;return Xh})()>0&&document.body.classList.add("force-scrollbar"),E.A.addInternalChannel("-1_"+this.props.userID+"_USERFEED_"+this.props.userID),E.A.init(),A.A.subscribe(A.A.live.feed,this._onLiveFeed),A.A.trigger(A.A.navigation.page_displayed,{path:this.props.location.pathname}),A.A.resolve(A.A.navigation.page_initialized),this.props.hasMultiAccountEnabled&&this.props.fetchChildAccount();const e=this._getSelectedAccount();!1!==e?this.props.selectChildAccount(e):this.props.isSubAccount?this.props.selectChildAccount(this.props.userID):this.props.hasNoChildAccountSelected&&!e&&this.props.openScreen({name:F.F.SELECT_PROFILE,data:{hasPreselectedMember:!1,allowScreenClose:!1}}),!_.A.isAllowed("public_api_onboarding")&&this.props.hasOnBoarding&&this.props.openScreen({name:F.F.ONBOARDING_LEGACY,data:{showGenreFilter:!0}}),this.props.location.query&&this.props.location.query.modal&&(0,P.C)(this.props.location.query.modal)&&this.props.openModal({name:this.props.location.query.modal}),(0,$h.A)("hideBannerElectronUI")&&(0,Jh.A)("hideBannerElectronUI",!1,-1),this._displayProfileSelection(),this._displayAlerts()}shouldComponentUpdate(e,t){return this.props.location.pathname!==e.location.pathname||this.props.location.state!==e.location.state||this.props.hasNoChildAccountSelected!==e.hasNoChildAccountSelected||this.props.userID!==e.userID||!this.state.error&&t.error}componentDidUpdate(){window.scrollTo(0,0),A.A.trigger(A.A.navigation.page_changed,{path:this.props.location.pathname}),this.props.updateCurrentPage(this.props.location.pathname),A.A.trigger(A.A.navigation.page_displayed,{path:this.props.location.pathname}),this._hideAlerts(),!_.A.isAllowed("public_api_onboarding")&&this.props.hasOnBoarding&&this.props.openScreen({name:F.F.ONBOARDING_LEGACY,data:{showGenreFilter:!0}}),this.state.error&&this.setState({error:null})}componentDidCatch(e,t){this.setState({error:e.constructor.name}),e instanceof u.Dr||v.A.error(e,t)}componentWillUnmount(){A.A.unsubscribe(A.A.live.feed,this._onLiveFeed)}render(){if(this.props.hasNoChildAccountSelected)return eg||(eg=i.createElement("div",{className:"naboo"},i.createElement(Hp,null),i.createElement(H,null),i.createElement(Wh,null),i.createElement(N.A,null)));const e=["/login","/register"].includes(this.props.location.pathname);return i.createElement("div",(0,s.A)({className:"naboo"},{}),tg||(tg=i.createElement(Hp,null)),_.A.isAllowed("public_api_onboarding")?ng||(ng=i.createElement(Gp,{toRenderWhenNoOnboarding:i.createElement(zp,null)})):!this.props.hasOnBoarding&&(sg||(sg=i.createElement(zp,null))),ig||(ig=i.createElement(H,{withTransition:!0})),ag||(ag=i.createElement(Z,null)),rg||(rg=i.createElement(xh,null)),og||(og=i.createElement(Dh,null)),e?null:lg||(lg=i.createElement(ni,null)),e||!this.props.isConnected?null:cg||(cg=i.createElement(ta,null)),this._renderMain(e),e?null:dg||(dg=i.createElement(Mp,null)),e?null:ug||(ug=i.createElement(ae.A,null)),pg||(pg=i.createElement(Wh,null)),mg||(mg=i.createElement(vm,null)),_.A.isAllowed("remote_control")?i.createElement(bh,{onAutoplayBlocked:()=>new Promise((e=>{this.props.openModal({name:"REMOTE_CANNOT_AUTOPLAY",props:{onClose:e}})}))}):null,hg||(hg=i.createElement(N.A,null)),gg||(gg=i.createElement(se,null)))}_renderMain(e){const t=(0,r.A)({"page-main":!0,"electron-auth":e});if(this.state.error)return i.createElement("div",{className:t,id:"page_content",role:"main"},yg||(yg=i.createElement(Ph.A,null)));const n=this.props.location.pathname.replace(/^\/|\/$/g,"")===this.props.userLanguage;return i.createElement("div",{className:t,id:"page_content",role:"main"},i.createElement(ie.A,{displayContentCard:n}),fg||(fg=i.createElement(re.s,null)),Ag||(Ag=i.createElement(Kh.A,null)),i.createElement(i.Suspense,{fallback:null},this.props.children))}_onLiveFeed(e,t){if(!t.length)return;const n=t[0];switch(n.ACTION){case"FRIEND_FOLLOW":case"PLAYLIST_COMMENT":case"SHARE":b.A.addNotification(n);break;default:b.A.addTicker(n,!0)}}_displayProfileSelection(){const{hasMultiAccountEnabled:e,hasParent:t,isSubAccount:n,isSubProfile:s}=this.props,{redirect:i}=c().parse(window.location.search,{ignoreQueryPrefix:!0});e&&"profiles"===i&&(!t||s&&!n)&&(this.props.openScreen({name:F.F.SELECT_PROFILE,data:{hasPreselectedMember:!1,allowScreenClose:!0}}),d.A.push((0,S.jd)("/")))}_displayAlerts(){const{isConnected:e,userOfferId:t}=this.props;e&&!f.isDismissed($.jE)&&this.props.dispatchShowAlert($.jE,{userOfferId:t,onClose:()=>{f.markAsDismissed($.jE)}})}_hideAlerts(){const{alerts:e,dispatchHideAlert:t}=this.props;if(!e.length)return;const n=[$.jE];e.filter((e=>n.includes(e.id))).forEach((e=>{t(e.id),f.markAsDismissed(e.id)}))}_getSelectedAccount(){return m.default.get("selectedChildAccount",!1,!0)}}_g.defaultProps={userAge:"",userGender:"",hasNoChildAccountSelected:!1};const Eg=(0,a.Ng)((({user:e,alerts:t})=>({userID:e.USER.USER_ID,isConnected:(0,k.UJ)(e),hasOnBoarding:e.USER.ONBOARDING_MODAL,userAge:(0,k.QO)(e),userGender:(0,k.o_)(e),userLanguage:(0,k.Z0)(e),userOfferId:(0,k.id)(e),hasNoChildAccountSelected:(0,k.In)(e),alerts:t,isSubProfile:(0,k.W$)(e),hasParent:(0,k.p7)(e),hasMultiAccountEnabled:(0,k.mE)(e),isSubAccount:(0,k.m0)(e),displayCommunicationPreferencesUpdateBanner:!0===e.__DZR_GATEKEEPS__.display_communication_preferences_update_banner})),{selectChildAccount:T.me,updateCurrentPage:C.yf,openScreen:w.J2,openModal:x.qf,dispatchShowAlert:I.S7,dispatchHideAlert:I.Hd,fetchChildAccount:T.C9}),vg=Eg((0,o.Ay)((e=>({virtualpageurl:e.location.pathname,language:e.userLanguage,uilogged:e.isConnected})),{process:e=>e.pagename?e:null,dispatch:e=>{if(void 0!==window.dataLayer){const t=Object.assign({},e);e.pagecategory===rt.CONTEXT_PAGE_SEARCH&&(t.pagename=rt.CONTEXT_PAGE_SEARCH),window.dataLayer.push(t)}(0,p.TD)(e)}})(_g))},axbb:(e,t,n)=>{n.d(t,{s:()=>l});var s=n("Fzox"),i=n("xobL"),a=n("q1tI"),r=n("wE9P"),o=n("nLzw");const l=()=>{const[e,t]=(0,a.useState)(!1),n=(0,s.G)((({user:e})=>{const t=(0,i.qo)(e);return{userId:(0,i.F6)(e).toString(),...t&&{email:t}}})),l=(0,r.u)(),c=(0,a.useRef)({userDetail:n}).current;return(0,a.useEffect)((()=>{l.init(),c.userDetail={},t(!0)}),[]),(0,a.useEffect)((()=>{const{userId:t,...s}=n;e&&t&&((0,o.A)(c.userDetail,n)||(l.identify({userId:t,...s}),c.userDetail=n))}),[e,n]),null}},"5pmF":(e,t,n)=>{n.d(t,{A:()=>v});var s=n("q1tI"),i=n("TRpf"),a=n("xobL"),r=(n("/eM8"),n("Vd8Q"));const o=r.default.get("host_website_ssl"),l=r.default.get("host_cookie"),c=`https://${r.default.get("host_common_assets_ssl")}/js/gdpr-appliance.js`,d=r.default.get("bot_crawler"),u=new RegExp(d,"i");var h=n("zKOv"),g=n("vGT4"),y=n("39Zz"),f=n("uHHB"),A=n("wE9P"),_=n("ebSJ");const E=({locale:e,darkMode:t,userId:n})=>{const{dispatch:i}=(0,g.b)();return(0,s.useEffect)((()=>{window.location.pathname.includes("register")&&(0,_.A)(y.J)&&((0,f.A)(y.J,"",0),(0,f.A)("euconsent-v2","",0)),window.onDzrGDPRReady=s=>{(async(e,t)=>{const{lang:n="en_US",darkMode:s=!1,onConsentUpdate:i,userID:a="0"}=t||{};window.consentScreenApi=await e({cookieDomain:l,darkMode:s,gatewayHost:o,isWebview:!1,lang:n,onConsentUpdate:i,userID:a})})(s,{lang:e,darkMode:t,userID:n,onConsentUpdate:e=>{var t;i((t=e,{type:h.X,value:t})),(0,A.u)().setConsent(e)}})},((e="dzr-gdpr-script")=>{if(u.test(navigator.userAgent))return;if(document.getElementById(e))return;const t=document.createElement("script");t.async=!0,t.crossOrigin="anonymous",t.defer=!0,t.id=e,t.src=c,document.head.appendChild(t)})("gdpr-web-script")}),[]),(0,s.useEffect)((()=>{var s;null===(s=window.consentScreenApi)||void 0===s||s.update({darkMode:t,userID:n,lang:e})}),[t,e,n]),null},v=()=>{const e=(0,i.d4)((e=>(0,a.JK)(e.user))),t=(0,i.d4)((e=>e.user.id?(0,a.NF)(e.user):"dark"===document.body.dataset.theme)),n=(0,i.d4)((e=>(0,a.F6)(e.user).toString()));return s.createElement(E,{darkMode:t,userId:n,locale:e})}},wGgI:(e,t,n)=>{n.d(t,{qT:()=>u,VX:()=>p,y8:()=>d,Ay:()=>h});var s=n("q1tI"),i=n("juqV"),a=n("HmE0"),r=n("yCtO");class o extends s.Component{render(){const{children:e,isDisabled:t,isSelected:n}=this.props,a=(0,i.A)("dropdown-item",{hidden:t,"is-selected":n});return s.createElement("li",{className:a},e)}}o.defaultProps={isDisabled:!1,isSelected:!1};const l=o;var c;const d="sm",u="left",p="right";class m extends s.Component{constructor(e){super(e),this._onToggle=this._onToggle.bind(this),this._onClose=this._onClose.bind(this),this.state={label:e.children[e.selected].props.label||e.label,isOpen:!1}}static getDerivedStateFromProps(e){return{label:e.children[e.selected].props.label||e.label}}render(){const{children:e,align:t,size:n,overflow:o,isDisabled:l}=this.props,{label:d,isOpen:u}=this.state,m=(0,i.A)("dropdown",{"dropdown-active":this.state.isOpen}),h=(0,i.A)("dropdown-menu",{"is-right":t===p,"is-overflow":o});return s.createElement("span",{className:m},s.createElement(a.$n,{"data-testid":`dropdown_${d}`,size:n,rightIcon:c||(c=s.createElement(r.e,null)),onClick:this._onToggle,variant:"outline",isDisabled:l},d),s.createElement("ul",{className:h,"aria-hidden":!u,onClick:this._onClose,onMouseDown:e=>e.stopPropagation()},u?e:null))}_onClose(){this.setState({isOpen:!1},(()=>{document.removeEventListener("mousedown",this._onClose)}))}_onToggle(){const e=!this.state.isOpen;this.setState({isOpen:e},(()=>{e&&document.addEventListener("mousedown",this._onClose)}))}}m.defaultProps={label:null,size:d,align:u,className:null,selected:0,overflow:!1,isDisabled:!1},m.Item=l;const h=m},xvdY:(e,t,n)=>{n.d(t,{A:()=>f});var s,i,a=n("q1tI"),r=n("TRpf"),o=n("fJgm"),l=n("OPhi"),c=n("GkgI"),d=n("5G9X"),u=n("/o+9"),p=n("HmE0"),m=n("P4bz"),h=n("//u0"),g=n("gtRZ");class y extends a.Component{constructor(e){super(e),this._handleToggle=this._handleToggle.bind(this),this._handleDoubleClick=this._handleDoubleClick.bind(this)}shouldComponentUpdate(e){return this.props.isFavorite!==e.isFavorite||this.props.id!==e.id}render(){const{className:e,isFavorite:t,type:n,tooltip:r,tooltipPosition:o,isDisabled:l}=this.props,c=this._getTooltip(),y=a.createElement(p.K0,{"data-testid":n!==d.Ay.User?"add_to_favorite_button_"+(t?"on":"off"):void 0,variant:"ghost",size:"small",isDisabled:l,onClick:this._handleToggle,onDoubleClick:this._handleDoubleClick,"aria-label":c,icon:a.createElement(a.Fragment,null,n===d.Ay.User&&a.createElement(m.H,{color:t&&"icon.accent.primary.default"}),n!==d.Ay.User&&t&&(s||(s=a.createElement(h.C,{color:"icon.accent.primary.default"}))),n!==d.Ay.User&&!t&&(i||(i=a.createElement(g.M,null)))),className:e});return r&&!l?a.createElement(u.m,{label:c,placement:o},y):y}_handleDoubleClick(e){e.stopPropagation()}_handleToggle(e){e.stopPropagation();const{isFavorite:t,type:n,id:s,context:i,onAdd:a,onRemove:r}=this.props,l={type:n,id:s,context:i};if(t){if(r)return void r(o.A,l);o.A.remove(l)}else{if(a)return void a(o.A,l);o.A.add(l)}}_getTooltip(){const{isFavorite:e,type:t}=this.props;return"song"===t?(0,c.b)({type:t,action:"favorite"},e?"hover":"add","full"):""}}y.defaultProps={type:d.Ay.Album,tooltip:!1,tooltipPosition:"top",isDisabled:!1};const f=(0,r.Ng)((({feedbacks:e},t)=>({isFavorite:(0,l.BA)(e,t.id,t.type)})))(y)},"/uRm":(e,t,n)=>{n.d(t,{F:()=>s});let s=function(e){return e.ONBOARDING="ON_BOARDING",e.ONBOARDING_LEGACY="ON_BOARDING_LEGACY",e.SELECT_PROFILE="SELECT_PROFILE",e.BRIDGED_WEBVIEW="BRIDGED_WEBVIEW",e.PLAYLIST_ASSISTANT="PLAYLIST_ASSISTANT",e}({})},I36q:(e,t,n)=>{n.d(t,{d:()=>s});let s=function(e){return e.Welcome="welcome",e.Improve="improve",e}({})},Zah6:(e,t,n)=>{n.d(t,{A:()=>m});var s=n("+9dH"),i=n("q1tI"),a=n("TRpf"),r=n("TqF5"),o=n("jKJc"),l=n("DdAs"),c=n("WKgy"),d=n("Qi9J");const u=e=>{switch(e){case"small":return"lg";case"medium":return"xl";default:return"3xl"}};class p extends i.Component{constructor(e){super(e),this._open=this._open.bind(this),this._close=this._close.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onOutsideMouseDown=this._onOutsideMouseDown.bind(this),this._contentRef=i.createRef()}componentDidMount(){document.addEventListener("keydown",this._onKeyDown),document.addEventListener("mousedown",this._onOutsideMouseDown),document.addEventListener("touchstart",this._onOutsideMouseDown)}componentWillUnmount(){document.removeEventListener("keydown",this._onKeyDown),document.removeEventListener("mousedown",this._onOutsideMouseDown),document.removeEventListener("touchstart",this._onOutsideMouseDown)}render(){const{isOpen:e,data:t,name:n,size:a,variant:r,testid:c}=this.props;if(!e)return null;const p=(0,d.C)(n);return p?i.createElement(o.aF,{isOpen:e,variant:null!=r?r:"foundation",size:u(a),isCentered:!0,onClose:this._close},i.createElement(l.mH,{onClick:this._close}),i.createElement(l.$m,{ref:this._contentRef,"data-testid":c},i.createElement(i.Suspense,{fallback:null},i.createElement(p,(0,s.A)({},t,{name:n}))))):null}_onKeyDown(e){const{isOpen:t,disableClosingAction:n}=this.props;t&&!n&&27===e.keyCode&&this._close()}_onOutsideMouseDown(e){const{isOpen:t,disableClosingAction:n}=this.props;t&&!n&&"HTML"!==e.target.tagName&&e.target.contains(this._contentRef.current)&&(e.stopPropagation(),this._close())}_close(){this.props.closeModal(!0)}_open(){this.props.openModal()}}p.defaultProps={size:"large",addRadius:!1},c.A.addReducers({modal:r.Ay});const m=(0,a.Ng)((({modal:e})=>({name:e.name,data:e.props,disableClosingAction:e.disableClosingAction,isOpen:""!==e.name,size:e.size,classNameClose:e.classNameClose,addRadius:e.addRadius,variant:e.variant,testid:e.testid})),{closeModal:r.Oo,openModal:r.qf})(p)},"5xmB":(e,t,n)=>{n.d(t,{B:()=>o,A:()=>l});var s=n("q1tI"),i=n("juqV"),a=n("Wp0Y");const r={img:"wPuzu",text:"sIMmz",nocontent:"k4rH3",private:"OXBI2",recommendation:"IMAtw"};let o=function(e){return e.NO_CONTENT="nocontent",e.PRIVATE="private",e.RECOMMENDATION="recommendation",e}({});const l=({img:e=o.NO_CONTENT,wording:t=(0,a.AP)("Aucun résultat."),className:n})=>s.createElement("div",{className:(0,i.A)(r.root,n)},s.createElement("div",{className:(0,i.A)(r.img,r[e])}),s.createElement("div",{className:r.text},t))},RTUF:(e,t,n)=>{n.d(t,{i:()=>r,m:()=>a});var s=n("q1tI");const i=s.createContext({isDragging:!1}),a=({children:e})=>{const[t,n]=s.useState(!1);s.useEffect((()=>{const e=e=>{e.preventDefault()},t=()=>{document.removeEventListener("dragend",t),document.removeEventListener("drop",t),document.removeEventListener("dragenter",e),document.removeEventListener("dragover",e),n(!1),document.body.classList.remove("is-dragging")};return document.addEventListener("dragstart",(()=>{document.addEventListener("dragenter",e),document.addEventListener("dragover",e),document.addEventListener("dragend",t),document.addEventListener("drop",t),n(!0),document.body.classList.add("is-dragging")})),()=>{document.removeEventListener("dragend",t),document.removeEventListener("drop",t),document.removeEventListener("dragenter",e),document.removeEventListener("dragover",e)}}),[]);const a=s.useMemo((()=>({isDragging:t})),[t]);return s.createElement(i.Provider,{value:a},e)},r=()=>{const e=s.useContext(i);if(!e)throw new Error("useDrag must be used wrapped inside a DragProvider");return e}},hIIJ:(e,t,n)=>{n.d(t,{A:()=>c});var s=n("+9dH"),i=n("q1tI"),a=n("55Ip"),r=n("Wp0Y"),o=n("NSet"),l=n("HmE0");const c=({children:e,href:t,className:n,title:c,subtitle:d,onClick:u,ctaLabel:p=(0,r.AP)("Voir tout"),isExternalLink:m=!1,...h})=>i.createElement(o.az,(0,s.A)({flex:1,className:n},h),i.createElement(o.DZ,{variant:"heading.m","data-testid":"section_title"},c,t?m?i.createElement(l.$n,{as:"a",href:t,target:"_blank",variant:"outline",size:"small",ms:"spacing.s","data-testid":"section_title_cta"},p):i.createElement(a.N_,{to:t,onClick:()=>null==u?void 0:u()},i.createElement(l.$n,{variant:"outline",size:"small",ms:"spacing.s","data-testid":"section_title_cta"},p)):null,e),d?i.createElement(o.EY,{variant:"body.s.default",mt:"spacing.xs",color:"text.neutral.secondary.default","data-testid":"section-title-subtitle"},d):null)},GkgI:(e,t,n)=>{n.d(t,{b:()=>o});var s=n("Wp0Y");let i={},a=!1;const r=()=>{i={full:{active:(0,s.AP)("successmessage_text_addedtoyourfavorites_web"),active_favorite_friend:(0,s.AP)("Suivi"),active_favorite_song:(0,s.AP)("successmessage_text_addedtoyourfavorites_web"),active_play:(0,s.AP)("À l'écoute"),active_play_artist:(0,s.AP)("Mix"),active_play_user:(0,s.AP)("FLOW"),active_shuffle_user:(0,s.AP)("favoritestab_action_shufflemymusic_web"),add:(0,s.AP)("contextualmenu_text_addtomyfavorites_web"),add_favorite_friend:(0,s.AP)("Suivre"),add_favorite_song:(0,s.AP)("Ajouter aux Coups de cœur"),add_dislike_song:(0,s.AP)("bantrack_action_dontrecommendthistrack_web"),add_dislike_artist:(0,s.AP)("banartist_action_dontrecommendthisartist_web"),add_play:(0,s.AP)("Écouter"),add_play_artist:(0,s.AP)("Mix"),add_play_user:(0,s.AP)("FLOW"),add_shuffle_user:(0,s.AP)("favoritestab_action_shufflemymusic_web"),default:(0,s.AP)("contextualmenu_text_addtomyfavorites_web"),default_favorite_friend:(0,s.AP)("Suivre"),default_favorite_song:(0,s.AP)("Ajouter aux Coups de cœur"),default_dislike_song:(0,s.AP)("bantrack_action_dontrecommendthistrack_web"),default_dislike_artist:(0,s.AP)("banartist_action_dontrecommendthisartist_web"),default_play:(0,s.AP)("Écouter"),default_play_artist:(0,s.AP)("Mix"),default_play_user:(0,s.AP)("FLOW"),default_shuffle_user:(0,s.AP)("favoritestab_action_shufflemymusic_web"),hover:(0,s.AP)("contextualmenu_text_deletefrommyfavorites_web"),hover_favorite_app:(0,s.AP)("Retirer de ma bibliothèque"),hover_favorite_friend:(0,s.AP)("Ne plus suivre"),hover_favorite_song:(0,s.AP)("Retirer des Coups de cœur"),hover_dislike_song:(0,s.AP)("banartist_action_allowinmyrecommendations_web"),hover_dislike_artist:(0,s.AP)("banartist_action_allowinmyrecommendations_web"),hover_play:(0,s.AP)("Pause"),hover_play_artist:(0,s.AP)("Mix"),hover_play_user:(0,s.AP)("FLOW"),hover_shuffle_user:(0,s.AP)("favoritestab_action_shufflemymusic_web"),paused_play:(0,s.AP)("Pause"),paused_play_artist:(0,s.AP)("Mix"),paused_play_user:(0,s.AP)("FLOW"),paused_shuffle_user:(0,s.AP)("favoritestab_action_shufflemymusic_web"),resume_play:(0,s.AP)("Reprendre"),resume_play_artist:(0,s.AP)("Mix"),resume_play_user:(0,s.AP)("FLOW"),resume_shuffle_user:(0,s.AP)("favoritestab_action_shufflemymusic_web")},standard:{active:(0,s.AP)("Ajouté"),add:(0,s.AP)("generic_action_add_web"),default:(0,s.AP)("generic_action_add_web"),default_play_small:(0,s.AP)("Écouter"),hover_play_small:(0,s.AP)("Pause"),paused_play_small:(0,s.AP)("Pause"),resume_play_small:(0,s.AP)("Reprendre"),active_play_small:(0,s.AP)("À l'écoute"),hover:(0,s.AP)("Retirer"),active_follow_user:(0,s.AP)("Suivi"),add_follow_user:(0,s.AP)("Suivre"),default_follow_user:(0,s.AP)("Suivre"),hover_follow_user:(0,s.AP)("Ne plus suivre"),default_download:(0,s.AP)("Télécharger"),active_download:(0,s.AP)("Téléchargé"),hover_download:(0,s.AP)("Retirer")}}};function o(e,t,n){!1===a&&(r(),a=!0);var s=n||e.wording;return"none"===s?"":i[s][t+"_"+e.action+"_"+e.type]?i[s][t+"_"+e.action+"_"+e.type]:i[s][t+"_"+e.action]?i[s][t+"_"+e.action]:i[s][t]}},r4LN:(e,t,n)=>{n.d(t,{A:()=>g});var s=n("q1tI"),i=n("juqV"),a=n("iooo"),r=n("GkjM"),o=n("BJtZ"),l=n("t08u"),c=n("/5X2"),d=n("xCFc"),u=n("iiSH"),p=n("1Pdy");const m={root:"hjoo7",multilines:"yjFrI",link:"_ZA0C",text:"A9te1","is-active":"_MAPk",isActive:"_MAPk"};var h=n("kb9X");const g=({links:e})=>{const{id:t,index:n,type:g}=s.useContext(c.gy),{context:y,rowHeight:f}=s.useContext(d.Gt),{triggerTracking:A}=(0,l.A)(y.TYPE),_=(0,h.A)(),E=(0,o.A)(m),v=(0,i.A)(m.root,E,{[m.multilines]:f>p.F4.md}),b=(0,i.A)(m.link,E),S=(0,i.A)(m.text,E),k=e=>""!==e?e:u.fs;return s.createElement("div",{className:v},e.map(((i,o)=>s.createElement(s.Fragment,{key:i.path},null===i.path?s.createElement("span",{className:S,"data-testid":i.type},k(i.name)):s.createElement(r.A,{className:b,"data-testid":i.type,to:(0,a.jd)(i.path),onClick:()=>{_(),A({action:i.type,item:{id:t,rank:n,type:g}})}},k(i.name)),o<e.length-1?", ":null))),0===e.length&&"-")}},EBWn:(e,t,n)=>{n.d(t,{A:()=>l});var s=n("Oqsq"),i=n("lXQd"),a=n("nLzw"),r=n("1Pdy"),o=n("t08u");const l=(e,t,n,l)=>{const{triggerTracking:c}=(0,o.A)(n.TYPE),d={},u=t.toDisplay.map((e=>((0,s.A)(d,e.uuid,e.item.id),e.uuid)));return(t,n,s)=>{if("function"!=typeof l)return;const o=u.filter((e=>!t.includes(e)));let p=0;if(t.includes(n)){for(p=u.indexOf(n);t.includes(u[p])&&p>0;)p--;p>0&&(p+=1)}else p=o.indexOf(n),p+=s===r.Nz.TOP?0:1;var m;o.splice(p,0,...t),(0,a.A)(o,u)||(l({id:e,order:(m=o,m.map((e=>(0,i.A)(d,e))))}),c({action:"dragdrop",eventaction:t.length>1?"dragdrop-multi":"dragdrop-single"}))}}},CTxd:(e,t,n)=>{n.d(t,{Ay:()=>L});var s=n("+9dH"),i=n("q1tI"),a=n("juqV"),r=n("TRpf"),o=n("Ty5D"),l=n("NSet"),c=n("koXx"),d=n("//u0"),u=n("P/T7"),p=n("MMCw"),m=n("LjZa"),h=n("xobL"),g=n("iooo"),y=n("5G9X"),f=n("Fg+i"),A=n("hz5U"),_=n("Vd8Q"),E=n("FMs+"),v=n("kPsn");const b=(e,t=v.SE.MEDIUM)=>e?e.small&&t<=v.SE.SMALL?e.small:e.medium&&t<=v.SE.MEDIUM?e.medium:e.large||[]:[],S=(e,t,n)=>!e||!e.length||t>=e.length?((e,t=v.SE.MEDIUM)=>`https://${_.default.get("host_img_url_ssl")}/${e}/d41d8cd98f00b204e9800998ecf8427e/${t}x${t}-000000-80-0-0.jpg`)(n):e[t];var k=n("sAMA");const R=({children:e,alt:t,urls:n,isExplicit:_,className:v,height:R,isActive:L=!1,rounded:D,type:O,width:M,hasOverlay:U,onClick:F,redirectUrl:z,genericType:q})=>{var B;const[G,Q]=(0,i.useState)(0),[H,Y]=(0,i.useState)(),V=(0,r.d4)((e=>(0,h.Uw)(e.user))),j=(0,r.d4)((e=>(0,h.NF)(e.user))),W=_&&V===k.g,K=(0,o.zy)(),$=(0,o.W6)(),J=(0,i.useCallback)((e=>{Y((e=>{try{const{color:t,visiblePixelsPercentage:n}=(0,E.xH)(e);if(n>10)return(0,E.s3)(t)}catch(e){}return"rgba(0,0,0,0)"})(e.target))}),[]),X=(0,i.useCallback)((()=>{Q(G+1)}),[G]),Z=(0,i.useCallback)((()=>{F&&F(),z&&z!==(null==K?void 0:K.pathname)&&$.push((0,g.jd)(z))}),[$,null==K?void 0:K.pathname,F,z]),ee={className:(0,a.A)("tfT2j",v,{wbExq:D,oQNuQ:!U||!e,MvB5w:W,gAdNo:z,VuV5A:L}),onClick:Z},te={};W&&(te.style={backgroundImage:`url(${A.A.getExplicitSrc(M,R)})`,backgroundColor:`${H}`,backgroundBlendMode:"multiply",backgroundSize:"100%"});const ne={alt:t,className:"KVvol",crossOrigin:"anonymous",htmlHeight:`${R}px`,loading:"lazy",src:S(b(n,Number(M)),G,O),htmlWidth:`${M}px`,onLoad:_?J:m.A,onError:X},se=null===(B=ne.src)||void 0===B?void 0:B.includes(A.A.PLACEHOLDER_LOVED_TRACKS_MD5),ie=q===f.eb.resume,ae=q===f.eb.latest;return O===y.Ay.Generic&&(ae||ie)||se?i.createElement(l.az,(0,s.A)({as:"figure"},ee),i.createElement(l.az,(0,s.A)({as:"div",borderRadius:"s"},te,{height:"100%"}),i.createElement(l.so,{backgroundColor:j?"#FF8564":"#FFD0C3",justifyContent:"center",alignItems:"center",height:"100%",width:"100%"},se?i.createElement(d.C,{size:"medium",boxSize:"50%",color:j?"#B5492B":"#E85E38"}):ie?i.createElement(u.x,{size:"medium",boxSize:"50%",color:j?"#B5492B":"#E85E38"}):i.createElement(p.X,{size:"medium",boxSize:"50%",color:j?"#B5492B":"#E85E38"})))):i.createElement(l.az,(0,s.A)({as:"figure"},ee),i.createElement(l.az,(0,s.A)({as:"div",borderRadius:"s","data-testid":"figure-style"},te),i.createElement(c._V,(0,s.A)({width:`${M}px`,borderRadius:D?"full":"s","data-testid":`${O}-cover`,objectFit:"cover"},ne)),e))};R.defaultProps={height:320,width:320,rounded:!1,hasOverlay:!0};const L=R},"3JOg":(e,t,n)=>{n.d(t,{A:()=>a});var s=n("q1tI"),i=n("juqV");const a=({children:e})=>{var t;return s.cloneElement(e,{className:(0,i.A)(null===(t=e.props)||void 0===t?void 0:t.className,"animate-wobble")})}},"rYh+":(e,t,n)=>{n.d(t,{A:()=>c});var s=n("q1tI"),i=n("juqV"),a=n("TRpf"),r=n("RSbz"),o=n("6vqc");class l extends s.Component{render(){const{className:e,langDirection:t,size:n}=this.props,a="rtl"===t?r.Y:o.v,l=(0,i.A)(e,"animate-wobble-target");return s.createElement(a,{className:l,boxSize:`${n}px`})}}l.defaultProps={size:"16",langDirection:"ltr"};const c=(0,a.Ng)((({user:e})=>({langDirection:e.DIRECTION})))(l)},Dqph:(e,t,n)=>{n.d(t,{A:()=>m});var s=n("17x9"),i=n.n(s),a=n("TRpf"),r=n("LvjZ"),o=n("XBvc"),l=n("S0k2"),c=n("nrKQ"),d=n("4+OJ"),u=n("xobL"),p=n("PKMp");const m=e=>{var t;const n=Object.assign({},e.contextTypes||{},{getTrackingParams:i().func}),s=((t=class extends e{constructor(...e){super(...e),this.tags={player_click:["type"],context_menu_click:["type","instance"],panel_click:["panel","type","id","index","instance"],menu_click:["type"],lyrics:["ts","action","container","sng","type"],artist_page_click:["type"],discography_click:["type","position","sort","view"],adblock_banner:["group","link","close"],pushbox:["action","box"]},this.platform={lyrics:"deezer_log",pushbox:"deezer_log"}}tracking(e,t){if("object"!=typeof this.tags[e])return!1;let n="function"==typeof this.getTrackingParams?this.getTrackingParams():{};"function"==typeof this.context.getTrackingParams&&Object.assign(n,this.context.getTrackingParams());let s={};"object"==typeof t&&(s=d.A.dataset(t));for(let t=0;t<this.tags[e].length;t++){let i=this.tags[e][t];"ts"!==i?void 0!==s[i]&&null!==s[i]&&(n[i]=s[i]):n[i]=(0,u.mI)({SERVER_TIMESTAMP:this.props.serverTimestamp,clientTimestampDelta:this.props.clientTimestampDelta})}let i="";return"string"==typeof s.trackingCallback&&(i=this[s.trackingCallback]||""),"string"==typeof this.platform[e]&&"deezer_log"===this.platform[e]?((0,o.isLogCentralWhitelisted)(e)||p.A.warn(`log_central is deprecated. "${e}" is not a whitelisted event.`),c.A.call({method:"log_central.log",data:{BATCH:[{channel:e,params:n}]}}),!0):(l.default.track(e,n,i),!0)}}).displayName=`TrackingComponentHOC(${(0,r.A)(e)})`,t.contextTypes=n,t);return(0,a.Ng)((({user:e})=>({serverTimestamp:e.SERVER_TIMESTAMP,clientTimestampDelta:e.clientTimestampDelta})),null,null,{forwardRef:!0})(s)}},bbm1:(e,t,n)=>{n.r(t),n.d(t,{default:()=>p,useDeezToolsContext:()=>d,useDeezToolsDispatch:()=>u});var s=n("q1tI"),i=n("eC9Z"),a=n("pUfN");const r={[a.Wi.CONFIG]:{},[a.Wi.FEATURE]:{},[a.Wi.GATEKEEP]:{}},o=(e=r,t)=>{switch(t.type){case a.nh:var n;if(!t.item)throw new Error("An item to update has to be provided");return void 0!==(null===(n=e[t.item.category])||void 0===n?void 0:n[t.item.name])?(delete e[t.item.category][t.item.name],localStorage.removeItem((0,i.Fl)({itemType:t.item.category,itemName:t.item.name})),{...e}):{...e,[t.item.category]:{...e[t.item.category],[t.item.name]:t.item.value}};case a.u3:if(!t.item)throw new Error("An item to update has to be provided");return{...e,[t.item.category]:{...e[t.item.category],[t.item.name]:t.item.value}};case a.u5:return{...r};default:throw new Error(`Action type ${t.type} is not handled`)}},l=(0,s.createContext)(void 0),c=(0,s.createContext)(void 0),d=()=>{const e=(0,s.useContext)(l);if(void 0===e)throw new Error("useDeezToolsContext must be used within a DeezToolsProvider");return e},u=()=>{const e=(0,s.useContext)(c);if(void 0===e)throw new Error("useDeezToolsDispatch must be used within a DeezToolsProvider");return e},p=({children:e})=>{const[t,n]=(0,s.useReducer)(o,r);return s.createElement(l.Provider,{value:t},s.createElement(c.Provider,{value:n},e))}},Iuvx:(e,t,n)=>{n.r(t),n.d(t,{default:()=>A}),n("/eM8");var s=n("q1tI"),i=n("u7vQ"),a=n("WKgy"),r=n("tZCQ"),o=n("eC9Z"),l=n("9odk"),c=n("RTUF"),d=n("J/yO"),u=n("+Whx"),p=n("4PKR");const m=e=>s.createElement(p.wZ,null,s.createElement(d.Ov,null,s.createElement(u.J0,null,e.children))),h=s.lazy((()=>Promise.all([n.e(4201),n.e(5539),n.e(9754),n.e(8974),n.e(4113),n.e(1845),n.e(766),n.e(6308),n.e(26),n.e(6431),n.e(1421),n.e(9094),n.e(8192),n.e(5665),n.e(3851),n.e(3172),n.e(7681),n.e(4209),n.e(7121),n.e(2416)]).then(n.bind(n,"PMuG")))),g=s.lazy((()=>n.e(4569).then(n.bind(n,"GQUU")))),y=s.lazy((()=>n.e(3592).then(n.bind(n,"fUz9")))),f=s.lazy((()=>Promise.resolve().then(n.bind(n,"bbm1")))),A=e=>{const t=0!==a.A.getState().user.USER.USER_ID&&a.A.getState().user.USER.OPTIONS.ads_display&&i.Ay.isAdvertisingAllowed()&&0!==a.A.getState().user.USER.USER_ID?g:h,n=r.A.isAllowed("public_api_onboarding")?s.createElement(l.Ay,null,s.createElement(t,e)):s.createElement(t,e),d=s.createElement(y,{offline:r.A.isAllowed("public_api_album")},n),u=r.A.isAllowed("deeztools")&&(0,o.oz)()?s.createElement(f,null,d):d;return s.createElement(s.Suspense,{fallback:null},s.createElement(c.m,null,s.createElement(m,null,u)))}},kb9X:(e,t,n)=>{n.d(t,{A:()=>a});var s=n("0JBE"),i=n("LOQS");const a=()=>{const{page:e,section:t,entityId:n,entity:a,item:r,itemId:o,itemIndex:l}=(0,s.iQ)();if(!e||!r||!o)return()=>{};const c=l||0===l?l+1:null;return()=>i.A.log({type:"cdp",eventName:"item_clicked",customAttributes:{screen_view_name:e,item_id:o,item_type:r,...a&&{screen_view_id_type:a},...n&&{screen_view_id:n},...t&&{section_name:t},...c&&{item_position:c}}})}},JFzq:(e,t,n)=>{n.d(t,{Ay:()=>l,bg:()=>i,hQ:()=>a,wL:()=>r});var s=n("bDF2");const i=()=>{if(window.dataLayer){const e=window.dataLayer.find((e=>e.pagename));if("undefined"!==e.pagename)return e.pagename}return null},a=({eventcategory:e,eventaction:t,eventlabel:n="",...s})=>{e&&t&&window.dataLayer&&window.dataLayer.push({event:"click",eventcategory:e,eventaction:t,eventlabel:n,...s})},r=(e,t,n,s="")=>{document.getElementById(e)&&document.getElementById(e).addEventListener("click",(function(){a({eventcategory:t,eventaction:n,eventlabel:s})}))},l={trackElementClick:r,trackElementsClick:(e,t,n,s="")=>{const i=document.getElementsByClassName(e);for(let e=0;e<i.length;e++)i[e].addEventListener("click",(function(){const r=i[e].getAttribute("data-tracking-type")?i[e].getAttribute("data-tracking-type"):s;a({eventcategory:t,eventaction:n,eventlabel:r})}))},pushClickEventGtm:a,pushEventToGTM:e=>{window.dataLayer&&window.dataLayer.push(e)},getPageName:i,trackFromDatasetInfo:()=>{document.querySelectorAll("[data-tracked=true]").forEach((e=>{e.addEventListener("click",(function({currentTarget:e}){var t,n,i;if((e=>"DETAILS"===e.nodeName&&!0===e.open)(e))return;const a=null!==(t=e.getAttribute("data-tracking-category"))&&void 0!==t?t:"",r=null!==(n=e.getAttribute("data-tracking-action"))&&void 0!==n?n:"",l=null!==(i=e.getAttribute("data-tracking-label"))&&void 0!==i?i:"";(0,s.R2)({eventcategory:a,eventaction:r,eventlabel:l})}))}))}}},"4+OJ":(e,t,n)=>{function s(e){return e.replace(/([A-Z])/g,(function(e){return"-"+e.toLowerCase()}))}var i;n.d(t,{A:()=>a}),i=document.head&&document.head.dataset?{set:function(e,t,n){e.dataset[t]=n},get:function(e,t){return e.dataset[t]},del:function(e,t){delete e.dataset[t]},getAll:function(e){return e.dataset}}:{set:function(e,t,n){return e.setAttribute("data-"+s(t),n),n},get:function(e,t){var n=e.getAttribute("data-"+s(t));return null===n?void 0:n},del:function(e,t){return e.removeAttribute("data-"+s(t)),!0},getAll:function(e){for(var t,n,s={},i=0;i<e.attributes.length;i++)"data-"===(t=e.attributes[i].name).substr(0,5)&&(s[(n=t.substr(5),n.toLowerCase().replace(/-(.)/g,(function(e,t){return t.toUpperCase()})))]=e.attributes[i].value);return s}};const a={addEventListener:function(e,t,n,s){"boolean"!=typeof s&&(s=!1),e.addEventListener?e.addEventListener(t,n,s):e.attachEvent&&e.attachEvent("on"+t,n)},removeEventListener:function(e,t,n,s){"boolean"!=typeof s&&(s=!1),e.removeEventListener?e.removeEventListener(t,n,s):e.detachEvent&&e.detachEvent("on"+t,n)},dataset:function(e,t,n){var s={set:function(t,n){return i.set(e,t,n),s},get:function(t){return i.get(e,t)},del:function(t){return i.del(e,t),s}};return 3===arguments.length?s.set(t,n):2===arguments.length?s.get(t):i.getAll(e)}}},"Fg+i":(e,t,n)=>{n.d(t,{Zo:()=>s,eb:()=>a,lC:()=>i});const s="1c51eebdce4b220e94e2ffddef5cf2f1",i="d6172ff86cb3f10e16a46ad0cb8f3259";let a=function(e){return e.latest="latest",e.resume="resume",e}({})},LOxp:(e,t,n)=>{n.d(t,{$:()=>y,r:()=>g}),n("EV0h"),n("gS5K");var s=n("hYAH"),i=n("AY3M"),a=n("AfN5"),r=n("5G9X"),o=n("u7vQ"),l=n("H/eQ"),c=n("WmA5"),d=n("p/gB"),u=n("nxAS"),p=n("/uRm"),m=n("tZCQ");const h={"/":"/","/home":"/","/settings":"/account","/settings/app":"/account/settings","/settings/display_settings":"/account/display","/premiumtab":"/offers"},g=["/game","/story"];function y(e,{dispatch:t,lovedTracksId:n,userId:g}){if(!e.startsWith("deezer://"))return!1;const{pathname:y,searchParams:f}=new URL(e.replace("deezer://","https://"));if(h[y])return"/premiumtab"===y?(window.open(`${h[y]}?${f.toString()}`,"_blank"),!0):(c.A.push(h[y]),!0);if("/settings/audio"===y)return l.A.trigger(l.A.player.openAudioSettings),!0;if(y.startsWith("/album")||y.startsWith("/artist")||y.startsWith("/channels")||y.startsWith("/playlist")||y.startsWith("/profile")||y.startsWith("/track"))return c.A.push(y),"true"===f.get("autoplay")||f.get("autoplay"),!0;if(y.startsWith("/simplestory")){const[,,e]=y.split("/");return!!e&&(t((0,s.o)({id:e})),!0)}if("/user/me/flow"===y)return o.Ay.play({context:{ID:g,TYPE:(0,d.Pe)(r.Ay.Flow,i.pN)},id:g,radio:!0,type:a.Kk.USER}),!0;if("/user/me/tracks"===y)return o.Ay.play({context:{ID:n,TYPE:(0,d.Pe)(r.Ay.Playlist,i.x6)},id:n,type:r.Ay.Playlist}),!0;if(y.startsWith("/game"))return t((0,u.J2)({name:p.F.BRIDGED_WEBVIEW,data:{pathname:y,searchParams:f,hideLogo:!0,disableDisplayPadding:!0}})),!0;if(y.startsWith("/story")||y.startsWith("/genplaylist")&&m.A.isAllowed("employee_feature"))return t((0,u.J2)({name:p.F.BRIDGED_WEBVIEW,data:{pathname:y,fixedLogo:!0}})),!0;if(y.startsWith("/redirect")){const e=f.get("url");return!!e&&(window.open(e,"_blank"),!0)}if(y.startsWith("/smarttracklist")){const[,,e]=y.split("/");return c.A.push(y),"true"===f.get("autoplay")&&o.Ay.play({context:{ID:e,TYPE:"smarttracklist_page"},id:e,type:r.Ay.Smarttracklist}),!0}return!1}},hYAH:(e,t,n)=>{n.d(t,{E:()=>i,o:()=>a});var s=n("6wwM");const i=()=>({type:s.R.CLOSE_STORY}),a=({id:e})=>({id:e,type:s.R.OPEN_STORY})},"9odk":(e,t,n)=>{n.d(t,{AP:()=>c,Ay:()=>o,kA:()=>l});var s=n("q1tI"),i=n("A2sV"),a=n("TRpf");const r=s.createContext({loading:!0}),o=(0,a.Ng)((({user:{id:e}})=>({legacyUserId:e})))((({legacyUserId:e,children:t})=>{const{data:n,loading:a,error:o,refetch:l}=(0,i.ONi)({});if(s.useEffect((()=>{var t;n&&e.toString()!==(null===(t=n.me)||void 0===t?void 0:t.user.id)&&l()}),[e,n,l]),o)throw o;if(!a&&void 0===n)throw new Error("Missing user data from pipe");const c=n&&null!==n&&null!==n.me?{isLogged:!0,data:n.me}:{isLogged:!1,data:null};return s.createElement(r.Provider,{value:a?{loading:!0}:{loading:a,...c,refetch:()=>{l({})}}},t)})),l=()=>{const e=s.useContext(r);if(!e)throw new Error("usePipeUserContext must be used whithin a PipeUserContext");return e},c=()=>{const e=l();if(!e.loading&&e.isLogged){const{__typename:t,...n}=e.data.onboarding;return n}return null}}}]);