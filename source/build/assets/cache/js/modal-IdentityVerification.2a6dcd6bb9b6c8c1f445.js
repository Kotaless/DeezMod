"use strict";(self.webpackJsonpDeezer=self.webpackJsonpDeezer||[]).push([[528],{X5lq:(e,t,n)=>{n.d(t,{u:()=>r});var s=n("nKUr");const r=(0,n("AGAM").w)({displayName:"InformationIcon",viewBox:"0 0 24 24",pathSmall:[(0,s.jsx)("path",{d:"M13 9c0-.335-.073-.575-.218-.735C12.616 8.08 12.354 8 12 8c-.357 0-.617.084-.782.268-.146.163-.218.403-.218.732 0 .36.082.61.248.77.166.16.416.23.752.23.368 0 .634-.106.799-.31.134-.166.201-.397.201-.69Zm-1.66 7h1.33v-4.67h-1.33V16Z"}),(0,s.jsx)("path",{fillRule:"evenodd",d:"M12 20c5.137 0 8-2.863 8-8 0-5.137-2.863-8-8-8-5.137 0-8 2.863-8 8 0 5.137 2.863 8 8 8Zm0-14.667c4.424 0 6.667 2.243 6.667 6.667 0 4.424-2.243 6.667-6.667 6.667-4.424 0-6.667-2.243-6.667-6.667 0-4.424 2.243-6.667 6.667-6.667Z",clipRule:"evenodd"})],pathMedium:[(0,s.jsx)("path",{d:"M13.5 7.5c0-.503-.11-.862-.327-1.103C12.923 6.12 12.531 6 12 6c-.536 0-.925.126-1.173.403-.219.243-.327.604-.327 1.097 0 .54.123.914.372 1.154.249.24.624.346 1.128.346.552 0 .952-.159 1.199-.465.2-.249.301-.596.301-1.035ZM11 11v7h2v-7h-2Z"}),(0,s.jsx)("path",{fillRule:"evenodd",d:"M12 23c7.064 0 11-3.936 11-11S19.064 1 12 1 1 4.936 1 12s3.936 11 11 11Zm0-20c5.972 0 9 3.028 9 9 0 5.972-3.028 9-9 9-5.972 0-9-3.028-9-9 0-5.972 3.028-9 9-9Z",clipRule:"evenodd"})]});r.defaultProps={fill:"currentColor",boxSize:"24px",display:"block","data-testid":"InformationIcon"}},rX4d:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Q});var s=n("q1tI"),r=n("TRpf"),a=n("Wp0Y"),i=n("nrKQ"),o=n("TqF5"),l=n("jKJc"),u=n("DdAs"),d=n("NSet"),c=n("IXMZ"),m=n("Q7m9"),h=n("Ui1H"),p=n("hnab"),f=n("W58G"),_=n("iDsS");function E(e){return e.sort(((e,t)=>{const n=e.compareDocumentPosition(t);if(n&Node.DOCUMENT_POSITION_FOLLOWING||n&Node.DOCUMENT_POSITION_CONTAINED_BY)return-1;if(n&Node.DOCUMENT_POSITION_PRECEDING||n&Node.DOCUMENT_POSITION_CONTAINS)return 1;if(n&Node.DOCUMENT_POSITION_DISCONNECTED||n&Node.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC)throw Error("Cannot sort the given nodes.");return 0}))}function b(e,t,n){let s=e+1;return n&&s>=t&&(s=0),s}function I(e,t,n){let s=e-1;return n&&s<0&&(s=t),s}var g="undefined"!=typeof window?s.useLayoutEffect:s.useEffect,v=class{descendants=new Map;register=e=>{var t;if(null!=e)return"object"==typeof(t=e)&&"nodeType"in t&&t.nodeType===Node.ELEMENT_NODE?this.registerNode(e):t=>{this.registerNode(t,e)}};unregister=e=>{this.descendants.delete(e);const t=E(Array.from(this.descendants.keys()));this.assignIndex(t)};destroy=()=>{this.descendants.clear()};assignIndex=e=>{this.descendants.forEach((t=>{const n=e.indexOf(t.node);t.index=n,t.node.dataset.index=t.index.toString()}))};count=()=>this.descendants.size;enabledCount=()=>this.enabledValues().length;values=()=>Array.from(this.descendants.values()).sort(((e,t)=>e.index-t.index));enabledValues=()=>this.values().filter((e=>!e.disabled));item=e=>{if(0!==this.count())return this.values()[e]};enabledItem=e=>{if(0!==this.enabledCount())return this.enabledValues()[e]};first=()=>this.item(0);firstEnabled=()=>this.enabledItem(0);last=()=>this.item(this.descendants.size-1);lastEnabled=()=>{const e=this.enabledValues().length-1;return this.enabledItem(e)};indexOf=e=>{var t;return e?(null==(t=this.descendants.get(e))?void 0:t.index)??-1:-1};enabledIndexOf=e=>null==e?-1:this.enabledValues().findIndex((t=>t.node.isSameNode(e)));next=(e,t=!0)=>{const n=b(e,this.count(),t);return this.item(n)};nextEnabled=(e,t=!0)=>{const n=this.item(e);if(!n)return;const s=b(this.enabledIndexOf(n.node),this.enabledCount(),t);return this.enabledItem(s)};prev=(e,t=!0)=>{const n=I(e,this.count()-1,t);return this.item(n)};prevEnabled=(e,t=!0)=>{const n=this.item(e);if(!n)return;const s=I(this.enabledIndexOf(n.node),this.enabledCount()-1,t);return this.enabledItem(s)};registerNode=(e,t)=>{if(!e||this.descendants.has(e))return;const n=E(Array.from(this.descendants.keys()).concat(e));(null==t?void 0:t.disabled)&&(t.disabled=!!t.disabled);const s={node:e,index:-1,...t};this.descendants.set(e,s),this.assignIndex(n)}},[C,N]=(0,f.q)({name:"DescendantsProvider",errorMessage:"useDescendantsContext must be used within DescendantsProvider"}),S=n("ph2P"),A=(...e)=>e.filter(Boolean).join(" "),y=e=>!!e||void 0;function P(...e){return function(t){e.some((e=>(null==e||e(t),null==t?void 0:t.defaultPrevented)))}}var[O,D,M,T]=[C,()=>N(),()=>function(){const e=(0,s.useRef)(new v);return g((()=>()=>e.current.destroy())),e.current}(),e=>function(e){const t=N(),[n,r]=(0,s.useState)(-1),a=(0,s.useRef)(null);g((()=>()=>{a.current&&t.unregister(a.current)}),[]),g((()=>{if(!a.current)return;const e=Number(a.current.dataset.index);n==e||Number.isNaN(e)||r(e)}));const i=e?t.register(e):t.register;return{descendants:t,index:n,enabledIndex:t.enabledIndexOf(a.current),register:(0,_.Px)(i,a)}}(e)],[w,R]=(0,f.q)({name:"PinInputContext",errorMessage:"usePinInputContext: `context` is undefined. Seems you forgot to all pin input fields within `<PinInput />`"}),k=e=>null==e?void 0:e.split("");function q(e,t){return("alphanumeric"===t?/^[a-zA-Z0-9]+$/i:/^[0-9]+$/).test(e)}function U(e){const t=(0,c.Vl)("PinInput",e),{children:n,...r}=(0,h.MN)(e),{descendants:a,...i}=function(e={}){const{autoFocus:t,value:n,defaultValue:r,onChange:a,onComplete:i,placeholder:o="â—‹",manageFocus:l=!0,otp:u=!1,id:d,isDisabled:c,isInvalid:m,type:h="number",mask:p}=e,f=(0,s.useId)(),_=d??`pin-input-${f}`,E=M(),[b,I]=(0,s.useState)(!0),[g,x]=(0,s.useState)(-1),[v,C]=(0,S.i)({defaultValue:k(r)||[],value:k(n),onChange:e=>null==a?void 0:a(e.join(""))});(0,s.useEffect)((()=>{if(t){const e=E.first();e&&requestAnimationFrame((()=>{e.node.focus()}))}}),[E]);const N=(0,s.useCallback)((e=>{if(!b||!l)return;const t=E.next(e,!1);t&&requestAnimationFrame((()=>{t.node.focus()}))}),[E,b,l]),A=(0,s.useCallback)(((e,t,n=!0)=>{const s=[...v];s[t]=e,C(s),""!==e&&s.length===E.count()&&s.every((e=>null!=e&&""!==e))?null==i||i(s.join("")):n&&N(t)}),[v,C,N,i,E]),O=(0,s.useCallback)((()=>{var e;const t=Array(E.count()).fill("");C(t);const n=E.first();null==(e=null==n?void 0:n.node)||e.focus()}),[E,C]),D=(0,s.useCallback)(((e,t)=>{let n=t;return(null==e?void 0:e.length)>0&&(e[0]===t.charAt(0)?n=t.charAt(1):e[0]===t.charAt(1)&&(n=t.charAt(0))),n}),[]);return{getInputProps:(0,s.useCallback)((e=>{const{index:t,...n}=e,s=g===t;return{"aria-label":"Please enter your pin code",inputMode:"number"===h?"numeric":"text",type:p?"password":"number"===h?"tel":"text",...n,id:`${_}-${t}`,disabled:c,"aria-invalid":y(m),onChange:P(n.onChange,(e=>{const n=e.target.value,s=v[t],r=D(s,n);if(""!==r)if(n.length>2){if(q(n,h)){const e=n.split("").filter(((e,t)=>t<E.count()));C(e),e.length===E.count()&&(null==i||i(e.join("")))}}else q(r,h)&&A(r,t),I(!0);else A("",t)})),onKeyDown:P(n.onKeyDown,(e=>{var n;if("Backspace"===e.key&&l)if(""===e.target.value){const e=E.prev(t,!1);e&&(A("",t-1,!1),null==(n=e.node)||n.focus(),I(!0))}else I(!1)})),onFocus:P(n.onFocus,(()=>{x(t)})),onBlur:P(n.onBlur,(()=>{x(-1)})),value:v[t]||"",autoComplete:u?"one-time-code":"off",placeholder:s?"":o}}),[E,g,D,_,c,p,m,l,i,u,o,A,C,h,v]),id:_,descendants:E,values:v,setValue:A,setValues:C,clear:O}}(r),o=(0,p.a)(n).map((e=>(0,s.cloneElement)(e,{__css:t})));return s.createElement(O,{value:a},s.createElement(w,{value:i},o))}U.displayName="PinInput";var F=(0,c.Rf)((function(e,t){const n=function(e={},t=null){const{getInputProps:n}=R(),{index:s,register:r}=T();return n({...e,ref:(0,_.Px)(r,t),index:s})}(e,t);return s.createElement(c.Bv.input,{...n,className:A("chakra-pin-input",e.className)})}));F.displayName="PinInputField";var j,B,V,z,L,Z,$,J=n("YIja"),Y=n("HmE0"),G=n("g1Fm");class K extends s.Component{constructor(e){super(e),this.state={code:"",message:{text:"",status:""}},this._onSubmit=this._onSubmit.bind(this),this._onCodeRequest=this._onCodeRequest.bind(this),this._inputRef=(0,s.createRef)()}componentDidMount(){const e=document.getElementById("deezer-support-link");e&&e.addEventListener("click",this._handleDeezerSupportClick),this._inputRef.current&&this._inputRef.current.focus()}componentWillUnmount(){i.A.cancel(this._apiRef)}render(){const e=(0,a.AP)("checkemailentercode_title_checkyouremail_web"),t=(0,a.AP)("checkemailentercode_text_wevesenta6digitcodeto_web"),n=this.props.email,r=(0,a.AP)("checkemailentercode_text_enterthe6digitcode_web"),i=(0,a.AP)("Continuer"),o=(0,G.A)((0,a.AP)("checkemailentercode_action_resendcodeUPP_web"),!0);return s.createElement(s.Fragment,null,j||(j=s.createElement(l.s_,null)),s.createElement(u.rQ,null,e),s.createElement(u.cw,null,s.createElement(d.BJ,{direction:"column",alignItems:"center",spacing:"spacing.m"},s.createElement(d.EY,{variant:"body.m.default"},`${t} `,s.createElement(c.Bv.span,{display:"inline-block",color:"text.accent.primary.default"},n)),s.createElement(m.MJ,{w:"fit-content"},s.createElement(m.lR,null,r),s.createElement(d.BJ,{direction:"row",spacing:"spacing.s",justifyContent:"center"},s.createElement(U,{onComplete:e=>{this.setState({code:e})}},B||(B=s.createElement(F,null)),V||(V=s.createElement(F,null)),z||(z=s.createElement(F,null)),L||(L=s.createElement(F,null)),Z||(Z=s.createElement(F,null)),$||($=s.createElement(F,null))))),this.state.message.text?s.createElement(J.N,{status:this.state.message.status},this.state.message.text):null)),s.createElement(l.jl,null,s.createElement(Y.$n,{variant:"outline",onClick:this._onCodeRequest},o),s.createElement(Y.$n,{type:"submit",onClick:this._onSubmit,isDisabled:""===this.state.code},i.toUpperCase())))}_onSubmit(e){e.preventDefault(),this._apiRef=i.A.call({method:"user.verifySecuredSessionCode",data:{SECURED_SESSION_CODE:parseInt(this.state.code,10)},success:()=>{if(this.setState({message:{text:""}}),this.props.closeModal(),"request_my_data"===this.props.requestType&&i.A.call({method:"user.requestDataExport",data:{USER_ID:this.props.userId},success:()=>{this.props.cb(),this.props.openModal({name:"REQUEST_MY_DATA_CONFIRMATION",size:"small"})},error:()=>{this.props.closeModal()}}),"dl_data"===this.props.requestType)return this.props.cb(),this.props.closeModal();this.props.openModal({size:"small",name:(()=>{switch(this.props.requestType){case"mail":return"UPDATE_EMAIL";case"request_my_data":return"REQUEST_MY_DATA_CONFIRMATION";default:return"UPDATE_PASSWORD"}})()})},error:e=>{"Invalid code"===e.response.error[e.name]?this.setState({message:{text:(0,a.AP)("errormessage_text_wrongcodetryagain_web"),status:"error"}}):"Try again later"===e.response.error[e.name]?this.setState({message:{text:(0,a.AP)("errormessage_text_incorrectverificationcodeusedtoomanytimes_web"),status:"error"}}):"Secured session code expired"===e.response.error[e.name]&&this.setState({message:{text:(0,a.AP)("errormessage_text_codetimedoutrequestnewcode_web"),status:"error"}})}})}_onCodeRequest(e){e.preventDefault(),this._apiRef=i.A.call({method:"user.requestSecuredSessionCode",success:()=>{this.setState({message:{text:(0,a.AP)("emailconfirmation_text_coderesent_web"),status:"success"}})},error:e=>{"Secured code already sent"===e.response.error[e.name]&&this.setState({message:{text:(0,a.AP)("errormessage_text_maximumcodenumbersrequested_web"),status:"error"}})}})}}const Q=(0,r.Ng)((({user:e})=>({userLang:e.SETTING_LOCALE,userId:e.id})),{openModal:o.qf,closeModal:o.Oo})(K)}}]);